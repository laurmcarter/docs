%!PS-Adobe-2.0
%%Creator: dvipsk 5.58c Copyright 1986, 1994 Radical Eye Software
%%Title: dsl.dvi
%%Pages: 14
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%EndComments
%DVIPSCommandLine: dvips -o final.ps dsl.dvi
%DVIPSParameters: dpi=300, compressed, comments removed
%DVIPSSource:  TeX output 1999.07.21:1134
%%BeginProcSet: texc.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N
/X{S N}B /TR{translate}N /isls false N /vsize 11 72 mul N /hsize 8.5 72
mul N /landplus90{false}def /@rigin{isls{[0 landplus90{1 -1}{-1 1}
ifelse 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
isls{landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div
hsize mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul
TR[matrix currentmatrix{dup dup round sub abs 0.00001 lt{round}if}
forall round exch round exch]setmatrix}N /@landscape{/isls true N}B
/@manualfeed{statusdict /manualfeed true put}B /@copies{/#copies X}B
/FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{
/nn 8 dict N nn begin /FontType 3 N /FontMatrix fntrx N /FontBBox FBB N
string /base X array /BitMaps X /BuildChar{CharBuilder}N /Encoding IE N
end dup{/foo setfont}2 array copy cvx N load 0 nn put /ctr 0 N[}B /df{
/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]
N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data dup
length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{
128 ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub
get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data
dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N
/rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup
/base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx
0 ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff
setcachedevice ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff
.1 sub]/id ch-image N /rw ch-width 7 add 8 idiv string N /rc 0 N /gp 0 N
/cp 0 N{rc 0 ne{rc 1 sub /rc X rw}{G}ifelse}imagemask restore}B /G{{id
gp get /gp gp 1 add N dup 18 mod S 18 idiv pl S get exec}loop}B /adv{cp
add /cp X}B /chg{rw cp id gp 4 index getinterval putinterval dup gp add
/gp X adv}B /nd{/cp 0 N rw exit}B /lsh{rw cp 2 copy get dup 0 eq{pop 1}{
dup 255 eq{pop 254}{dup dup add 255 and S 1 and or}ifelse}ifelse put 1
adv}B /rsh{rw cp 2 copy get dup 0 eq{pop 128}{dup 255 eq{pop 127}{dup 2
idiv S 128 and or}ifelse}ifelse put 1 adv}B /clr{rw cp 2 index string
putinterval adv}B /set{rw cp fillstr 0 4 index getinterval putinterval
adv}B /fillstr 18 string 0 1 17{2 copy 255 put pop}for N /pl[{adv 1 chg}
{adv 1 chg nd}{1 add chg}{1 add chg nd}{adv lsh}{adv lsh nd}{adv rsh}{
adv rsh nd}{1 add adv}{/rc X nd}{1 add set}{1 add clr}{adv 2 chg}{adv 2
chg nd}{pop nd}]dup{bind pop}forall N /D{/cc X dup type /stringtype ne{]
}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1 ne{dup dup
length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}B /I{
cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul
add .99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore userdict
/eop-hook known{eop-hook}if showpage}N /@start{userdict /start-hook
known{start-hook}if pop /VResolution X /Resolution X 1000 div /DVImag X
/IE 256 array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for
65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N /RMat[1 0 0 -1 0
0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X /rulex X V}B /V
{}B /RV statusdict begin /product where{pop product dup length 7 ge{0 7
getinterval dup(Display)eq exch 0 4 getinterval(NeXT)eq or}{pop false}
ifelse}{false}ifelse end{{gsave TR -.1 .1 TR 1 1 scale rulex ruley false
RMat{BDot}imagemask grestore}}{{gsave TR -.1 .1 TR rulex ruley scale 1 1
false RMat{BDot}imagemask grestore}}ifelse B /QV{gsave newpath transform
round exch round exch itransform moveto rulex 0 rlineto 0 ruley neg
rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N /tail
{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{
4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{
p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300 (dsl.dvi)
@start /Fa 2 115 df<13781318A6EA0F98EA1878EA2038EA601812C0A51260EA2038EA
1858EA0F9E0F147F9312>100 D<EAF3C0EA34E01238EA30401300A812FE0B0D7F8C0D>
114 D E /Fb 33 122 df<EB3FC03801F0303803C0380007137CEA0F80A2143891C7FCA4
B512FCA2380F807CAE397FE1FF80A2191D809C1B>12 D<127812FCA4127806067D850D>
46 D<1360EA01E0120F12FF12F31203B3A2387FFF80A2111B7D9A18>49
D<EB018013031307130F131F133F136F13CF138F1201EA030F1206120C12181230126012
C0B512F8A238000F80A6EBFFF8A2151B7F9A18>52 D<38380180383FFF005B5B5B13C000
30C7FCA4EA31F8EA361E38380F80EA3007000013C014E0A3127812F8A214C012F038600F
8038381F00EA1FFEEA07F0131B7E9A18>I<EB0380A2497EA3497EA2497E131BEB3BF813
31A2EB60FCA2EBE0FEEBC07EA248487E90B5FC481480EB001F4814C00006130FA248EB07
E0A239FF803FFEA21F1C7E9B24>65 D<B512F814FF390FC01F80EC0FC0140715E0A515C0
EC0F80EC3F00EBFFFE9038C00F80EC07C0EC03E0A215F0A5EC07E0A2EC1FC0B6120014FC
1C1C7E9B22>I<90381FE0209038FFF8E03803F80F3807C003380F800148C7FC123E1560
127E127C00FC1400A8007C1460127E123E15C07E390F8001803907C003003803F80E3800
FFFCEB1FE01B1C7D9B22>I<B512F814FF390FC01FC0EC07E0EC01F015F8140015FC157C
A2157EA8157CA315F8A2EC01F0EC07E0EC1FC0B6120014F81F1C7E9B25>I<EAFFFCA2EA
0FC0B3A6EAFFFCA20E1C7E9B12>73 D<D8FFC0EB03FF6D5B000F15F0D80DF0130DA3D80C
F81319A2017C1331A26D1361A26D13C1A390380F8181A2903807C301A2EB03E6A2EB01FC
A3EB00F8A23AFFC0701FFFA2281C7E9B2D>77 D<B512F014FE380FC03FEC0F806E7E81A5
5D4A5A023EC7FCEBFFF0EBC07C80143F6E7EA6ED8180A2EC0FC13AFFFC07C300EC01FE21
1C7E9B24>82 D<3807F820381FFEE0EA3C07EA7801EA700012F01460A26C130012FEEAFF
E0EA7FFE6C7E1480000F13C06C13E0EA007FEB03F01301130012C0A214E07E38F001C0EA
FC0338EFFF00EA83FC141C7D9B1B>I<007FB512E0A238781F81007013800060146000E0
147000C01430A400001400B03807FFFEA21C1C7E9B21>I<EA0FF8EA1C1E383E0F801307
14C0121C1200137FEA07E7EA1F07123C127C12F8A3EA780B383E13F8EA0FE115127F9117
>97 D<EA03FCEA0E0EEA1C1F123C1278130E00F8C7FCA61278EB0180123C381C0300EA0E
0EEA03F811127E9115>99 D<EB0FF0A21301A9EA01F9EA0F07EA1C03EA3C011278A212F8
A61278A2123CEA1C03380F0FFEEA03F9171D7E9C1B>I<EA03FCEA0F07381C0380383C01
C0127814E012F8A2B5FC00F8C7FCA3127814607E6C13C0380F03803801FC0013127F9116
>I<137F3801E3803803C7C0EA0787120FEB8380EB8000A5EAFFF8A2EA0F80AEEA7FF0A2
121D809C0F>I<3803F0F0380E1F38EA3C0F3838073000781380A400381300EA3C0FEA1E
1CEA33F00030C7FCA3EA3FFF14C06C13E014F0387801F838F00078A300701370007813F0
381E03C03807FF00151B7F9118>I<121E123FA4121EC7FCA6127FA2121FAEEAFFC0A20A
1E7F9D0E>105 D<B4FCA2121FB3A7EAFFE0A20B1D7F9C0E>108 D<39FF0FC07E903831E1
8F3A1F40F20780D980FC13C0A2EB00F8AB3AFFE7FF3FF8A225127F9128>I<38FF0FC0EB
31E0381F40F0EB80F8A21300AB38FFE7FFA218127F911B>I<EA01FC380F0780381C01C0
003C13E0387800F0A200F813F8A6007813F0A2383C01E0381E03C0380F07803801FC0015
127F9118>I<38FF3F80EBE1E0381F80F0EB0078147C143C143EA6143C147C1478EB80F0
EBC1E0EB3F0090C7FCA6EAFFE0A2171A7F911B>I<EAFE3E1347381E8F80A3381F070090
C7FCAAEAFFE0A211127F9114>114 D<EA1FD8EA3078EA601812E0A2EAF000EAFF80EA7F
E013F0EA1FF8EA07FCEA007CEAC01CA212E01318EAF830EACFC00E127E9113>I<1203A4
5AA25AA2EA3FFC12FFEA1F00A9130CA4EA0F08EA0798EA03F00E1A7F9913>I<38FF07F8
A2EA1F00AC1301120F380786FFEA01F818127F911B>I<38FFC1FCA2381F00601380000F
13C0A23807C180A23803E300A213F7EA01F613FE6C5AA21378A2133016127F9119>I<38
FFC7FCA2381F81C0380F83803807C700EA03EEEA01FC5B1200137C13FEEA01DF38039F80
EA070F380607C0380C03E038FF07FCA216127F9119>120 D<38FFC1FCA2381F00601380
000F13C0A23807C180A23803E300A213F7EA01F613FE6C5AA21378A21330A25B1270EAF8
E05BEAF9800073C7FC123E161A7F9119>I E /Fc 1 106 df<1206120712061200A41238
124CA2128C12981218A212301232A21264A2123808147F930C>105
D E /Fd 5 117 df<EAFFFEA2EA0780B31510A41530A21520156015E014011407B6FCA2
1C227DA122>76 D<B46CEC7FE0A2D805C0ECBC00A3D804E0EB013CA201701302A36D1304
A26D1308A36D1310A26D1320A29038038040A3903801C080A2903800E100A31472A2143C
A2121F3BFFE01807FFE0A22B227DA131>I<1304130EA3131FA2EB2F801327A2EB43C0A2
EBC3E01381A248C67EA2487F13FF38020078487FA3487F1218003C131F00FEEB7FE01B1A
7F991F>97 D<B512F8381E007814181408140C1404A3EB0200A31306EA1FFEEA1E061302
A3EB0002A314061404A2140C143CB512FC171A7E991C>101 D<007FB5FC38701E070060
1301124000C0148000801300A300001400B0133F3803FFF0191A7F991D>116
D E /Fe 16 123 df<120FEA03807F1201A27F1200A27F1370A213781338A2133C137C13
DEEA018EEA030EEA060F487E121C00381380EA700312E038C001C0121A7E9916>21
D<126012F0A2126004047D830B>58 D<1304130C1318A31330A31360A313C0A3EA0180A3
EA0300A31206A35AA35AA35AA35AA35AA20E257E9B13>61 D<127E120EA35AA45AA2EA39
E0EA3E10EA7818EA701C130C131C12E0A313181338EAC030EAE070EA60E0EA2180EA1F00
0E1A7F9910>98 D<EB0FC01301A3EB0380A4EB0700A2EA03E7EA0617EA1C0E1238123012
70EA601C12E0A3133912C012E0EA6079EA219AEA1E0E121A7F9914>100
D<EA01F0EA0608EA1C04123812701308EAFFF0EAE000A41304EA60081310EA3060EA0F80
0E107F8F12>I<EB07C0EB0C60EB1CE0EB18C0EB3800A45BA2EA07FFEA0070A25BA5485A
A6485AA390C7FCA2126712E65A127813217E9913>I<EBF980380185C038070380120E12
0C121C381807001238A3130E12301238EA181EEA087CEA079CEA001CA25B1260EAE07048
5AEA7F801217808F12>I<120313801300C7FCA7123C124EA2128EA2129C121CA25AA212
391271A21272A2123C091A7E990D>105 D<EA703EEA58C7389D0380129E129CA2383807
00A3130E00701340A2131C1480EAE00C3860070012107E8F17>110
D<1206120EA45AA2EAFFE0EA1C005AA45AA4EAE080A2EAE100A2126612380B177E960E>
116 D<EA3803004C1380384E0700128E129CA2EA1C0E1238A338701C80A3EA303C38184D
00EA0F8711107E8F16>I<381C0306002613873847070700871303128EA2380E0E02121C
A338381C04A200181308001C1310380C26303807C3C018107E8F1C>119
D<380787803808C8C0EA10F1EA20E01400A2EA01C0A4EA0381A212C3EAE582EAC584EA78
7812107F8F16>I<EA3803004C1380384E0700128E129CA2EA1C0E1238A3485AA3EA303C
6C5AEA0FB8EA00385B1260EAE0E0485AEA4380003EC7FC11177E8F13>I<EA0381EA07C2
EA0FFCEA10041308EA003013401380EA01001202EA0C041210EA200CEA3FF8EA41F0EA80
E010107F8F12>I E /Ff 20 117 df<1380EA010012025A120C120812185AA35AA412E0
AA1260A47EA37E1208120C12047E7EEA008009267D9B0F>40 D<7E12407E7E1218120812
0C7EA37EA41380AA1300A41206A35A1208121812105A5A5A09267E9B0F>I<B61280A2C9
FCA6B61280A2190A7E8D1E>61 D<12FEA212C0B3AF12FEA207257D9B0B>91
D<12FEA21206B3AF12FEA20725809B0B>93 D<EA1FC0EA38707FEA101C1200A2EA03FCEA
1E1C1238127012E01480A2133CEA705F381F8F0011107F8F13>97
D<12FC121CA913FCEA1D07381E0380381C01C0130014E0A6EB01C01480381E0300EA1906
EA10F8131A809915>I<EA07F8EA1C1C1238EA700813005AA612701304EA3808EA1C18EA
07E00E107F8F11>I<133F1307A9EA03E7EA0C17EA180F487E127012E0A6126012706C5A
EA1C373807C7E0131A7F9915>I<EA07C0EA1C30EA30181270EA600C12E0EAFFFCEAE000
A41260EA7004EA3808EA1C18EA07E00E107F8F11>I<EA01F0EA0718EA0E38EA1C101300
A6EAFFC0EA1C00AEEAFF800D1A80990C>I<EA0FCF3818718038303000EA7038A4EA3030
6C5AEA2FC00060C7FCA21270EA3FF013FC6C7EEA600FEAC003A4EA6006EA381CEA07E011
187F8F13>I<12FC121CA9137CEA1D87381E0380A2121CAB38FF9FF0141A809915>I<1218
123CA212181200A612FC121CAE12FF081A80990A>I<12FC121CB3A6EAFF80091A80990A>
108 D<EAFC7CEA1D87381E0380A2121CAB38FF9FF01410808F15>110
D<EA07E0EA1C38EA300CEA700EEA6006EAE007A6EA6006EA700EEA381CEA1C38EA07E010
107F8F13>I<EAFC78EA1D9CEA1E1C1308EA1C00ABEAFF800E10808F0F>114
D<EA1F20EA60E0EA402012C0A2EAF000127FEA3FC0EA1FE0EA00F0EA8070133012C01320
EAF040EA8F800C107F8F0F>I<1208A41218A21238EAFFC0EA3800A81320A41218EA1C40
EA07800B177F960F>I E /Fg 5 104 df<B61280A219027D8A20>0
D<EA03C0EA0FF0EA1FF8EA3FFCEA7FFEA2B5FCA4EA7FFEA2EA3FFCEA1FF8EA0FF0EA03C0
10107E9115>15 D<153081A381A281811680ED00C0B712F8A2C912C0ED0380160015065D
A25DA35D25167E942A>33 D<133C13E0EA01C013801203AD13005A121C12F0121C12077E
1380AD120113C0EA00E0133C0E297D9E15>102 D<12F0121C12077E1380AD120113C0EA
00E0133C13E0EA01C013801203AD13005A121C12F00E297D9E15>I
E /Fh 72 127 df<EAC060EAE0E0A4EAC060A5EA40400B0B7C9614>34
D<EA3806EA7C0E126CEAEE1CA25BA2126CEA7C70123812005BA2485AA3485AA248C7FC13
0E131FEA0E1BEB3B80A2121CA238381B00131FEA180E111D7F9914>37
D<126012F012F812781218A31230A2126012C01280050C789614>39
D<EA01801203EA06005A121C121812385AA35AA91270A37E1218121C120C7EEA03801201
091D799914>I<128012C01260123012381218121C120EA31207A9120EA3121C12181238
1230126012C01280081D7C9914>I<EA0380A3EA638CEAF39EEA7FFCEA3FF8EA0FE0A2EA
3FF8EA7FFCEAF39EEA638CEA0380A30F107E9214>I<EA01C0A7B51280A33801C000A711
117F9314>I<127012F812FCA2127C120C1218123012E012C0060A798414>I<EAFFFEA30F
037E8C14>I<127012F8A312700505798414>I<1306130EA2131CA21338A21370A213E0A2
EA01C0A2EA0380A3EA0700A2120EA25AA25AA25AA25AA25A0F1D7E9914>I<EA07C0EA0F
E0EA1C70EA3838EA3018EA701CA2EAE00EA9EA701CA2EA3838A2EA1C70EA0FE0EA07C00F
177E9614>I<1203A25A5A123F12F712471207AEEA7FF0A20C177C9614>I<EA0FC0EA1FF0
EA3838EA701CEAE00EA312401200131CA213381330137013E0EA01C0EA030012065AEA18
0E1230EA7FFEA20F177E9614>I<EA0FC0EA1FF0EA3838EA701CA2122012001318133813
70EA0FE013F0EA0038131C130EA2124012E0A2EA701CEA7838EA3FF0EA0FC00F177E9614
>I<137813F8EA01B8A2EA0338A21206120E120C121C12381230127012E0B51280A23800
3800A548B4FCA211177F9614>I<EA7FFCA2EA7000A7EA77C0EA7FF0EA7838EA601CEA00
0C130EA2124012E0131C1260EA7878EA3FF0EA0FC00F177E9614>I<EA01F0EA07F8EA0E
1C121C1238EA30001270A25AEAE7C0EAEFF0EAF838EAF01C130CEAE00EA212601270130C
EA381CEA1C38EA0FF0EA07C00F177E9614>I<12E0EAFFFEA2EAE01C1338EA0030137013
E013C0120113801203A2EA0700A4120EA612040F187E9714>I<127012F8A312701200A6
127012F8A312700510798F14>58 D<127012F8A312701200A6126012F012F8A212781218
1230127012E012800515798F14>I<130E133E137C13F0EA03E0EA07C0EA1F00123E12F8
5A7E123E7EEA07C0EA03E0EA00F0137C133E130E0F137E9414>I<B51280A27EC8FCA338
7FFF80B5FCA211097F8F14>I<124012E012F8127C121EEA0F80EA07C0EA01F0EA00F813
3E131E133E13F8EA01F0EA07C0EA0F80EA1E00127C5A12E012400F157E9514>I<EA01C0
487EA21360A2EA0770A4EA0630EA0E38A4487EEA1FFCA2EA1C1CA2487EA238FE3F80A211
177F9614>65 D<3801F180EA07FFEA0E1FEA1C071238EA7003A348C7FCA738700380A338
380700121CEA0E0EEA07FCEA01F011177F9614>67 D<EAFFE013F8EA383C7F130E7FA3EB
0380A8EB0700A2130E131E5BEAFFF813E011177F9614>I<B5FCA2EA3807A490C7FCA213
38A2EA3FF8A2EA3838A290C7FCA3EB0380A4B5FCA211177F9614>I<B51280A2EA3803A4
90C7FCA21338A2EA3FF8A2EA3838A290C7FCA7B4FCA211177F9614>I<EA03C6EA0FFEEA
1C3EEA181E1238EA700EA21260EAE000A4137FA2130E12601270A2EA381E1218EA1C3EEA
0FFEEA03CE10177F9614>I<38FC1F80A2007C1300EA7637A4EA7777A2EA7367A313E7EA
71C7A2EA7007A638F80F80A211177F9614>77 D<38FE3F80A2383E0E00123BA4138E1239
A213CEA31238A213EE136EA4133E12FEA211177F9614>I<EA1FF0EA7FFCEA783CEA701C
EAE00EAFEA701CEA783CEA7FFCEA1FF00F177E9614>I<EAFFF013FCEA381E130E1307A5
130E131EEA3FFC13F0EA3800A812FEA210177F9614>I<EAFFE013F8EA383C131C7FA45B
133CEA3FF85BEA38387FA51480EB1DC0A238FE0F80EB070012177F9614>82
D<EA0FCCEA1FFCEA307CEA603CEAE01CA313001270127EEA3FE0EA0FF0EA01F8EA001C13
1E130E126012E0A2EAF01CEAF838EAFFF0EAC7E00F177E9614>I<387FFF80B5FCEAE1C3
A43801C000AFEA0FF8A211177F9614>I<38FC1F80A238380E00A3EA3C1EEA1C1CA46C5A
A4EA0630EA0770A3EA0360A213E0A26C5A11177F9614>86 D<38FC1F80A238700700A7EA
31C6EA33E6EA3BEE136EA5EA1B6CA2EA1A2CEA1E3CA311177F9614>I<EAFFE0A2EAE000
B3A7EAFFE0A20B1D799914>91 D<EAFFE0A21200B3A712FFA20B1D7F9914>93
D<1204121FEA7FC0EAF1E012E00B057C9614>I<EAFFFEA30F037E7E14>I<EA1FC0EA7FF0
EA7078EA2018EA001CA2EA07FC121FEA3C1C127012E0A3EA707C383FFF80EA0F8F11107E
8F14>97 D<12FCA2121CA513F8EA1DFEEA1F07EA1E03001C1380EB01C0A6EB0380001E13
00EA1F0EEA1DFCEA0CF81217809614>I<EA03F8EA0FFEEA1C0EEA3804EA7000126012E0
A412601270EA380EEA1C1EEA0FFCEA03F00F107E8F14>I<137EA2130EA5EA07CEEA0FFE
EA1C3EEA301EEA700E12E0A61270EA301EEA383E381FEFC0EA07CF12177F9614>I<EA07
E0EA0FF0EA1C38EA301CEA700CEAE00EA2EAFFFEA2EAE00012601270EA380EEA1C1EEA0F
FCEA03F00F107E8F14>I<13FCEA01FEEA038EEA07041300A3EA7FFE12FFEA0700ACEAFF
F8A20F177F9614>I<EA07CF381FFF80EA383B38301800EA701CA3EA3018EA3838EA3FF0
EA37C00070C7FCA2EA3FF86C7E487EEA700F38E00380A438700700EA3C1EEA1FFCEA07F0
11197F8F14>I<12FCA2121CA51378EA1DFEEA1F86EA1E07121CAA38FF8FE0A213178096
14>I<1206120FA21206C7FCA4B4FCA21207ACEAFFF8A20D187C9714>I<12FCA2121CA5EB
FF80A2EB1C005B5B5BEA1DC0EA1FE0A2EA1E70EA1C38133C131C7F38FF1F80A211178096
14>107 D<EAFF80A21203B3EAFFFEA20F177E9614>I<EAFB8EEAFFDF383CF380A2EA38E3
AA38FEFBE013791310808F14>I<EAFC78EAFDFEEA1F86EA1E07121CAA38FF8FE0A21310
808F14>I<EA07C0EA1FF0EA3C78EA701CA2EAE00EA6EA701CEA783CEA3C78EA1FF0EA07
C00F107E8F14>I<EAFCF8EAFDFEEA1F07EA1E03001C1380EB01C0A6EB0380001E1300EA
1F0EEA1DFCEA1CF890C7FCA6B47EA21218808F14>I<EA03E7EA0FF7EA1C1FEA300F1270
487EA6EA700F1230EA1C3FEA0FF7EA07C7EA0007A6EB3FE0A213187F8F14>I<EAFE1FEB
7F80EA0EE3380F810090C7FCA2120EA8EAFFF0A211107F8F14>I<EA0FD8EA3FF8EA6038
12C0A2EAF000EA7F80EA3FF0EA07F8EA001CEA600612E012F0EAF81CEAFFF8EACFE00F10
7E8F14>I<1206120EA4EA7FFC12FFEA0E00A8130EA3131CEA07F8EA01F00F157F9414>I<
EAFC3FA2EA1C07AB131F380FFFE0EA03E71310808F14>I<38FE3F80A2383C1E00EA1C1C
A36C5AA3EA0630EA0770A36C5AA311107F8F14>I<38FE3F80A238700700EA380EA3EA39
CEA3EA1B6C121AA3EA1E7CA2EA0E3811107F8F14>I<EA7E3FA2EA1E3CEA0E78EA07705B
12036C5A12037FEA0770EA0E781338487E38FE3F80A211107F8F14>I<38FE3F80A2381C
0E005BA2120E5BA212071330A2EA0370A25B1201A25BA3485A12730077C7FC127E123C11
187F8F14>I<EA3FFF5AEA700E131C1338EA007013E0EA01C0EA0380EA0700120EEA1C07
12381270B5FCA210107F8F14>I<133E13FEEA01E0EA0380AAEA7F0012FE127FEA0380AA
EA01E0EA00FE133E0F1D7E9914>I<12E0B3AB031D789914>I<127812FE120FEA0380AAEA
01FCEA00FEEA01FCEA0380AAEA0F0012FE12780F1D7E9914>I<EA1C10EA3F38EAE7E0EA
41C00D047D9614>I E /Fi 12 122 df<130113031306A3130CA31318A31330A31360A2
13C0A3EA0180A3EA0300A31206A25AA35AA35AA35AA35AA210297E9E15>61
D<D801FE14FFD8003E14F0012EEB01E01502A21504014EEB09C0A201471311A20187EB23
801543A215833A0107010700A2EB0382A20002EB840E1488A214900004EBA01CA2EB01C0
120C001CEB803C3AFF8103FF80281C7E9B28>77 D<EA01E3EA0717EA0C0F1218EA380E12
301270A2485AA4EB3880A3EA607838319900EA1E0E11127E9116>97
D<123F1207A2120EA45AA4EA39E0EA3A30EA3C1812381270131CA3EAE038A31330137013
6013C01261EA2300121E0E1D7E9C12>I<EB07E01300A2EB01C0A4EB0380A43801E700EA
0717EA0C0F1218EA380E12301270A2485AA4EB3880A3EA607838319900EA1E0E131D7E9C
16>100 D<EA01F0EA0708120CEA1804EA38081230EA7030EA7FC0EAE000A51304EA6008
1310EA3060EA0F800E127E9113>I<EA01C01203A2EA0180C7FCA6121C12271247A21287
A2120EA25AA35A1380A21270EA71001232121C0A1C7E9B0E>105
D<EA3C1F384E6180384681C0EA4701128F128E120EA2381C0380A3EB070000381310A213
0E1420387006403830038014127E9119>110 D<13C01201A3EA0380A4EAFFF0EA0700A3
120EA45AA4EA3820A21340A2EA1880EA0F000C1A80990F>116 D<001C13C0EA27011247
A238870380A2120EA2381C0700A438180E20A3EA1C1E380C26403807C38013127E9118>
I<380787803808C8403810F0C03820F1E0EBE3C03840E1803800E000A2485AA438638080
12F3EB810012E5EA84C6EA787813127E9118>120 D<001C13C0EA27011247A238870380
A2120EA2381C0700A4EA180EA3EA1C1EEA0C3CEA07DCEA001C1318EA6038EAF0305B485A
EA4180003EC7FC121A7E9114>I E /Fj 54 127 df<38380180EA7C03A238EE0700A213
0EA35B127C5B1238C65AA35BA2485AA3485AEB8380380707C0A2380E0EE0A3121CA23838
07C0A23818038013207F9C16>37 D<12301278127C123C121CA41238127812F012E01240
060D789816>39 D<13E01201EA0380EA0700120E5AA25AA25AA35AA91270A37EA27EA27E
7EEA0380EA01E012000B217A9C16>I<12C07E12707E7E7EA27EA2EA0380A3EA01C0A9EA
0380A3EA0700A2120EA25A5A5A5A5A0A217B9C16>I<EA0380A4EAE38EEAF39EEAFFFEEA
3FF8EA0FE0A2EA3FF8EAFFFEEAF39EEAE38EEA0380A40F127D9516>I<13E0A8B512E0A3
3800E000A813137F9516>I<1238127C127EA2123E120E121E121C127812F01260070B79
8416>I<B51280A311037E8D16>I<127012F8A312700505788416>I<EA03E0EA0FF8487E
EA1E3CEA380EEA780FEA7007A238E00380A8EAF00700701300A2EA780FEA3C1E6C5AEA1F
FC6C5AEA03E011197E9816>48 D<12035AA25A5AB4FCA212E71207AEEAFFF8A30D197B98
16>I<EA07E0EA1FF8487EEA783EEAE00700F01380130312601200A2EB0700A2130E5B5B
5B5B485A485A000FC7FC381E03801238EA7FFFB5FC7E11197E9816>I<EA07E0EA1FF848
7EEA781E130712301200A2130E133EEA07FC13F013FCEA001E13077F1480A2126012F038
E00700EA781EEA3FFC6C5AEA07E011197E9816>I<137C13FC13DC1201EA039CA2EA071C
120F120E121E123C1238127812F0B512E0A338001C00A53801FFC0A313197F9816>I<EA
3FFE127FA20070C7FCA7EA77F0EA7FFC7FEA780FEA300738000380A2126012F0A238E007
00EA781EEA3FFC6C5AEA07E011197E9816>I<12E0B51280A338E00F00131EEA001C5B13
7813705BA2485AA3485AA448C7FCA7111A7E9916>55 D<127012F8A312701200A8127012
F8A312700512789116>58 D<1238127CA312381200A812381278127CA2123C121CA21238
127012F012400618799116>I<EB01801307131FEB3E0013F8485AEA07C0485A003EC7FC
12FC12F012FC123EEA0F806C7EEA01F06C7E133EEB1F801307130111157E9616>I<387F
FFC0B512E0A2C8FCA5B512E0A26C13C0130B7F9116>I<12C012F012FC123EEA0F806C7E
EA01F06C7E133EEB1F801307131FEB3E0013F8485AEA07C0485A003EC7FC12FC12F012C0
11157E9616>I<3801F180EA07FBEA0FFFEA1F0FEA3C07EA38031270A200F0C7FC5AA77E
38700380A21238383C0700EA1F0FEA0FFE6C5AEA01F011197E9816>67
D<EA7FF8EAFFFE6C7EEA1C0FEB0780EB03C01301A214E01300A8EB01C0A21303EB078013
0F387FFF00485AEA7FF81319809816>I<387FFFC0B5FC7EEA1C01A490C7FCA2131CA2EA
1FFCA3EA1C1CA290C7FC14E0A5EA7FFFB5FC7E13197F9816>I<38FC07E0EAFE0FA2383A
0B80EA3B1BA513BBEA39B3A413F3EA38E3A21303A538FE0FE0A313197F9816>77
D<EA7FF0EAFFFC6C7EEA1C0FEB07801303A41307EB0F00EA1FFE5B7FEA1C0E7FA4141014
38A2387F03F0EAFF83387F01E01519809816>82 D<387E03F038FF07F8387E03F0383800
E0A4381C01C0A3137113F9A213D9A2000C1380A3EA0DDD138DA338078F00A21307151980
9816>87 D<EAFFF0A3EAE000B3A8EAFFF0A30C20789C16>91 D<EAFFF0A3EA0070B3A8EA
FFF0A30C207F9C16>93 D<EA1FE0487E487EEA783CEA300E1200A2EA03FE121FEA3E0E12
7012E0A3EA783E387FFFE0EA3FE7EA0F8313127E9116>97 D<12FCA3121CA4137CEA1DFE
EA1FFFEB0780381E03C0EA1C01EB00E0A6EB01C0EA1E03381F0780EBFF00EA1DFEEA0C78
13197F9816>I<EA03F8EA0FFCEA1FFEEA3C1EEA780CEA70005AA57EEA70071278EA3E0E
EA1FFCEA0FF8EA03F010127D9116>I<133FA31307A4EA03C7EA0FF748B4FCEA3C1F487E
EA700712E0A6EA700F12786C5A381FFFE0EA0FF7EA07C713197F9816>I<EA03F0EA0FFC
487EEA3C0F487E3870038012E0B5FCA300E0C7FCA2387003801278EA3E07381FFF00EA07
FEEA01F811127E9116>I<131E137F3801FF8013C7380383001380A2EA7FFFB5FCA2EA03
80ACEA7FFC487E6C5A11197F9816>I<3803E3C03807F7E0EA0FFF381C1CC038380E00A5
6C5AEA0FF8485AEA1BE00038C7FC1218EA1FFC13FF481380387003C038E000E0A4387001
C0EA7C07383FFF80380FFE00EA03F8131C7F9116>I<12FCA3121CA41378EA1DFCEA1FFE
130FEA1E07121CAA38FF8FE0139F138F13197F9816>I<1203EA0780A2EA0300C7FCA4EA
FF80A31203ACEAFFFC13FE13FC0F1A7C9916>I<EA7FC012FF127F1201B3EA7FFFB51280
6C130011197E9816>108 D<38F9C38038FFEFC0EBFFE0EA3C78A2EA3870AA38FE7CF8A3
1512809116>I<EAFC78EAFDFCB47EEA1F0FEA1E07121CAA38FF8FE0139F138F13127F91
16>I<EA03E0EA0FF8487EEA3C1E487EEA700738E00380A5EAF00700701300EA780FEA3C
1EEA1FFC6C5AEA03E011127E9116>I<EAFC7CEAFDFEB5FC381F0780381E03C0EA1C01EB
00E0A6EB01C0EA1E03381F0780EBFF00EA1DFEEA1C7890C7FCA6B47EA3131B7F9116>I<
3803E380EA0FF3EA1FFBEA3E0FEA78071270EAE003A6EA70071278EA3C1FEA1FFBEA0FF3
EA03E3EA0003A6EB1FF0EB3FF8EB1FF0151B7F9116>I<387F0FC038FF3FE0EA7F7F3807
F040EBC0005BA290C7FCA8EA7FFC12FF127F13127F9116>I<EA0FECEA3FFC127FEAF03C
EAE01CA2EA7000EA7F80EA1FF0EA07F8EA003CEA600E12E012F0EAF81EEAFFFC13F8EAC7
E00F127D9116>I<12035AA4EA7FFFB5FCA20007C7FCA75BEB0380A3EB8700EA03FE6C5A
6C5A11177F9616>I<EAFC3FA3EA1C07AB131F381FFFE0EA0FF7EA07C713127F9116>I<38
7F1FC038FF9FE0387F1FC0381C0700A2EA0E0EA36C5AA4EA03B8A3EA01F0A26C5A13127F
9116>I<38FF1FE0A338380380A4EA39F3A20019130013B3A3EA1DB71317EA1F1FEA0F1E
EA0E0E13127F9116>I<387F1FC0133F131F380F1E006C5AEA03B813F012016C5A12017F
EA03B8EA073C131CEA0E0E387F1FC038FF3FE0387F1FC013127F9116>I<387F1FC038FF
9FE0387F1FC0381C0700120E130EA212075BA2EA039CA21398EA01B8A2EA00F0A35BA348
5A1279127BEA7F8090C7FC123C131B7F9116>I<383FFFC05AA238700780EB0F00131EC6
5A5B485A485AEA078048C7FC381E01C0123C1278B5FCA312127F9116>I<EA1C30EA3F78
EAFFF8EAF7E0EA61C00D057C9816>126 D E /Fk 6 117 df<EAFFF8000FC7FCB11404A3
140CA214081418143814F8B5FC161C7D9B1C>76 D<B46CEB3FE0000FEC3E00A2D80BC013
5EA2D809E0139EA33908F0011EA2EB7802A3EB3C04A2EB1E08A3EB0F10A2EB07A0A3EB03
C0A2EB0180121C3AFF8181FFE0231C7D9B29>I<3803F040380C0CC0EA1002EA3001EA60
0012E01440A36C13007E127EEA7FE0EA3FFC6CB4FC00071380EA007FEB07C0EB03E01301
13007EA36C13C0A238E0018038D00300EACE06EA81F8131E7D9C19>83
D<13201370A313B8A3EA011CA2EA031EEA020EA2487EEA07FFEA040738080380A2001813
C01301123838FC07F815157F9419>97 D<B51280EA1C031300A21440A213081400A21318
EA1FF8EA1C1813081420A213001460144014C01301B5FC13157F9417>101
D<387FFFF03860703000401310A200801308A300001300ADEA07FF15157F9419>116
D E /Fl 40 123 df<EAFFFCA40E047F8C13>45 D<13181378EA01F812FFA21201B3A738
7FFFE0A213207C9F1C>49 D<EA03FCEA0FFF383C1FC0387007E0007C13F0EAFE0314F8A2
1301127CEA3803120014F0A2EB07E014C0EB0F80EB1F00133E13385BEBE018EA01C0EA03
80EA0700000E1338380FFFF05A5A5AB5FCA215207D9F1C>I<13FE3807FFC0380F07E038
1E03F0123FEB81F8A3EA1F0314F0120014E0EB07C0EB1F803801FE007F380007C0EB01F0
14F8EB00FCA2003C13FE127EB4FCA314FCEA7E01007813F8381E07F0380FFFC03801FE00
17207E9F1C>I<14E013011303A21307130F131FA21337137713E7EA01C71387EA030712
07120E120C12181238127012E0B6FCA2380007E0A790B5FCA218207E9F1C>I<00301320
383E01E0383FFFC0148014005B13F8EA33C00030C7FCA4EA31FCEA37FF383E0FC0383807
E0EA3003000013F0A214F8A21238127C12FEA200FC13F0A2387007E0003013C0383C1F80
380FFF00EA03F815207D9F1C>I<EB1F80EBFFE03803E0703807C0F0380F01F8121F123E
A2387E00F0007C1300A2EAFC08EB7FC0EBFFE038FD80F038FF00F848137CA248137EA412
7CA3003C137C123E001E13F86C13F0380783E03803FFC0C6130017207E9F1C>I<126012
78387FFFFEA214FC14F8A214F038E0006014C038C00180EB0300A2EA00065B131C131813
381378A25BA31201A31203A76C5A17227DA11C>I<13FE3803FFC0380703E0380E00F05A
1478123C123E123F1380EBE0F0381FF9E0EBFFC06C13806C13C06C13E04813F0381E7FF8
383C1FFCEA7807EB01FEEAF000143E141EA36C131C007813387E001F13F0380FFFC00001
130017207E9F1C>I<1238127C12FEA3127C12381200A81238127C12FEA3127C12380716
7C9510>58 D<1470A214F8A3497EA2497EA3EB067FA2010C7F143FA2496C7EA201307F14
0F01707FEB6007A201C07F90B5FC4880EB8001A2D803007F14004880000680A23AFFE007
FFF8A225227EA12A>65 D<B67E15F03907F001F86E7E157EA2157FA5157E15FE5DEC03F8
90B55AA29038F001FCEC007E811680151F16C0A6ED3F80A2ED7F00EC01FEB612F815C022
227EA128>I<D903FE138090381FFF819038FF01E33901F8003FD803E0131F4848130F48
481307121F48C71203A2481401127EA200FE91C7FCA8127EED0180127F7E15036C6C1400
120F6C6C1306D803F05B6C6C13386CB413F090381FFFC0D903FEC7FC21227DA128>I<B6
7E15F03907F003FCEC007E81ED1F80ED0FC0ED07E0A216F01503A316F8A916F0A3ED07E0
A2ED0FC0ED1F80ED3F00157EEC03FCB612F0158025227EA12B>I<B51280A23807F000B3
ACB51280A211227EA115>73 D<B512C0A2D807F0C7FCB31518A41538A21570A215F01401
1407B6FCA21D227EA122>76 D<D8FFF0EC0FFF6D5C000716E0D806FC1437A3017E1467A2
6D14C7A290391F800187A290390FC00307A3903807E006A2903803F00CA2903801F818A3
903800FC30A2EC7E60A2EC3FC0A2EC1F80A3EC0F00D8FFF091B5FC140630227EA135>I<
B512FEECFFC03907F007F0EC01F86E7E157E157FA6157E5D4A5AEC07F090B512C05D9038
F00FE06E7E6E7E6E7EA81606EC00FEEDFF0CB538803FF8ED0FF027227EA12A>82
D<3801FE023807FF86381F01FE383C007E007C131E0078130EA200F81306A27E1400B4FC
13E06CB4FC14C06C13F06C13F86C13FC000313FEEA003F1303EB007F143FA200C0131FA3
6C131EA26C133C12FCB413F838C7FFE00080138018227DA11F>I<EA0FFC383FFF80387E
07C0EB03E0130114F0123C1200A2133FEA03FDEA1FC1EA3F01127E12FCA4EA7E02EB0CF8
381FF87F3807E03F18167E951B>97 D<EBFF80000713E0380F83F0EA1F03123E127E387C
01E090C7FC12FCA6127C127EA2003E13186C1330380FC0603807FFC0C6130015167E9519
>99 D<EB01FEA2EB003EABEA01FC3807FFBE380F81FE381F007E003E133E127E127C12FC
A8127CA26C137E6C13FE380F83BE3907FF3FC0EA01FC1A237EA21F>I<13FE3807FF8038
0F87C0381E01E0003E13F0EA7C0014F812FCA2B5FCA200FCC7FCA3127CA2127E003E1318
6C1330380FC0703803FFC0C6130015167E951A>I<EB1FC0EB7FE0EBF1F0EA01E31203EA
07C3EBC1E0EBC000A6EAFFFEA2EA07C0B2EA3FFCA2142380A211>I<3801FE0F3907FFBF
80380F87C7381F03E7391E01E000003E7FA5001E5BEA1F03380F87C0EBFF80D809FEC7FC
0018C8FCA2121C381FFFE06C13F86C13FE001F7F383C003F48EB0F80481307A40078EB0F
006C131E001F137C6CB45A000113C019217F951C>I<B4FCA2121FABEB07E0EB1FF8EB30
7CEB403CEB803EA21300AE39FFE1FFC0A21A237EA21F>I<121C123E127FA3123E121CC7
FCA7B4FCA2121FB2EAFFE0A20B247EA310>I<B4FCA2121FABECFF80A2EC38001460495A
495A49C7FC130E5B137E13FF13CFEB0F806D7E6D7E1301806D7E147C143C39FFE0FFC0A2
1A237EA21E>107 D<B4FCA2121FB3ADEAFFE0A20B237EA210>I<3AFF07F007F090391FFC
1FFC3A1F303E303E01401340496C487EA201001300AE3BFFE0FFE0FFE0A22B167E9530>
I<38FF07E0EB1FF8381F307CEB403CEB803EA21300AE39FFE1FFC0A21A167E951F>I<13
FE3807FFC0380F83E0381E00F0003E13F848137CA300FC137EA7007C137CA26C13F8381F
01F0380F83E03807FFC03800FE0017167E951C>I<38FF0FE0EB3FF8381FE07CEB803E49
7E1580A2EC0FC0A8EC1F80A29038803F00EBC03EEBE0FCEB3FF8EB0FC090C8FCA8EAFFE0
A21A207E951F>I<EAFE1FEB3FC0381E67E013C71387A2381F83C090C7FCADEAFFF0A213
167E9517>114 D<EA0FF3EA3FFFEA781FEA6007EAE003A212F000FCC7FCEA7FE013F8EA
3FFEEA0FFF120138000F80EAC007130312E0A238F00700EAFC0EEAEFFCEAC7F011167E95
16>I<487EA41203A21207A2120F123FB5FCA2EA0F80ABEB8180A5EB8300EA07C3EA03FE
EA00F811207F9F16>I<38FF01FEA2381F003EAF147E14FE380F81BE3907FF3FC0EA01FC
1A167E951F>I<39FFE01FE0A2391F800700000F1306EBC00E0007130C13E000035BA26C
6C5AA26C6C5AA2EB7CC0A2137F6D5AA26DC7FCA2130EA21B167F951E>I<3AFFE3FF07F8
A23A1F007800C09038807C01000F1580A23A07C07E030014DE5D3903E1DF06148FD801F1
138CEBF307A2D800FF13D8EBFE0315F890387C01F0A2013C5BEB3800A225167F9528>I<
387FFFF0A2387C03E0387007C0EA600F38E01F8000C01300133E137EC65A5B485A000313
30EA07E013C0380F8070121F383F0060003E13E0EA7C03B5FCA214167E9519>122
D E /Fm 64 123 df<14FE90380301801306EB0C03EB1C0191C7FC13181338A43803FFFE
3800700EA35CA213E0A25CA3EA01C01472A438038034141891C7FC90C8FCA25A12C612E6
5A12781925819C17>12 D<133C0163133001C1137038018080000314201301D807031340
EC0080390E00010014025CEBE01A380F1021000E1341EC8080EA1A203839C10038300160
387000E0A248EB0100A31402A200605B00705B00305B6C1360380E0380D801FCC7FC1C1F
7B9D20>38 D<1218123CA31204A21208A21210122012401280060C779C0D>I<13031306
130813181330136013C0A2EA0180EA0300A21206A25AA2121C1218A212381230A21270A2
1260A412E0A51260A51220123012107EA2102A7B9E11>I<1310A21308130C13041306A5
1307A51306A4130EA2130CA2131C1318A213381330A21360A213C0A2EA0180EA0300A212
065A5A121012605A102A809E11>I<12181238127812381208A21210A212201240A21280
050C7D830D>44 D<EAFFC0A30A037D890F>I<1230127812F0126005047C830D>I<133EEB
E180380181C0EA03005A1206000E13E0120C001C13C0A2EA18011238A338700380A43860
070012E01306130EA2130C5BEA60385BEA30C0001FC7FC131D7C9B15>48
D<1304130C131813381378EA07B8EA0070A413E0A4EA01C0A4EA0380A4EA0700A45AEAFF
F00E1C7B9B15>I<133EEB4180EB80C0EA0100000213E0EA0440A21208A3381081C0A238
110380000E1300EA00065B5B136013800003C7FC12044813404813805AEB0100EA7F07EA
43FEEA81FCEA8078131D7D9B15>I<131FEB60C013803801006012021340000413E0A3EB
81C0EA030138000380EB070013FC131C1306A21307A41270EAE00E12805BEA40185BEA20
E0EA1F80131D7D9B15>I<EB018014C0EB0380A314005BA21306130E130C131C1318A25B
A25B134013C6EA018E130E1202EA061C120C1218123FEA40F838803F8038003800A25BA4
5B136012247E9B15>I<EB80603801FFC01480EBFE0090C7FC1202A45A13F8EA050CEA06
06120C1208120013071306130EA21270130CEAE01CEA80181338EA40305BEA21C0001FC7
FC131D7C9B15>I<EB0F80EB3860EB6020EBC0E0EA018048C7FC1206120E120C121C13F8
EA3904EA3A06EA3C031278A2007013801400EA600712E0A21306130E130CEA601C1318EA
2030EA30C0EA0F80131D7C9B15>I<3809C040380FE080EA1FE1381C6100EA3026EA201A
EA6004EA400CEA80081318485AA25BA25BA212015B120390C7FC5AA3120EA35AA2121812
1D799B15>I<131FEB60C0EBC060EA018038030030A200061360120714C013803803C100
13E6EA01FCEA0078EA01BCEA061E487E487E383003801220EA6001A238C00300A21306EA
60045BEA3830EA0FC0141D7D9B15>I<133E13E138018180380300C01206120E120C121C
A213011238A31303001813801307EA080B380C3300EA03C7EA0007130E130C131C1318EA
E0305BEA80C0EAC180003EC7FC121D7C9B15>I<1206120FA212061200AA1230127812F0
126008127C910D>I<1418A21438A21478A214B8EB0138A2EB023C141C1304130C130813
10A21320A2EB7FFCEBC01C1380EA0100141E0002130EA25A120C001C131EB4EBFFC01A1D
7E9C1F>65 D<48B5FC39003C038090383801C0EC00E0A35B1401A2EC03C001E01380EC0F
00141EEBFFFC3801C00E801580A2EA0380A43907000F00140E141E5C000E13F0B512C01B
1C7E9B1D>I<903803F02090381E0C6090383002E09038E003C03801C001EA038048C7FC
000E1480121E121C123C15005AA35AA41404A35C12705C6C5B00185B6C485AD80706C7FC
EA01F81B1E7A9C1E>I<48B5FC39003C03C090383800E0A21570A24913781538A215785B
A4484813F0A315E03803800115C0140315803907000700140E5C5C000E13E0B512801D1C
7E9B1F>I<48B512F038003C00013813301520A35BA214081500495AA21430EBFFF03801
C020A439038040801400A2EC0100EA07005C14021406000E133CB512FC1C1C7E9B1C>I<
48B512F038003C00013813301520A35BA214081500495AA21430EBFFF03801C020A44848
5A91C7FCA348C8FCA45AEAFFF01C1C7E9B1B>I<903803F02090381E0C6090383002E090
38E003C03801C001EA038048C7FC000E1480121E121C123C15005AA35AA2903801FF8090
38001E00141CA400705BA27E001813786C139038070710D801F8C7FC1B1E7A9C20>I<3A
01FFC3FF803A003C00780001381370A4495BA449485AA390B5FC3901C00380A4484848C7
FCA43807000EA448131E39FFE1FFC0211C7E9B1F>I<EA03FFEA00781370A413E0A4EA01
C0A4EA0380A4EA0700A4120EA4121EEAFFC0101C7D9B10>I<EB3FF8EB03C01480A4EB07
00A4130EA45BA45BA4EA607012E0EAC060EA80E0EA81C0EA4380003EC7FC151D7C9B16>
I<3A01FFC07F803A003C001E000138131815205D5DD97002C7FC5C5C5CEBE04014C013E1
EBE2E0EA01C4EBD07013E013C048487EA21418141CEA070080A348130F39FFE07FC0211C
7E9B20>I<3801FFC038003C001338A45BA45BA4485AA438038002A31404EA0700140C14
181438000E13F0B5FC171C7E9B1A>I<D801FEEB01FED8003E14E0012EEB03C01505A215
09014EEB0B801513152313470187EB4700A21587EC0107D80107130E14021404A2000249
5AEB0388149014A000045C14C0A2000C1380001CEB007839FF8307FF271C7E9B25>I<D8
01FCEBFF80D8001CEB1C00012E13181510A2132701475B13431480A2903881C040A3EB80
E0D801005B1470A300020139C7FCA3141D48131E140EA2120C001C1304EAFF80211C7E9B
1F>I<EB07F0EB1C1CEB700E497E3901C00380EA0380EA0700000E14C0121E121C123CA2
5AA348EB0780A3EC0F00A2140E141E5C007013385C00785B383801C06C485AD80E0EC7FC
EA03F81A1E7A9C20>I<3801FFFE39003C038090383801C0EC00E0A3EB7001A315C0EBE0
031580EC0700141C3801FFF001C0C7FCA3485AA448C8FCA45AEAFFE01B1C7E9B1C>I<38
01FFFE39003C078090383801C015E01400A2EB7001A3EC03C001E01380EC0700141CEBFF
E03801C03080141CA2EA0380A43807003C1520A348144039FFE01E80C7EA0F001B1D7E9B
1E>82 D<EB0F84EB304CEB403CEB8018EA01005AA200061310A214001207A2EA03E013FC
6CB4FC38007F80EB07C01301A21300A21220A238600180A2EB03001302EAF004EACC18EA
83E0161E7D9C17>I<001FB512C0381C070138300E0000201480126012405B1280A20000
14005BA45BA45BA4485AA41203EA7FFE1A1C799B1E>I<3AFF83FF07F03A3C007001C000
38158002F01300A290380170025D13025D13045D13085D131001305B1320D81C405BA2D9
8071C7FCA2381D0072A2001E1374A2001C1338A20018133014201210241D779B29>87
D<EA01E3EA0717EA0C0F1218EA380E12301270A2EAE01CA41339A3EA6079EA319AEA1E0C
10127C9115>97 D<123F1207A2120EA45AA4EA39E0EA3A18EA3C0C12381270130EA3EAE0
1CA31318133813301360EA60C0EA3180EA1E000F1D7C9C13>I<13F8EA0304120EEA1C0E
EA181CEA30001270A25AA51304EA60081310EA3060EA0F800F127C9113>I<EB07E01300
A2EB01C0A4EB0380A43801E700EA0717EA0C0F1218EA380E12301270A2485AA41339A3EA
6079EA319AEA1E0C131D7C9C15>I<13F8EA0704120CEA1802EA38041230EA7008EA7FF0
EAE000A5EA60041308EA30101360EA0F800F127C9113>I<EB03C0EB0670130CEB1C6014
00A25BA53803FF8038007000A55BA5485AA5485AA390C7FCA25A12C612E65A1278142581
9C0D>I<EB78C0EA01C5EA03031206000E1380120C121CA238380700A4130EA3EA181EEA
0C7CEA079CEA001CA25BA2EAC030EAE070EAC1C0007FC7FC121A7E9113>I<EA0FC01201
A2485AA448C7FCA4EA0E3E13C3380F0380120E121E121CA338380700A3130E00701340A2
131C1480EAE00C38600700121D7E9C15>I<EA01801203EA0100C7FCA7121C12261247A2
128EA2120E5AA35AA21271A31272A2123C091C7C9B0D>I<EA0FC01201A2485AA448C7FC
A4380E07801308EB11C01321381C4180EB8000001DC7FC121EEA3FC0EA38E01370A2EA70
71A31372EAE032EA601C121D7E9C13>107 D<EA1F801203A2EA0700A4120EA45AA45AA4
5AA412E2A312E412641238091D7D9C0B>I<391C1E078039266318C0394683A0E0384703
C0008E1380A2120EA2391C0701C0A3EC0380D8380E1388A2EC0708151039701C03203930
0C01C01D127C9122>I<EA383EEA4CC3384D0380124E129E129C121CA238380700A3130E
00701340A2131C1480EAE00C3860070012127C9117>I<13F8EA030CEA0E06487E121812
3000701380A238E00700A3130EA25BEA60185BEA30E0EA0F8011127C9115>I<38038780
3804C860EBD03013E0EA09C014381201A238038070A31460380700E014C0EB0180EB8300
EA0E86137890C7FCA25AA45AB4FC151A809115>I<EA01E1EA0713EA0C0F1218EA380E12
301270A2EAE01CA41338A3EA6078EA31F0EA1E701200A213E0A4EA01C0EA0FF8101A7C91
13>I<EA1C3CEA2642EA4687EA4707EA8E061300120EA25AA45AA45A123010127C9112>I<
EA01F0EA0608120C131CEA1818EA1C00121F13C0EA0FF01207EA00781338EA603012E012
C0EA8060EA60C0EA1F000E127D9111>I<12035AA3120EA4EAFFE0EA1C00A35AA45AA4EA
E080A2EAE100A2126612380B1A7C990E>I<381C0180EA2E03124EA2388E0700A2121CA2
EA380EA438301C80A3EA383C38184D00EA0F8611127C9116>I<EA1C06EA2E0EEA4E06A2
EA8E02A2121CA2EA3804A313081230A21310EA3820EA1840EA0F800F127C9113>I<381E
0183382703871247148338870701A2120EA2381C0E02A31404EA180C131C1408EA1C1E38
0C26303807C3C018127C911C>I<38038780380CC840380870E012103820E0C014001200
A2485AA4EA03811263EAE38212C5EA8584EA787813127E9113>I<381C0180EA2E03124E
A2388E0700A2121CA2EA380EA4EA301CA3EA383CEA1878EA0FB8EA003813301370EAE060
5BEA81800043C7FC123C111A7C9114>I<EA01C1EA07E1EA0FF6EA081CEA1008EA001013
2013401380EA010012025AEA08041210EA2C0CEA73F8EA41F0EA80E010127E9111>I
E /Fn 36 122 df<EB0FE0EB7FF8EBF81C3801E07C1203EA07C0A2143891C7FCA3EBC1FE
B5FCA23807C03EB0393FF9FFC0A21A20809F1D>12 D<EAFFF0A40C047F8B11>45
D<1238127C12FEA3127C123807077C860F>I<137013F0120712FF12F91201B3A4387FFF
C0A2121D7D9C1A>49 D<EA03FC381FFF8038381FC0387C07E038FE03F0A214F81301127C
1238EA000314F0A2EB07E0EB0FC01400131E5B13705B3801C018EA0380EA060048133838
1FFFF05A5AB5FCA2151D7E9C1A>I<EA03FC380FFF80381C0FC0383C07E0387E03F0A313
07003C13E01200EB0FC0EB3F803803FE005B38000F80EB07C0EB03E014F014F81238127C
12FEA214F012FC387807E0383C0FC0381FFF803803FC00151D7E9C1A>I<EB01C0130313
07A2130F131F133B1373136313C3EA01831203EA0703120E120C12181238127012E0B512
FEA2380007C0A6EBFFFEA2171D7F9C1A>I<001C13E0EA1FFF14C01480140013FC13C000
18C7FCA4EA19FE381FFF80381E07C0381803E0381001F0120014F8A2127812FCA314F0EA
7803007013E0383C0FC0380FFF00EA03FC151D7E9C1A>I<133F3801FFC03807C0E0EA0F
81381F03F0121E123E127CEB01E090C7FCEAFC1013FF00FD13C0EB03E038FE01F0A200FC
13F8A4127CA3003C13F0123E381E03E0380F07C03807FF803801FE00151D7E9C1A>I<12
60387FFFF8A214F014E014C038E0018038C00300A21306C65A5B13381330137013F0A248
5AA21203A41207A56C5A6C5A151E7D9D1A>I<1238127C12FEA3127C12381200A6123812
7C12FEA3127C123807147C930F>58 D<14E0A2497EA3497EA2EB06FCA2EB0EFEEB0C7EA2
497EA201307F141F01707FEB600FA2496C7E90B5FC4880EB8003000380EB0001A200066D
7EA2000E803AFFE00FFFE0A2231F7E9E28>65 D<B512FEECFFC03907C007E0EC03F0EC01
F815FCA515F8140315F0EC0FE090B5128015C09038C003F0EC01F815FC140015FEA515FC
1401EC03F8EC07F0B612E015001F1F7E9E25>I<B5FCA2EA07E0B3A9B5FCA2101F7E9E14>
73 D<3803FC08380FFF38381E03F8EA3800481378143812F01418A26C13007EEA7FC013
FE383FFF806C13C06C13E06C13F0C613F81307EB00FC147C143C12C0A36C1338147800F8
137038FE01E038EFFFC000811300161F7D9E1D>83 D<007FB512FCA2397C07E07C007014
1C0060140CA200E0140E00C01406A400001400B10003B512C0A21F1E7E9D24>I<EA07FC
381FFF80383F07C0EB03E0EB01F0A2120C1200133FEA07FDEA1F81EA3E01127C12F8A3EA
FC02EA7E0C383FF87E380FE03E17147F9319>97 D<B4FCA2121FAAEB1FC0EB7FF0EBE0F8
EB807CEB007E143EA2143FA6143EA2147C1380381EC1F8381C7FE038181F8018207E9F1D
>I<EA01FE3807FF80381F0FC0123EA2127CEB030000FCC7FCA6127C127E003E1360003F
13C0EA1F813807FF00EA01FC13147E9317>I<EB07F8A21300AAEA01F8EA07FEEA1F83EA
3E01EA7E00127CA212FCA6127CA2127EEA3E01EA1F07380FFEFFEA03F818207E9F1D>I<
EA01FE3807FF80380F83C0381E01E0383E00F05A14F812FCB5FCA200FCC7FCA3127CA26C
1318121E380F80703807FFE0C6138015147F9318>I<EB3F80EBFFC03803E3E0EA07C713
87120FEB83C0EB8000A5EAFFFCA2EA0F80B0EA7FF8A213207F9F10>I<3803FC3C380FFF
FE381E079E383C03DE007C13E0A5003C13C0381E0780381FFF00EA13FC0030C7FCA21238
383FFF806C13F06C13F84813FC3878007C0070133E00F0131EA30078133CA2383F01F838
0FFFE000011300171E7F931A>I<B4FCA2121FAAEB0FC0EB3FE0EB61F0EBC0F813801300
AD38FFE7FFA218207D9F1D>I<121C123E127FA3123E121CC7FCA6B4FCA2121FB0EAFFE0
A20B217EA00E>I<B4FCA2121FB3AAEAFFE0A20B207E9F0E>108 D<3AFE0FE03F8090391F
F07FC03A1E70F9C3E09039407D01F0EB807E121FEB007CAC3AFFE3FF8FFEA227147D932C
>I<38FE0FC0EB3FE0381E61F0EBC0F81380EA1F00AD38FFE7FFA218147D931D>I<48B4FC
000713C0381F83F0383E00F8A248137CA200FC137EA6007C137CA26C13F8A2381F83F038
07FFC00001130017147F931A>I<38FF1FC0EB7FF0381FE1F8EB80FCEB007EA2143E143F
A6143E147E147CEB80FCEBC1F8EB7FE0EB1F8090C7FCA7EAFFE0A2181D7E931D>I<EAFE
3EEB7F80381ECFC0138FA2121FEB030090C7FCABEAFFF0A212147E9316>114
D<EA0FE6EA3FFEEA701EEA600EEAE006A2EAF800EAFFC0EA7FF8EA3FFCEA1FFE1203EA00
1FEAC007A212E0EAF006EAF81EEAFFFCEAC7F010147E9315>I<1203A45AA25AA2123FEA
FFFCA2EA1F00AA1306A5EA0F8CEA07F8EA03F00F1D7F9C14>I<38FF07F8A2EA1F00AD13
01A2EA0F063807FCFF6C5A18147D931D>I<3AFFC7FE1FE0A23A1F00F0030014F8D80F80
1306A29038C1BC0E0007140CEBC3BE3903E31E18A29038F60F380001143001FE13B03900
FC07E0A2EBF80301785BA2903830018023147F9326>119 D<39FFE07F80A2391F001C00
380F8018A26C6C5AA26C6C5AA2EBF0E000015B13F900005B13FF6DC7FCA2133EA2131CA2
1318A2EA783012FC5BEAC0E0EAE1C0EA7F80001EC8FC191D7F931C>121
D E /Fo 84 128 df<EB7E1F3901C1B180390303E3C0000713C3000EEBC180903801C000
A6B512FC380E01C0B0387F87FC1A1D809C18>11 D<137E3801C180EA0301380703C0120E
EB018090C7FCA5B512C0EA0E01B0387F87F8151D809C17>I<EB7FC0EA01C1EA03031207
EA0E01A7B5FCEA0E01B0387FCFF8151D809C17>I<90383F07E03901C09C18380380F0D8
0701133C000E13E00100131892C7FCA5B612FC390E00E01CB03A7FC7FCFF80211D809C23
>I<121C121EEA07801203A3EAFF00128009087B7E12>24 D<1480EB01005B1302EA03F4
EA0E1CEA180EEA300B38701380EA603138E021C01341A21381A2EAE10100631380EA7203
00341300EA1C06EA0E1CEA0BF00010C7FC123012205A121A7F9515>28
D<EA6060EAF0F0EAF8F8EA6868EA0808A3EA1010A2EA2020EA4040EA80800D0C7F9C15>
34 D<9038030180A39038060300A5EB0C06A4495A007FB512F8B612FC3900301800A449
5AA4B612FC6C14F83900C0600048485AA438030180A4D80603C7FCA31E257E9C23>I<12
6012F012F812681208A31210A2122012401280050C7C9C0C>39 D<1380EA010012021206
5AA25AA25AA35AA412E0AC1260A47EA37EA27EA27E12027EEA0080092A7C9E10>I<7E12
407E12307EA27EA27EA37EA41380AC1300A41206A35AA25AA25A12205A5A092A7E9E10>
I<126012F0A212701210A41220A212401280040C7C830C>44 D<EAFFE0A20B0280890E>
I<126012F0A2126004047C830C>I<130113031306A3130CA31318A31330A31360A213C0
A3EA0180A3EA0300A31206A25AA35AA35AA35AA35AA210297E9E15>I<EA03C0EA0C30EA
1818EA300CA2EA700EEA6006A2EAE007ADEA6006A2EA700EEA300CA2EA1818EA0C30EA07
E0101D7E9B15>I<5A1207123F12C71207B3A5EAFFF80D1C7C9B15>I<EA07C0EA1830EA20
1CEA400C130EEAF00F12F81307A21270EA000F130EA2131CA213381370136013C0EA0180
EA0300EA0601120C1218EA1002EA3FFE127F12FF101C7E9B15>I<EA07E0EA1830EA201C
A2EA781E130E131E1238EA001CA2131813301360EA07C0EA0030131CA2130E130FA21270
12F8A3EAF00EEA401C1220EA1830EA07C0101D7E9B15>I<130CA2131C133CA2135C13DC
139CEA011C120312021204120C1208121012301220124012C0B512C038001C00A73801FF
C0121C7F9B15>I<EA300CEA3FF813F013C0EA2000A6EA23E0EA2C30EA3018131CEA200E
1200130FA3126012F0A3EA800EEA401E131CEA2038EA1870EA07C0101D7E9B15>I<13F0
EA030CEA0404EA0C0EEA181E1230130CEA7000A21260EAE3E0EAE430EAE818EAF00C130E
EAE0061307A51260A2EA7006EA300E130CEA1818EA0C30EA03E0101D7E9B15>I<124038
7FFF801400A2EA4002485AA25B485AA25B1360134013C0A212015BA21203A41207A66CC7
FC111D7E9B15>I<EA03E0EA0C30EA1008EA200C13061260A21270A2EA7C0CEA3E18EA3F
B0EA1FE0EA07F013F8EA18FCEA307EEA601E130FEAC0071303A4EA60021304EA300CEA1C
10EA07E0101D7E9B15>I<EA03C0EA0C30EA1818EA300C1270EA600EEAE006A21307A512
60EA700F1230EA1817EA0C27EA07C7EA0006A2130EEA300C127813181270EA2030EA10C0
EA0F80101D7E9B15>I<126012F0A212601200AA126012F0A2126004127C910C>I<126012
F0A212601200AA126012F0A212701210A41220A212401280041A7C910C>I<EB3F80EBC0
603803001800041304487F487F39201F0080EB70803940E04040EBC0381241D881801320
1283A51281EA41C000401440EBE078392070988090381F0F006CC8FC7E7E0003EB01E039
00C01F8090383FF0001B1D7E9C20>64 D<1306A3130FA3EB1780A2EB37C01323A2EB43E0
1341A2EB80F0A338010078A2EBFFF83802003CA3487FA2000C131F80001E5BB4EBFFF01C
1D7F9C1F>I<B512C0380F00788080140E140FA4140E141E5C14F8EBFFF0EB003C808080
1580A5EC0F00A2141E1478B512E0191C7F9B1D>I<90381F8080EBE06138018019380700
07000E13035A14015A00781300A2127000F01400A8007014801278A212386CEB0100A26C
13026C5B380180083800E030EB1FC0191E7E9C1E>I<B512C0380F00F0143C140E80A2EC
038015C01401A215E0A815C0A21403158014071500140E5C1470B512C01B1C7E9B20>I<
B512FC380F003C140C1404A214061402A213011400A35B13FF13037FA3140113001402A3
1406A2140C143CB512FC181C7E9B1C>I<B512F8380F007814181408A2140C1404A21301
1400A35B13FF13037FA490C7FCA8EAFFF8161C7E9B1B>I<90381F8080EBE06138018019
38070007000E13035A14015A00781300A2127000F01400A6ECFFF0EC0F80007013071278
A212387EA27E6C130B380180113800E06090381F80001C1E7E9C21>I<39FFF0FFF0390F
000F00AC90B5FCEB000FAD39FFF0FFF01C1C7F9B1F>I<EAFFF0EA0F00B3A8EAFFF00C1C
7F9B0F>I<3807FF8038007C00133CB3127012F8A21338EA7078EA4070EA30E0EA0F8011
1D7F9B15>I<39FFF01FE0390F000780EC060014045C5C5C5C5C49C7FC13021306130FEB
17801327EB43C0EB81E013016D7E1478A280143E141E80158015C039FFF03FF01C1C7F9B
20>I<EAFFF8EA0F8090C7FCB01408A31418A2141014301470EB01F0B5FC151C7E9B1A>I<
B46CEBFF80000FECF800A2390BC00178A33809E002A23808F004A3EB7808A3EB3C10A3EB
1E20A3EB0F40A2EB0780A3EB0300121C3AFF8307FF80211C7E9B26>I<B4EB1FF0390F80
03809038C00100120BEA09E0EA08F0A21378133C133E131E130F14811307EB03C1EB01E1
14F113001479147D143D141FA2808080121CB46C7E1C1C7F9B1F>I<EB3F80EBE0E03803
803848487E000E7F487F003C148000381303007814C0A20070130100F014E0A8007014C0
00781303A200381480003C1307001C14006C130E6C5B6C6C5A3800E0E0EB3F801B1E7E9C
20>I<B51280380F00E01478143C141C141EA5141C143C147814E0EBFF8090C7FCACEAFF
F0171C7E9B1C>I<B5FC380F01E0EB007880141C141EA4141C143C5CEB01E001FFC7FCEB
01E0EB0070147880A61510A2141CA239FFF00E20C7EA03C01C1D7E9B1F>82
D<3807E080EA1C19EA30051303EA600112E01300A36C13007E127CEA7FC0EA3FF8EA1FFE
EA07FFC61380130FEB07C0130313011280A300C01380A238E00300EAD002EACC0CEA83F8
121E7E9C17>I<007FB512C038700F010060130000401440A200C014201280A300001400
B1497E3803FFFC1B1C7F9B1E>I<39FFF01FF0390F000380EC0100B3A26C130213800003
5BEA01C03800E018EB7060EB0F801C1D7F9B1F>I<39FFE00FF0391F0003C0EC01806C14
00A238078002A213C000035BA2EBE00C00011308A26C6C5AA213F8EB7820A26D5AA36D5A
A2131F6DC7FCA21306A31C1D7F9B1F>I<3AFFE1FFC0FF3A1F003E003C001E013C13186C
6D1310A32607801F1320A33A03C0278040A33A01E043C080A33A00F081E100A39038F900
F3017913F2A2017E137E013E137CA2013C133C011C1338A20118131801081310281D7F9B
2B>I<39FFF003FC390F8001E00007EB00C06D13800003EB01006D5A000113026C6C5A13
F8EB7808EB7C18EB3C10EB3E20131F6D5A14C06D5AABEB7FF81E1C809B1F>89
D<387FFFF0EA7C01007013E0386003C0A238400780130F1400131E12005B137C13785BA2
485A1203EBC010EA0780A2EA0F00481330001E13205A14604813E0EAF803B5FC141C7E9B
19>I<12FEA212C0B3B312FEA207297C9E0C>I<EA0808EA1010EA2020EA4040A2EA8080A3
EAB0B0EAF8F8EA7878EA30300D0C7A9C15>I<12FEA21206B3B312FEA20729809E0C>I<EA
1FC0EA3070EA78387F12301200A2EA01FCEA0F1C12381270126000E01340A3EA603C3830
4E80381F870012127E9115>97 D<12FC121CAA137CEA1D87381E0180381C00C014E01460
1470A6146014E014C0381E018038190700EA10FC141D7F9C17>I<EA03F8EA0C0CEA181E
1230EA700CEA600012E0A61260EA70021230EA1804EA0C18EA03E00F127F9112>I<EB1F
801303AAEA03F3EA0E0BEA1807EA30031270126012E0A6126012701230EA1807EA0E1B38
03E3F0141D7F9C17>I<EA07E0EA0C30EA1818EA300CEA700EEA600612E0EAFFFEEAE000
A41260EA70021230EA1804EA0C18EA03E00F127F9112>I<13F8EA018CEA071E1206EA0E
0C1300A6EAFFE0EA0E00B0EA7FE00F1D809C0D>I<EB03803807C4C0EA1C783838388038
301800EA701CA4EA3018EA38386C5AEA27C00020C7FCA21230EA3FF86CB4FC1480EA2003
386001C0EAC000A33860018038300300EA1C0EEA07F8121C7F9215>I<12FC121CAA137C
1387EA1D03001E1380121CAD38FF9FF0141D7F9C17>I<1218123CA21218C7FCA712FC12
1CB0EAFF80091D7F9C0C>I<13C0EA01E0A2EA00C01300A7EA07E01200B3A21260EAF0C0
12F1EA6180EA3E000B25839C0D>I<12FC121CAAEB0FE0EB0780EB06005B13105B5B13E0
121DEA1E70EA1C781338133C131C7F130F148038FF9FE0131D7F9C16>I<12FC121CB3A9
EAFF80091D7F9C0C>I<39FC7E07E0391C838838391D019018001EEBE01C001C13C0AD3A
FF8FF8FF8021127F9124>I<EAFC7CEA1C87EA1D03001E1380121CAD38FF9FF014127F91
17>I<EA03F0EA0E1CEA1806487E00701380EA600100E013C0A600601380EA7003003013
00EA1806EA0E1CEA03F012127F9115>I<EAFC7CEA1D87381E0180001C13C0EB00E0A214
70A614E0A2EB01C0001E1380381D0700EA1CFC90C7FCA7B47E141A7F9117>I<3803E080
EA0E19EA1805EA3807EA7003A212E0A61270A2EA38071218EA0E1BEA03E3EA0003A7EB1F
F0141A7F9116>I<EAFCE0EA1D38EA1E78A2EA1C301300ACEAFFC00D127F9110>I<EA1F90
EA2070EA4030EAC010A212E0EAF800EA7F80EA3FE0EA0FF0EA00F8EA8038131812C0A2EA
E010EAD060EA8FC00D127F9110>I<1204A4120CA2121C123CEAFFE0EA1C00A91310A512
0CEA0E20EA03C00C1A7F9910>I<38FC1F80EA1C03AD1307120CEA0E1B3803E3F014127F
9117>I<38FF07E0383C0380381C0100A2EA0E02A2EA0F06EA0704A2EA0388A213C8EA01
D0A2EA00E0A3134013127F9116>I<39FF3FC7E0393C0703C0001CEB01801500130B000E
1382A21311000713C4A213203803A0E8A2EBC06800011370A2EB8030000013201B127F91
1E>I<38FF0FE0381E0700EA1C06EA0E046C5AEA039013B0EA01E012007F12011338EA02
1C1204EA0C0E487E003C138038FE1FF014127F9116>I<38FF07E0383C0380381C0100A2
EA0E02A2EA0F06EA0704A2EA0388A213C8EA01D0A2EA00E0A31340A25BA212F000F1C7FC
12F312661238131A7F9116>I<EA7FFCEA70381260EA407013F013E0EA41C012031380EA
0700EA0F04120E121CEA3C0CEA380812701338EAFFF80E127F9112>I<B512F01401808B
15>I<EA1C04EA3F08EA43F0EA80E00E047D9B15>126 D<EA6060EAF0F0A2EA60600C047C
9C15>I E /Fp 41 121 df<EB1FC0EB7020EBC0103801803800031378EA0700143091C7
FCA7B512F8380700781438B2397FE1FF80192380A21B>12 D<127012F812FCA212741204
A41208A21210A212201240060F7C840E>44 D<EAFFF8A20D02808B10>I<127012F8A312
7005057C840E>I<EA01F0EA071CEA0C06487E00381380A2387001C0A400F013E0AE0070
13C0A3EA780300381380A2381C0700EA0C06EA071CEA01F013227EA018>48
D<13801203120F12F31203B3A9EA07C0EAFFFE0F217CA018>I<EA03F0EA0C1CEA100700
201380384003C0A2008013E012F0EAF801A3EA2003120014C0A2EB07801400130E5B1318
5B5B5B485A90C7FC000213205A5A00181360481340383FFFC05AB5FC13217EA018>I<12
401260387FFFE014C0A23840008038C0010012801302A2485A5BA25B5BA21360134013C0
A21201A25B1203A41207A76CC7FC13237DA118>55 D<EA01F0EA060C487EEA1807383803
801270A238F001C0A314E0A5127013031238EA1805120CEA0619EA03E1380001C0A3EB03
80A21230387807001306EA700CEA20186C5AEA0FC013227EA018>57
D<497EA3497EA3EB05E0A2EB09F01308A2EB1078A3497EA3497EA2EBC01F497EA248B512
80EB0007A20002EB03C0A348EB01E0A348EB00F0121C003EEB01F839FF800FFF20237EA2
25>65 D<B512F8380F800E0007EB0780EC03C015E0140115F0A515E01403EC07C0EC0F80
EC3E00EBFFFE9038800780EC03C0EC01E015F0140015F8A6EC01F0A2EC03E0EC07C0000F
EB0F00B512FC1D227EA123>I<903807E0109038381830EBE0063901C0017039038000F0
48C7FC000E1470121E001C1430123CA2007C14101278A200F81400A812781510127C123C
A2001C1420121E000E14407E6C6C13803901C001003800E002EB381CEB07E01C247DA223
>I<B612C0380F80070007130114001540A215601520A314201500A3146014E013FF1380
14601420A315081400A21510A31530A2157015E0000F1303B6FC1D227EA121>69
D<903807F00890383C0C18EBE0023901C001B839038000F848C71278481438121E15185A
A2007C14081278A200F81400A7EC1FFF0078EB00F81578127C123CA27EA27E7E6C6C13B8
6C7E3900E0031890383C0C08903807F00020247DA226>71 D<EAFFFCEA0FC0EA0780B3AC
EA0FC0EAFFFC0E227EA112>73 D<EB0FE0EB783CEBE00E3903C0078039078003C0390F00
01E0000E1300001E14F0481478A2007C147CA20078143CA200F8143EA90078143C007C14
7CA2003C1478003E14F8001E14F06CEB01E0A239078003C03903C007803900E00E00EB78
3CEB0FE01F247DA226>79 D<B512F0380F803C0007130FEC078015C0140315E0A615C014
071580EC0F00143CEBFFF00180C7FCAE487EEAFFFC1B227EA121>I<B512E0380F803C00
07130E6E7E81140381A55D14075D020EC7FC143CEBFFE0EB80708080141E140E140FA481
A3168015C014073A0FC003C10039FFFC01E2C8127C21237EA124>82
D<3803F020380C0C60EA1802383001E0EA70000060136012E0A21420A36C1300A2127812
7FEA3FF0EA1FFE6C7E0003138038003FC0EB07E01301EB00F0A214707EA46C1360A26C13
C07E38C8018038C60700EA81FC14247DA21B>I<007FB512F83978078078006014180040
1408A300C0140C00801404A400001400B3A3497E3801FFFE1E227EA123>I<39FFFC07FF
390FC000F86C4813701520B3A5000314407FA2000114806C7E9038600100EB3006EB1C08
EB03F020237EA125>I<387FFFFE387E003E0078133C007013781260004013F012C0EB01
E0388003C0A2EB07801200EB0F005B131E5BA25BA25B1201EBE001EA03C0A2EA07801403
EA0F00001E1302A2481306140E48131E00F8137EB512FE18227DA11E>90
D<EA1FE0EA3038EA780C130EEA30071200A313FFEA07C7EA1E07123C1278127000F01308
A3130FEA7817383C2390380FC1E015157E9418>97 D<120E12FE121E120EAB131FEB61C0
EB8060380F0030000E1338143C141C141EA7141C143C1438000F1370380C8060EB41C038
083F0017237FA21B>I<EA01FEEA0703380C0780121C383803000078C7FC127012F0A712
700078134012386C1380380C0100EA0706EA01F812157E9416>I<14E0130F13011300AB
EA01F8EA0704EA0C02EA1C01EA38001278127012F0A7127012781238EA1801EA0C023807
0CF03801F0FE17237EA21B>I<EA01FCEA0707380C0380381C01C01238007813E0EA7000
12F0B5FC00F0C7FCA512700078132012386C13406C138038070300EA00FC13157F9416>
I<133E13E33801C780EA0387130748C7FCA9EAFFF80007C7FCB27FEA7FF0112380A20F>
I<14703803F198380E1E18EA1C0E38380700A200781380A400381300A2EA1C0EEA1E1CEA
33F00020C7FCA212301238EA3FFE381FFFC06C13E0383000F0481330481318A400601330
A2003813E0380E03803803FE0015217F9518>I<120E12FE121E120EABEB1F80EB60C0EB
80E0380F0070A2120EAF38FFE7FF18237FA21B>I<121C123EA3121CC7FCA8120E127E12
1E120EB1EAFFC00A227FA10E>I<120E12FE121E120EB3ADEAFFE00B237FA20E>108
D<390E1FC07F3AFE60E183803A1E807201C03A0F003C00E0A2000E1338AF3AFFE3FF8FFE
27157F942A>I<380E1F8038FE60C0381E80E0380F0070A2120EAF38FFE7FF18157F941B>
I<EA01FCEA0707380C0180381800C0003813E0481370A200F01378A700701370007813F0
003813E0381C01C0380E038038070700EA01FC15157F9418>I<EA0E3CEAFE46EA1E8FEA
0F0F13061300120EAD120FEAFFF010157F9413>114 D<EA0F88EA3078EA601812C01308
A212E0EAF000127FEA3FE0EA0FF0EA01F8EA003CEA801C130CA212C01308EAE018EAD030
EA8FC00E157E9413>I<1202A41206A3120E121E123EEAFFFCEA0E00AB1304A6EA070812
03EA01F00E1F7F9E13>I<000E137038FE07F0EA1E00000E1370AD14F0A2380601703803
82783800FC7F18157F941B>I<39FF8FF87F393E01E03C001CEBC01814E0000E1410EB02
60147000071420EB04301438D803841340EB8818141CD801C81380EBD00C140E3900F00F
00497EA2EB6006EB400220157F9423>119 D<38FF83FE381F00F0000E13C06C1380EB81
00EA0383EA01C2EA00E41378A21338133C134E138FEA0187EB0380380201C0000413E0EA
0C00383E01F038FF03FE17157F941A>I E /Fq 18 117 df<B612FCEDFF8016E03A03FC
001FF8ED03FCED00FE167FEE3F80EE1FC0A2EE0FE0A2EE07F0A417F8AA17F0A3EE0FE0A2
17C0161FEE3F80EE7F005EED03FCED1FF8B75A168003FCC7FC2D297EA834>68
D<B512F0A33803FC00B3B1B512F0A314297EA819>73 D<B512FCA3D803FCC8FCB3A3ED01
C0A415031680A21507A2150FA2151F157F913801FF00B7FCA322297EA828>76
D<D8FFFE92383FFF80A26D5D0003EFE000A2D9BF8014EFA2D99FC0EB01CFA2D98FE0EB03
8FA3D987F0EB070FA2D983F8130EA2D981FC131CA3D980FE1338A2027F1370A291383F80
E0A391381FC1C0A291380FE380A2913807F700A3EC03FEA26E5AA26E5AD8FFFE0203B512
80A2157039297DA840>I<9038FF80600003EBF0E0000F13F8381F80FD383F001F003E13
07481303A200FC1301A214007EA26C140013C0EA7FFCEBFFE06C13F86C13FE8000071480
6C14C0C6FC010F13E0EB007FEC1FF0140F140700E01303A46C14E0A26C13076C14C0B4EB
0F80EBE03F39E3FFFE0000E15B38C01FF01C297CA825>83 D<B500F0EBFFFEA3D803FCC7
EA0380B3AA0001ED07007F0000150E137F6D143CD91FC05B90390FF003F06DB55A010014
80DA1FFCC7FC2F297EA834>85 D<3803FF80000F13F0381F01FC383F80FE147F801580EA
1F00C7FCA4EB3FFF3801FC3FEA0FE0EA1F80EA3F00127E5AA4145F007E13DF393F839FFC
381FFE0F3803FC031E1B7E9A21>97 D<EC7FF0A31407ACEB3F873801FFF73807F03F380F
C00F381F8007EA3F00A2127EA312FEA8127EA27EA2381F800F380FC01F3907E07FFF3801
FFE738007F87202A7EA925>100 D<EB3FC03801FFF03803E07C380F803E001F7F130048
EB0F80127E15C0A200FE1307A2B6FCA248C8FCA3127EA2127F6CEB01C07E390F80038039
07C007003803F01E3800FFFCEB3FE01A1B7E9A1F>I<9038FF80F00003EBE3F8390FC1FE
1C391F007C7C48137E003EEB3E10007EEB3F00A6003E133E003F137E6C137C380FC1F838
0BFFE00018138090C8FC1238A2123C383FFFF814FF6C14C06C14E06C14F0121F383C0007
007CEB01F8481300A4007CEB01F0A2003FEB07E0390FC01F806CB5120038007FF01E287E
9A22>103 D<1207EA0F80EA1FC0EA3FE0A3EA1FC0EA0F80EA0700C7FCA7EAFFE0A3120F
B3A3EAFFFEA30F2B7EAA12>105 D<EAFFE0A3120FB3B2EAFFFEA30F2A7EA912>108
D<26FFC07FEB1FC0903AC1FFC07FF0903AC307E0C1F8D80FC49038F101FC9039C803F200
01D801FE7F01D05BA201E05BB03CFFFE3FFF8FFFE0A3331B7D9A38>I<38FFC07E9038C1
FF809038C30FC0D80FC413E0EBC80701D813F013D0A213E0B039FFFE3FFFA3201B7D9A25
>I<EB3FE03801FFFC3803F07E390FC01F80391F800FC0393F0007E0A2007EEB03F0A300
FE14F8A8007E14F0A26CEB07E0A2391F800FC0390FC01F803907F07F003801FFFC38003F
E01D1B7E9A22>I<38FFE1FE9038EFFF809038FE0FE0390FF803F09038F001F801E013FC
140015FEA2157FA8157E15FEA215FC140101F013F89038F807F09038FC0FE09038EFFF80
9038E1FC0001E0C7FCA9EAFFFEA320277E9A25>I<3803FE30380FFFF0EA3E03EA780012
7000F01370A27E00FE1300EAFFE06CB4FC14C06C13E06C13F0000713F8C6FCEB07FC1300
00E0137C143C7E14387E6C137038FF01E038E7FFC000C11300161B7E9A1B>115
D<13E0A41201A31203A21207120F381FFFE0B5FCA2380FE000AD1470A73807F0E0000313
C03801FF8038007F0014267FA51A>I E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 251 158 a Fq(DSL)23 b(Implemen)n(tation)h(Using)f(Staging)f
(and)h(Monads)371 278 y Fp(Tim)15 b(Sheard,)h(Zine-el-abidine)f
(Benaissa,)h(and)g(Emir)f(P)o(asalic)616 336 y(P)o(aci\014c)g(Soft)o(w)
o(are)h(Researc)o(h)g(Cen)o(ter)682 394 y(Oregon)h(Graduate)g
(Institute)424 452 y(P)l(.O.)e(Bo)o(x)h(91000)i(P)o(ortland,)e(Oregon)h
(97291-1000)j(USA)534 511 y Fo(sheard@cse.ogi.edu,)15
b(h)o(ttp://cse.ogi.edu/~)d(sheard)0 673 y Fn(Abstract)0
831 y Fo(The)17 b(impact)f(of)g(Domain)f(Sp)q(eci\014c)j(Languages)f
(\(DSLs\))0 881 y(on)25 b(soft)o(w)o(are)g(design)g(is)g(considerable.)
51 b(They)26 b(allo)o(w)0 931 y(programs)17 b(to)g(b)q(e)i(more)d
(concise)j(than)f(equiv)n(alen)o(t)f(pro-)0 981 y(grams)24
b(written)h(in)g(a)g(high-lev)o(el)e(programming)f(lan-)0
1031 y(guages.)44 b(They)23 b(reliev)o(e)g(programmers)e(from)f(making)
0 1080 y(decisions)i(ab)q(out)g(data-structure)i(and)d(algorithm)f(de-)
0 1130 y(sign,)h(and)f(th)o(us)h(allo)o(ws)e(solutions)h(to)g(b)q(e)h
(constructed)0 1180 y(quic)o(kly)m(.)42 b(Because)24
b(DSL's)e(are)g(at)g(a)g(higher)h(lev)o(el)f(of)0 1230
y(abstraction)16 b(they)g(are)h(easier)f(to)g(main)o(tain)d(and)i
(reason)0 1280 y(ab)q(out)h(than)g(equiv)n(alen)o(t)f(programs)f
(written)j(in)e(a)h(high-)0 1330 y(lev)o(el)f(language,)f(and)h(p)q
(erhaps)i(most)d(imp)q(ortan)o(tly)f Fm(they)0 1379 y(c)n(an)19
b(b)n(e)f(written)f(by)i(domain)g(exp)n(erts)f(r)n(ather)f(than)i(pr)n
(o-)0 1429 y(gr)n(ammers)p Fo(.)0 1529 y(The)d(problem)f(is)g(that)h
(DSL)g(implemen)o(tatio)o(n)d(is)j(costly)0 1579 y(and)d(prone)h(to)f
(errors,)i(and)e(that)g(high)g(lev)o(el)g(approac)o(hes)0
1628 y(to)24 b(DSL)g(implemen)o(tati)o(on)d(often)k(pro)q(duce)g
(ine\016cien)o(t)0 1678 y(systems.)c(By)15 b(using)f(t)o(w)o(o)h(new)g
(programmi)o(ng)d(language)0 1728 y(mec)o(hanisms,)d(program)h(staging)
g(and)h(monadic)e(abstrac-)0 1778 y(tion,)j(w)o(e)h(can)f(lo)o(w)o(er)h
(the)g(cost)g(of)f(DSL)g(implemen)o(tations)0 1828 y(b)o(y)e(allo)o
(wing)e(reuse)j(at)f(man)o(y)f(lev)o(els.)17 b(These)11
b(mec)o(hanisms)0 1877 y(pro)o(vide)18 b(the)i(expressiv)o(e)g(p)q(o)o
(w)o(er)f(that)f(allo)o(ws)g(the)h(con-)0 1927 y(struction)14
b(of)f(man)o(y)f(compiler)g(comp)q(onen)o(ts)h(as)h(reusable)0
1977 y(libraries,)i(pro)o(vide)g(a)h(direct)g(link)e(b)q(et)o(w)o(een)j
(the)f(seman-)0 2027 y(tics)f(and)f(the)h(lo)o(w-lev)o(el)e(implemen)o
(tation,)e(and)j(pro)o(vide)0 2077 y(the)h(structure)i(necessary)g(to)e
(reason)g(ab)q(out)g(the)g(imple-)0 2127 y(men)o(tation.)0
2343 y Fl(1)56 b(In)n(tro)r(duction)0 2501 y Fo(W)m(e)26
b(outline)h(an)f(impro)o(v)o(ed)g Fm(metho)n(d)h Fo(for)f(the)i(design)
0 2551 y(and)16 b(implemen)o(tatio)o(n)d(of)j(Domain-Sp)q(eci\014c)e
(Languages)0 2600 y(\(DSLs\).)35 b(The)20 b(metho)q(d)e(builds)h(up)q
(on)g(our)h(exp)q(erience)0 2650 y(with)9 b(staged)h(programming)c
(using)j(the)i(staged)f(program-)0 2700 y(ming)g(language)i
Fk(Met)m(aML)h Fo([27)o(,)f(26].)17 b(The)c(metho)q(d)f(also)1005
673 y(incorp)q(orates)j(ideas)f(from)e(other)i(researc)o(hers)j(in)d
(the)g(ar-)1005 723 y(eas)g(of)g(mo)q(dular)e(language)h(design)h([28)o
(,)f(24,)g(12)o(],)g(correct)1005 773 y(compiler)18 b(generation)i([15)
o(,)f(19)o(,)g(18,)g(16)o(,)g(10],)h(and)f(par-)1005
823 y(tial)c(ev)n(aluation)f([8)o(,)i(13)o(].)23 b(While)15
b(relying)g(on)h(recen)o(t)h(ad-)1005 873 y(v)n(ances)g(in)e
(functional)g(programming)d(\(suc)o(h)17 b(as)f(higher-)1005
922 y(order)i(t)o(yp)q(e)f(constructors,)i(and)e(lo)q(cal)f(p)q
(olymorphism)o(\),)1005 972 y(it)i(is)h(applicable)f(to)g
Fm(al)r(l)h(kinds)h(of)f(languages)p Fo(,)h(not)f(just)1005
1022 y(applicativ)o(e)12 b(ones.)18 b(The)13 b(metho)q(d)f(uni\014es)h
(man)o(y)e(of)i(these)1005 1072 y(ideas)h(in)o(to)f(a)h(coheren)o(t)h
(pro)q(cess.)1005 1171 y(A)e(problem)f(with)h(the)h(DSL)f(approac)o(h)g
(to)g(soft)o(w)o(are)g(con-)1005 1221 y(struction)e(is)f(its)g(cost.)18
b(Realizing)9 b(a)h(DSL)g(requires)h(an)f(im-)1005 1271
y(plemen)o(tation.)22 b(Suc)o(h)16 b(implemen)o(tatio)o(ns)e(are)i
(large)f(and)1005 1321 y(exp)q(ensiv)o(e)22 b(to)e(pro)q(duce.)38
b(So,)22 b(unless)f(man)o(y)d(solutions)1005 1371 y(are)i(required,)i
(it)e(ma)o(y)e(not)i(pa)o(y)g(to)f(build)h(a)f(compiler)1005
1421 y(or)g(other)h(implemen)o(tatio)o(n)d(mec)o(hanism.)31
b(DSL)19 b(imple-)1005 1470 y(men)o(tation)12 b(is)i(also)f
(conceptually)h(hard.)k(Most)c(soft)o(w)o(are)1005 1520
y(engineers)h(are)f(not)g(comfortable)f(taking)f(on)i(the)h(task)f(of)
1005 1570 y(language)h(design)h(and)f(implemen)o(tation.)20
b(Ev)o(en)d(if)d(they)1005 1620 y(are,)f(language)e(implemen)o(tatio)o
(n)f(is)i(a)g(di\016cult,)f(complex)1005 1670 y(pro)q(cess)16
b(that)f(do)q(es)g(not)f(easily)g(scale.)21 b(An)14 b(implemen)o(ta-)
1005 1719 y(tion)c(for)g(a)g(simple)e(language)i(often)g(do)q(es)h(not)
f(scale)h(as)f(the)1005 1769 y(language)h(ev)o(olv)o(es)i(to)f(meet)g
(new)o(er)h(demands.)k(Lo)o(w)o(ering)1005 1819 y(the)c(cost)h(of)e
(DSL)g(implemen)o(tations,)e(and)i(making)e(go)q(o)q(d)1005
1869 y(ones)h(more)f(manageable,)f(will)g(mak)o(e)g(the)j(DSL)e
(approac)o(h)1005 1919 y(applicable)j(to)h(a)f(broader)i(domain)c(of)j
(problems.)1005 2018 y(Our)g(approac)o(h)g(to)f(solving)g(these)i
(problems)e(is)g(to)h(apply)1005 2068 y(new)e(metho)q(ds)g(of)f
(abstraction)h(suc)o(h)h(as)f(monads)f([28)o(,)g(31)o(])1005
2118 y(and)h(staging)g([27)o(,)f(26])g(to)h(the)h(implemen)o(tation)c
(of)i(DSLs.)1005 2168 y(This)16 b(mak)o(es)g(the)h(e\013ort)g(required)
g(to)g(build)e(a)h(compiler)1005 2218 y(for)h(a)g(DSL)g(reusable)h(and)
f(spreads)h(the)g(cost)g(o)o(v)o(er)f(sev-)1005 2267
y(eral)12 b(DSLs.)18 b(T)m(o)11 b(mak)o(e)g(language)g(implemen)o
(tation)e(man-)1005 2317 y(ageable)14 b(for)g(the)h(masses,)f(there)i
(m)o(ust)d(exist)i(go)q(o)q(d)f(rules)1005 2367 y(of)19
b(th)o(um)o(b)f(for)h(language)f(implemen)o(tation.)31
b(One)21 b(w)o(a)o(y)1005 2417 y(to)16 b(accomplish)f(this)h(is)h(b)o
(y)f(elab)q(orating)f Fm(a)i(step)h(by)f(step)1005 2467
y(metho)n(d)d Fo(that)f(splits)h(the)g(lab)q(or)f(in)o(to)f(w)o
(ell-de\014ned)i(steps,)1005 2516 y(eac)o(h)f(with)f(a)h(relativ)o(ely)
f(small)e(amoun)o(t)h(of)h(w)o(ork.)17 b(In)c(our)1005
2566 y(metho)q(d,)h(eac)o(h)i(step)g(deals)f(with)g(an)g(orthogonal)f
(design)1005 2616 y(decision.)20 b(By)15 b(using)f(go)q(o)q(d)h
(abstraction)f(principles,)h(our)1005 2666 y(metho)q(d)e(partitions)h
(eac)o(h)g(design)g(decision)h(in)o(to)e(a)h(sepa-)p
eop
%%Page: 2 2
2 1 bop 0 42 a Fo(rate)17 b(co)q(de)g(mo)q(dule.)24 b(In)17
b(addition,)e(our)i(metho)q(d)e(mak)o(es)0 91 y(explicit)21
b(the)i(prop)q(ositions)f(that)g(m)o(ust)f(b)q(e)h(pro)o(v)o(ed)g(to)0
141 y(sho)o(w)d(the)g(correctness)i(of)d(the)h(compiler)e(with)i(resp)q
(ect)0 191 y(to)14 b(its)g(seman)o(tics.)0 291 y(Our)19
b(metho)q(d)f(comprises)g(the)i(follo)o(wing)c(steps.)33
b(First,)0 340 y(construct)22 b(the)g(denotational)d(seman)o(tics)i(as)
f(an)h(in)o(ter-)0 390 y(preter)29 b(in)e(a)g(functional)g(language.)58
b(Second,)31 b(cap-)0 440 y(ture)20 b(the)f(e\013ects)i(of)e(the)g
(language,)g(and)g(the)g(en)o(viron-)0 490 y(men)o(t)d(in)h(whic)o(h)g
(the)h(target)g(language)e(m)o(ust)g(run,)i(in)f(a)0
540 y(monad.)k(Then)16 b(rewrite)h(the)f(in)o(terpreter)h(in)f(a)f
(monadic)0 589 y(st)o(yle.)51 b(Third,)27 b(stage)e(the)h(in)o
(terpreter)h(using)d(meta-)0 639 y(programming)10 b(tec)o(hniques.)20
b(This)14 b(staging)g(is)g(similar)d(to)0 689 y(the)20
b(staging)f(of)g(in)o(terpreters)j(using)d(a)g(partial)g(ev)n(alua-)0
739 y(tor,)h(but)f(is)g(explicit)f(rather)i(than)f(implicit,)e(since)i
(the)0 789 y(programmer)12 b(places)k(the)f(annotations)f(directly)m(,)
g(rather)0 839 y(than)19 b(using)f(an)g(automatic)f(binding)h(time)f
(analysis)h(to)0 888 y(disco)o(v)o(er)f(where)h(they)f(should)f(b)q(e)i
(placed.)26 b(This)17 b(lea)o(v)o(es)0 938 y(programmers)23
b(in)h(complete)g(con)o(trol,)i(and)f(they)g(can)0 988
y(limit)8 b(what)j(app)q(ears)h(in)f(the)g(residual)g(program.)16
b(F)m(ourth,)0 1038 y(the)g(resulting)f(program)e(is)i(b)q(oth)g(a)f
(data-structure)j(and)0 1088 y(a)d(program,)f(so)h(it)g(can)h(b)q(e)g
(b)q(oth)f(directly)h(executed)h(and)0 1137 y(analyzed.)21
b(This)15 b(analysis)f(can)i(include)f(b)q(oth)g(source)h(to)0
1187 y(source)h(transformations,)d(or)h(translation)g(in)o(to)g
(another)0 1237 y(form)c(\(i.e.)17 b(in)o(termediate)12
b(co)q(de)i(or)f(assem)o(bly)e(language\).)0 1287 y(Because)16
b(the)e(programmer)e(has)i(complete)f(con)o(trol)h(o)o(v)o(er)0
1337 y(the)j(earlier)f(steps,)i(the)e(structure)j(of)c(the)i(residual)f
(pro-)0 1386 y(gram)8 b(is)i(highly)f(constrained,)i(and)e(this)h
(\014nal)g(translation)0 1436 y(can)k(b)q(e)h(a)e(trivial)g(task.)0
1536 y(Staging)h(of)h(in)o(terpreters)i(using)e(partial)f(ev)n
(aluation)g(has)0 1586 y(b)q(een)20 b(done)g(b)q(efore)f([1,)f(5].)33
b(The)20 b(con)o(tribution)e(of)h(this)0 1636 y(pap)q(er)12
b(is)g(to)f(sho)o(w)h(that)g(this)f(can)h(all)f(b)q(e)h(done)g(in)f(a)g
(single)0 1685 y(program.)19 b(A)14 b(system)h(incorp)q(orating)f
(staging)g(as)h(a)f(\014rst)0 1735 y(class)f(feature)g(of)e(a)h
(language)f(is)h(a)g(p)q(o)o(w)o(erful)g(to)q(ol.)17
b(While)0 1785 y(using)k(suc)o(h)h(a)e(to)q(ol)h(to)f(write)i(a)e
(compiler)g(the)i(source)0 1835 y(language)15 b(can)h(b)q(e)g(giv)o(en)
f(seman)o(tics,)g(it)h(can)g(b)q(e)g(staged,)0 1885 y(translated,)g
(and)f(optimized)f(all)g(in)h(a)h(single)f(paradigm.)0
1934 y(It)21 b(requires)h(neither)f(additional)e(pro)q(cesses)k(nor)e
(to)q(ols,)0 1984 y(and)16 b(is)g(under)h(the)g(complete)e(con)o(trol)h
(of)g(the)h(program-)0 2034 y(mer;)12 b(all)f(the)i(while)e(main)o
(taining)e(a)j(direct)h(link)f(b)q(et)o(w)o(een)0 2084
y(the)17 b(seman)o(tics)f(of)g(in)o(terpreter)i(and)e(those)i(of)d(the)
i(com-)0 2134 y(piler.)0 2346 y Fl(2)56 b(Staging)19
b(in)f(MetaML)0 2501 y Fk(Met)m(aML)27 b Fo(is)f(almost)e(a)i(conserv)n
(ativ)o(e)h(extension)g(of)0 2551 y(Standard)21 b(ML.)f(Its)h
(extensions)h(include)e(four)h(staging)0 2600 y(annotations.)g(T)m(o)15
b(dela)o(y)f(an)h(expression)h(un)o(til)f(the)g(next)0
2650 y(stage)c(one)f(places)h(it)f(b)q(et)o(w)o(een)i(meta-brac)o(k)o
(ets.)17 b(Th)o(us)10 b(the)0 2700 y(expression)h Fj(<23>)e
Fo(\(pronounced)i(\\brac)o(k)o(et)f(23"\))f(has)h(t)o(yp)q(e)1005
42 y Fj(<int>)i Fo(\(pronounced)i(\\co)q(de)f(of)f(in)o(t"\).)17
b(The)c(annotation,)1006 91 y Fj(~)-5 b Fi(e)15 b Fo(splices)g(the)h
(deferred)g(expression)f(obtained)g(b)o(y)f(ev)n(al-)1005
141 y(uating)h Fi(e)h Fo(in)o(to)f(the)h(b)q(o)q(dy)f(of)g(a)h
(surrounding)f(Brac)o(k)o(eted)1005 191 y(expression;)21
b(and)d Fj(run)j Fi(e)d Fo(ev)n(aluates)g Fi(e)h Fo(to)f(obtain)f(a)h
(de-)1005 241 y(ferred)g(expression,)g(and)e(then)i(ev)n(aluates)f
(this)f(deferred)1005 291 y(expression.)i(It)11 b(is)f(imp)q(ortan)o(t)
f(to)i(note)g(that)g Fj(~)l Fi(e)g Fo(is)f(only)g(le-)1005
340 y(gal)e(within)h(lexically)f(enclosing)h(Brac)o(k)o(ets.)18
b(W)m(e)9 b(illustrate)1005 390 y(the)j(imp)q(ortan)o(t)e(features)j
(of)e(the)h(staging)f(annotations)f(in)1005 440 y(the)k(short)h
Fk(Met)m(aML)g Fo(sessions)g(b)q(elo)o(w.)1005 574 y
Fh(-|)k(val)f(z)i(=)f(3+4;)1005 620 y(val)f(z)i(=)f(7)g(:)g(int)1005
757 y Fo(Users)25 b(access)g Fk(Met)m(aML)f Fo(through)f(a)h
Fm(r)n(e)n(ad-typ)n(e-eval-)1005 807 y(print)14 b Fo(top-lev)o(el.)19
b(The)c(declaration)f(for)g Fj(z)g Fo(is)g(read,)h(t)o(yp)q(e-)1005
857 y(c)o(hec)o(k)o(ed)21 b(to)e(see)i(that)f(it)f(has)h(a)g(consisten)
o(t)g(t)o(yp)q(e)g(\()p Fj(int)1005 907 y Fo(here\),)14
b(ev)n(aluated)f(\(to)f Fj(7)p Fo(\),)h(and)g(then)g(b)q(oth)g(its)g(v)
n(alue)f(and)1005 957 y(t)o(yp)q(e)i(are)h(prin)o(ted.)1005
1091 y Fh(-|)k(val)f(quad)g(=)1064 1136 y(\()h(3+4,)38
b(<3+4>,)76 b(lift)18 b(\(3+4\),)f(<z>)38 b(\);)1005
1182 y(val)18 b(quad)h(=)1064 1228 y(\()g(7,)78 b(<3)19
b(\045+)f(4>,)h(<7>,)155 b(<\045z>)18 b(\))i(:)1064 1273
y(\()f(int)g(*)g(<int>)e(*)59 b(<int>)18 b(*)97 b(<int>\))1005
1411 y Fo(The)18 b(declaration)f(for)f Fj(quad)h Fo(con)o(trasts)h
(normal)d(ev)n(alua-)1005 1461 y(tion)c(with)g(the)h(three)g(w)o(a)o
(ys)f(ob)r(jects)i(of)e(t)o(yp)q(e)h(co)q(de)g(can)f(b)q(e)1005
1511 y(constructed.)20 b(Placing)12 b(brac)o(k)o(ets)h(around)f(an)h
(expression)1005 1561 y(\()p Fj(<3+4>)p Fo(\))i(defers)i(the)f
(computation)e(of)h Fj(3+4)g Fo(to)g(the)h(next)1005
1610 y(stage,)f(returning)h(a)e(piece)i(of)e(co)q(de.)22
b(Lifting)14 b(an)h(expres-)1005 1660 y(sion)i(\()p Fj(lift)k(\(3+4\))p
Fo(\))c(ev)n(aluates)h(that)g(expression)h(\(to)e Fj(7)1005
1710 y Fo(here\))c(and)f(then)h(lifts)e(the)i(v)n(alue)e(to)h(a)g
(piece)h(of)e(co)q(de)i(that)1005 1760 y(when)19 b(ev)n(aluated)g
(returns)h(the)f(same)f(v)n(alue.)32 b(Brac)o(k)o(ets)1005
1810 y(around)13 b(a)g(free)h(v)n(ariable)f(\()p Fj(<z>)p
Fo(\))f(creates)k(a)d(new)g(constan)o(t)1005 1859 y(piece)18
b(of)e(co)q(de)i(with)e(the)i(v)n(alue)e(of)g(the)i(v)n(ariable.)26
b(Suc)o(h)1005 1909 y(constan)o(ts)19 b(prin)o(t)f(with)f(a)h
Fj(\045)g Fo(sign)f(to)h(indicate)g(they)h(are)1005 1959
y(constan)o(ts.)27 b(W)m(e)16 b(call)g(this)g Fm(lexic)n(al-c)n(aptur)n
(e)g Fo(of)g(free)h(v)n(ari-)1005 2009 y(ables.)32 b(Because)20
b(in)e Fk(Met)m(aML)i Fo(op)q(erators)f(\(suc)o(h)h(as)e
Fj(+)1005 2059 y Fo(and)g Fj(*)p Fo(\))g(are)h(also)e(iden)o
(ti\014ers,)j(free)f(o)q(ccurrences)i(of)c(op-)1005 2109
y(erators)g(in)e(constructed)j(co)q(de)f(often)f(app)q(ear)g(with)g
Fj(\045)f Fo(in)1005 2158 y(fron)o(t)f(of)f(them.)1005
2292 y Fh(-|)19 b(fun)f(inc)h(x)g(=)g(<1)g(+)g(~x>;)1005
2338 y(val)f(inc)h(=)g(Fn)39 b(:)19 b(['a].<int)o(>)e(->)h(<int>)1005
2472 y Fo(The)d(declaration)e(of)h(the)g(function)g Fj(inc)g
Fo(illustrates)g(that)1005 2517 y(larger)9 b(pieces)i(of)e(co)q(de)h
(can)g(b)q(e)g(constructed)i(from)c(smaller)1005 2563
y(ones)14 b(b)o(y)e(using)h(the)h(escap)q(e)h(annotation.)h(Brac)o(k)o
(eted)f(ex-)1005 2609 y(pressions)20 b(can)e(b)q(e)i(view)o(ed)e(as)h
Fm(fr)n(ozen)p Fo(,)g(i.e.)31 b(ev)n(aluation)1005 2654
y(do)q(es)14 b(not)g(apply)f(under)h(brac)o(k)o(ets.)19
b(Ho)o(w)o(ev)o(er,)14 b(is)g(it)f(often)1005 2700 y(con)o(v)o(enien)o
(t)19 b(to)g(allo)o(w)e(some)h(reduction)i(steps)g(inside)f(a)p
eop
%%Page: 3 3
3 2 bop 0 42 a Fo(large)11 b(frozen)g(expression)h(while)f(it)f(is)h(b)
q(eing)g(constructed,)0 87 y(b)o(y)19 b(\\splicing")f(in)h(a)g
(previously)g(constructed)i(piece)g(of)0 133 y(co)q(de.)f
Fk(Met)m(aML)15 b Fo(allo)o(ws)e(one)i(to)f Fm(esc)n(ap)n(e)h
Fo(from)d(a)i(frozen)0 178 y(expression)20 b(b)o(y)g(pre\014xing)f(a)g
(sub-expression)i(within)d(it)0 224 y(with)e(the)g(tilde)g(\()m(~)l(\))
g(c)o(haracter.)25 b(Escap)q(e)17 b(m)o(ust)e(only)g(ap-)0
270 y(p)q(ear)g(inside)e(brac)o(k)o(ets.)0 387 y Fh(-|)19
b(val)f(six)h(=)g(inc)f(<5>;)0 433 y(val)g(six)h(=)39
b(<1)19 b(\045+)f(5>)h(:)h(<int>)0 551 y Fo(In)d(the)h(declaration)f
(for)g Fj(six)p Fo(,)g(the)h(function)f(incremen)o(t)0
596 y(is)d(applied)f(to)h(the)g(piece)h(of)e(co)q(de)h
Fj(<5>)g Fo(constructing)g(the)0 642 y(new)g(piece)h(of)e(co)q(de)i
Fj(<1)21 b(\045+)h(5>)p Fo(.)0 760 y Fh(-|)d(run)f(six;)0
805 y(val)g(it)h(=)h(6)f(:)g(int)0 923 y Fo(Running)c(a)g(piece)i(of)e
(co)q(de,)i(strips)f(a)o(w)o(a)o(y)f(the)h(enclosing)0
969 y(brac)o(k)o(ets,)21 b(and)e(ev)n(aluates)g(the)h(expression)g
(inside.)34 b(T)m(o)0 1014 y(giv)o(e)10 b(a)f(brief)h(feel)h(for)e(ho)o
(w)h(MetaML)g(is)g(used)h(to)f(construct)0 1060 y(larger)k(pieces)h(of)
e(co)q(de)i(at)f(run-time)e(consider:)0 1178 y Fh(-|)19
b(fun)f(mult)g(x)i(n)f(=)137 1223 y(if)g(n=0)g(then)f(<1>)275
1269 y(else)g(<)h(~x)g(*)g(~\(mult)e(x)i(\(n-1\)\))f(>;)0
1315 y(val)g(mult)h(=)g(fn)38 b(:)19 b(<int>)f(->)h(int)38
b(->)19 b(<int>)0 1406 y(-|)g(val)f(cube)g(=)i(<fn)e(y)h(=>)g(~\(mult)e
(<y>)i(3\)>;)0 1452 y(val)f(cube)h(=)g(<fn)f(a)h(=>)g(a)h(*)f(\(a)g(*)g
(\(a)g(*)g(1\)\)>)177 1497 y(:)g(<int)37 b(->)19 b(int>)0
1589 y(-|)g(fun)f(exponent)f(n)i(=)g(<fn)g(y)g(=>)g(~\(mult)e(<y>)i
(n\)>;)0 1634 y(val)f(exponent)f(=)i(fn)39 b(:)19 b(int)38
b(->)19 b(<int)37 b(->)19 b(int>)0 1756 y Fo(The)14 b(function)f
Fj(mult)p Fo(,)g(giv)o(en)g(an)g(in)o(teger)h(piece)h(of)e(co)q(de)h
Fj(x)0 1806 y Fo(and)d(an)h(in)o(teger)g Fj(n)p Fo(,)f(pro)q(duces)j(a)
d(piece)h(of)g(co)q(de)g(that)g(is)f(an)0 1856 y Fj(n)p
Fo(-w)o(a)o(y)j(pro)q(duct)i(of)f Fj(x)p Fo(.)21 b(This)15
b(can)h(b)q(e)f(used)h(to)f(construct)0 1906 y(the)c(co)q(de)g(of)f(a)g
(function)g(that)g(p)q(erforms)g(the)h Fj(cube)f Fo(op)q(era-)0
1956 y(tion,)i(or)i(generalized)g(to)f(a)g(generator)h(for)f(pro)q
(ducing)g(an)0 2005 y(exp)q(onen)o(tiation)19 b(function)g(from)e(a)i
(giv)o(en)g(exp)q(onen)o(t)h Fj(n)p Fo(.)0 2055 y(Note)e(ho)o(w)g(the)g
(lo)q(oping)f(o)o(v)o(erhead)h(has)g(b)q(een)h(remo)o(v)o(ed)0
2105 y(from)f(the)j(generated)g(co)q(de.)38 b(This)20
b(is)g(the)g(purp)q(ose)i(of)0 2155 y(program)c(staging)g(and)h(it)g
(can)g(b)q(e)h(highly)e(e\013ectiv)o(e)j(as)0 2205 y(discussed)16
b(elsewhere)h([4)o(,)d(6,)g(11,)g(23)o(,)h(27)o(].)20
b(In)15 b(this)f(pap)q(er)0 2254 y(w)o(e)20 b(use)g(staging)f(to)g
(construct)j(compilers)c(from)g(in)o(ter-)0 2304 y(preters.)0
2506 y Fl(3)56 b(Monads)20 b(in)e(Langauge)h(Design)0
2650 y Fo(W)m(e)f(mak)o(e)f(signi\014can)o(t)h(use)h(of)f(the)h(notion)
e(of)h(monads.)0 2700 y(A)e(go)q(o)q(d)g(w)o(a)o(y)f(to)h(think)f(of)h
(a)f(monad)f(is)i(as)g(an)g(abstract)1005 42 y(datat)o(yp)q(e)g(that)f
(captures)i(the)f(side)g(e\013ects)i(and)d(actions)1005
91 y(inheren)o(t)23 b(in)f(the)h(language)f(b)q(eing)g(translated)h(in)
f(the)1005 141 y(metho)q(ds)d(of)f(the)i(abstract)g(datat)o(yp)q(e.)33
b(An)20 b(imp)q(ortan)o(t)1005 191 y(feature)12 b(of)e(a)h(monad)e(is)i
(that)g(also)f(describ)q(es,)j(in)e(a)g(purely)1005 241
y(functional)i(w)o(a)o(y)m(,)g(ho)o(w)i(these)h(e\013ects)g(and)e
(actions)h(in)o(ter-)1005 291 y(act.)27 b(Lik)o(e)17
b(an)o(y)f(go)q(o)q(d)h(abstract)g(datat)o(yp)q(e,)h(w)o(e)f(are)g
(free)1005 340 y(to)j(implem)o(en)o(t)d(the)k(actions)e(in)h(an)o(y)f
(w)o(a)o(y)g(w)o(e)h(w)o(an)o(t)f(as)1005 390 y(long)c(as)h(our)h
(implem)o(en)o(tation)c(b)q(eha)o(v)o(es)k(lik)o(e)f(its)g(purely)1005
440 y(functional)d(description.)1005 540 y(The)j(ultimate)d
(e\016ciency)j(of)e(the)i(compiler)d(dep)q(ends)k(on)1005
589 y(making)d(go)q(o)q(d)j(use)g(of)f(the)i(lo)o(w-lev)o(el)d
(primitiv)o(es)g(of)h(the)1005 639 y(target)h(language.)25
b(Monads)16 b(are)h(the)g(glue)f(that)g(w)o(e)h(use)1005
689 y(to)f(tie)h(high-lev)o(el)e(\(purely)i(functional\))e
(descriptions)j(of)1005 739 y(languages)d(to)h(the)h(lo)o(w-lev)o(el)d
(implemen)o(tation)f(features)1005 789 y(of)g(the)i(target)f(en)o
(vironmen)o(t.)1005 888 y(A)9 b(monad)f(is)h(a)g(t)o(yp)q(e)h
(constructor)h Fm(M)e Fo(\(a)g(t)o(yp)q(e)h(constructor)1005
938 y(is)j(a)h(function)f(on)g(t)o(yp)q(es,)h(whic)o(h)f(giv)o(en)g(a)g
(t)o(yp)q(e)h(pro)q(duces)1005 988 y(a)h(new)g(t)o(yp)q(e\),)h(and)e(t)
o(w)o(o)h(p)q(olymorphic)e(functions)i Fi(unit)e Fo(:)1005
1038 y Fi(a)22 b Fg(!)f Fi(M)5 b Fo(\()p Fi(a)p Fo(\))20
b(and)g Fi(bind)i Fo(:)g Fi(M)5 b Fo(\()p Fi(a)p Fo(\))22
b Fg(!)f Fo(\()p Fi(a)h Fg(!)f Fi(M)5 b Fo(\()p Fi(b)p
Fo(\)\))22 b Fg(!)1005 1088 y Fi(M)5 b Fo(\()p Fi(b)p
Fo(\).)17 b(The)12 b(w)o(a)o(y)e(to)h(in)o(terpret)i(an)e(expression)h
(with)f(t)o(yp)q(e)1005 1137 y Fi(M)5 b Fo(\()p Fi(a)p
Fo(\))10 b(is)f(as)h(a)f(computation)f(that)i(represen)o(ts)i(a)e(p)q
(oten)o(tial)1005 1187 y Fm(action)k Fo(and)g(that)g(also)f(returns)j
(a)d(v)n(alue)g(of)h(t)o(yp)q(e)g Fi(a)p Fo(.)1005 1287
y(An)21 b(action)f(migh)o(t)f(p)q(erform)h(I/O,)g(up)q(date)h(a)g(m)o
(utable)1005 1337 y(v)n(ariable,)12 b(or)i(raise)h(an)f(exception.)19
b(One)c(can)f(implem)o(en)o(t)1005 1386 y(a)i(monad)f(in)h(a)h(purely)g
(functional)e(setting)i(b)o(y)g(em)o(ulat-)1005 1436
y(ing)f(the)h(actions.)26 b(This)17 b(is)f(done)h(b)o(y)g(explicitly)e
(thread-)1005 1486 y(ing)e(\\stores",)g(\\I/O)h(streams",)e(or)i
(\\exception)f(con)o(tin)o(u-)1005 1536 y(ations")d(in)h(and)g(out)g
(of)g(all)e(computations.)16 b(W)m(e)11 b(call)f(suc)o(h)1005
1586 y(an)17 b(em)o(ulation)d(the)k Fm(r)n(efer)n(enc)n(e)e
(implementation)p Fo(.)27 b(Using)1005 1636 y(a)15 b(functional)g
(implemen)o(tation)e(allo)o(ws)h(equational)h(rea-)1005
1685 y(soning)10 b(ab)q(out)g(the)h(reference)i(implem)o(en)o(tation,)8
b(ho)o(w)o(ev)o(er)1005 1735 y(it)14 b(is)f(usually)g(quite)h
(ine\016cien)o(t.)1005 1835 y(The)h(t)o(w)o(o)e(p)q(olymorphic)f
(functions)i Fm(unit)h Fo(and)f Fm(bind)g Fo(m)o(ust)1005
1885 y(meet)f(the)i(follo)o(wing)c(three)k(axioms:)1029
2041 y Ff(\(left)e(id)q(\))235 b Fe(bind)13 b Ff(\()p
Fe(unit)g(x)p Ff(\))g(\()p Fe(\025y)q(:e)p Ff(\))d(=)42
b Fe(e)p Ff([)p Fe(x=y)q Ff(])1029 2099 y(\(righ)o(t)14
b(id)q(\))240 b Fe(bind)14 b(e)e Ff(\()p Fe(\025y)q(:unit)i(y)q
Ff(\))c(=)42 b Fe(e)1029 2157 y Ff(\(bind)14 b(asso)q(c)q(\))41
b Fe(bind)14 b Ff(\()p Fe(bind)f(e)g Ff(\()p Fe(\025x:f)t
Ff(\)\))f(\()p Fe(\025y)q(:g)q Ff(\))f(=)1293 2215 y
Fe(bind)i(e)g Ff(\()p Fe(\025z)r(:bind)g Ff(\()p Fe(f)t
Ff([)p Fe(z)r(=x)p Ff(]\)\()p Fe(\025w)q(:g)q Ff([)p
Fe(w)q(=y)q Ff(]\)\))1018 2301 y Fo(where)h Fi(e)p Fo([)p
Fi(x=y)q Fo(])e(is)h(the)h(result)f(of)g(the)g(substitution)g(of)f(the)
1005 2351 y(free)f(o)q(ccurrences)i(of)d(the)g(v)n(ariable)f
Fi(x)h Fo(in)g Fi(e)g Fo(b)o(y)g(the)h(v)n(ariable)1005
2401 y Fi(y)q Fo(.)1005 2501 y(The)19 b(monadic)d(op)q(erators,)k
Fi(unit)f Fo(and)f Fi(bind)p Fo(,)g(are)h(called)1005
2551 y(the)h(standard)f(morphisms)e(of)h(the)i(monad.)31
b(The)20 b Fm(unit)1005 2600 y Fo(op)q(erator)h(tak)o(es)g(a)g(pure)g
(v)n(alue)f(and)g(turns)i(it)e(in)o(to)g(an)1005 2650
y(empt)o(y)13 b(action.)k(The)e Fm(bind)f Fo(op)q(erator)g(sequences)j
(t)o(w)o(o)c(ac-)1005 2700 y(tions.)23 b(A)15 b(useful)h(monad)e(will)g
(also)g(ha)o(v)o(e)i(non-standard)p eop
%%Page: 4 4
4 3 bop 0 42 a Fo(morphisms)8 b(that)i(describ)q(e)i(the)f(primitiv)o
(e)d(actions)i(of)f(the)0 91 y(monad)g(\(lik)o(e)i Fm(r)n(e)n(ad)f
Fo(the)i(v)n(alue)e(from)g(a)g(v)n(ariable)g(and)h Fm(write)0
141 y Fo(a)j(v)n(ariable)e(in)i(the)g(monad)e(of)i(m)o(utable)e
(state\).)0 241 y(F)m(or)h(more)f(bac)o(kground)i(on)f(the)h(use)g(of)f
(monads)f(see)i([29)o(,)0 291 y(31,)f(30)o(].)0 493 y
Fl(4)56 b(Monads)20 b(in)e Fd(Met)m(aML)0 634 y Fo(In)d
Fk(Met)m(aML)g Fo(a)g(monad)e(is)h(a)h(data)f(structure)j(encapsu-)0
680 y(lating)e(a)g(t)o(yp)q(e)i(constructor)g Fm(M)f
Fo(and)g(the)h Fm(unit)f Fo(and)g Fm(bind)0 725 y Fo(functions.)0
845 y Fh(datatype)h(\('M)h(:)h(*)g(->)g(*)h(\))f(Monad)e(=)j(Mon)e(of)
59 890 y(\(*)h(unit)f(function)e(*\))59 936 y(\(['a].)h('a)i(->)g('a)g
('M\))f(*)59 982 y(\(*)h(bind)f(function)e(*\))59 1027
y(\(['a,'b].)g('a)j('M)g(->)g(\('a)f(->)h('b)g('M\))f(->)h('b)g(M\);)0
1151 y Fo(This)11 b(de\014nition)g(uses)h Fk(SML)p Fo('s)g(p)q
(ost\014x)f(notation)g(for)f(t)o(yp)q(e)0 1201 y(application,)25
b(and)f(t)o(w)o(o)g(non-standard)g(extensions)h(to)0
1250 y(ML.)17 b(First,)i(it)f(declares)h(that)f(the)h(argumen)o(t)d
Fj(\('M)22 b(:)f(*)0 1300 y(->)g(*)h(\))g Fo(of)g(the)h(t)o(yp)q(e)g
(constructor)h Fj(Monad)d Fo(is)h(itself)g(a)0 1350 y(unary)f(t)o(yp)q
(e)h(constructor)h([7)o(].)40 b(W)m(e)21 b(sa)o(y)g(that)g
Fj('M)g Fo(has)0 1400 y Fm(kind)p Fo(:)29 b Fj(*)22 b(->)f(*)p
Fo(.)34 b(Second,)21 b(it)e(declares)i(that)e(the)h(argu-)0
1450 y(men)o(ts)14 b(to)g(the)g(constructor)i Fj(Mon)e
Fo(m)o(ust)f(b)q(e)i(p)q(olymorphic)0 1500 y(functions)h([17)o(].)24
b(The)17 b(t)o(yp)q(e)g(v)n(ariables)e(in)h(brac)o(k)o(ets,)h(e.g.)0
1549 y Fj(['a,'b])p Fo(,)12 b(are)i(univ)o(ersally)f(quan)o(ti\014ed.)
18 b(Because)e(of)d(the)0 1599 y(explicit)21 b(t)o(yp)q(e)g
(annotations)f(in)h(the)h Fj(datatype)d Fo(de\014ni-)0
1649 y(tions)c(the)h(e\013ect)h(of)d(these)j(extensions)f(on)f(the)g
(Hindley-)0 1699 y(Milner)23 b(t)o(yp)q(e)h(inference)h(system)f(is)f
(w)o(ell)g(kno)o(wn)g(and)0 1749 y(p)q(oses)15 b(no)f(problems)f(for)h
(the)g Fk(Met)m(aML)h Fo(t)o(yp)q(e)g(inference)0 1798
y(engine.)0 1898 y(In)k Fk(Met)m(aML)p Fo(,)g Fj(Monad)e
Fo(is)i(a)f(\014rst-class,)j(although)c Fm(pr)n(e-)0
1948 y(de\014ne)n(d)23 b Fo(or)e Fm(built-in)g Fo(t)o(yp)q(e.)41
b(In)22 b(particular,)h(there)g(are)0 1998 y(t)o(w)o(o)17
b(syn)o(tactic)h(forms)e(whic)o(h)h(are)h(a)o(w)o(are)f(of)g(the)h
Fj(Monad)0 2048 y Fo(datat)o(yp)q(e:)39 b Fj(Do)23 b
Fo(and)h Fj(Return)p Fo(.)48 b Fj(Do)24 b Fo(and)g Fj(Return)f
Fo(are)0 2097 y Fk(Met)m(aML)p Fo('s)14 b(syn)o(tactic)h(in)o(terface)f
(to)f(the)h Fm(unit)g Fo(and)g Fm(bind)0 2147 y Fo(of)i(a)g(monad.)25
b(W)m(e)16 b(ha)o(v)o(e)h(mo)q(deled)e(them)h(after)h(the)g(do-)0
2197 y(notation)d(of)h(Hask)o(ell[9)n(,)g(20].)21 b(An)15
b(imp)q(ortan)o(t)e(di\013erence)0 2247 y(is)g(that)h
Fk(Met)m(aML)p Fo('s)g Fj(Do)f Fo(and)g Fj(Return)f Fo(are)i(b)q(oth)g
(param-)0 2297 y(eterized)g(b)o(y)f(an)f(expression)i(of)e(t)o(yp)q(e)h
Fj('M)21 b(Monad)p Fo(.)c Fj(Do)12 b Fo(and)0 2346 y
Fj(Return)h Fo(are)h(syn)o(tactic)g(sugar)g(for)g(the)g(follo)o(wing:)0
2472 y Fh(\(*)19 b(Syntactic)d(Sugar)273 b(Derived)17
b(Form)h(*\))0 2563 y(Do)h(\(Mon\(unit)o(,bi)o(nd)o(\)\))d({)k(x)f(<-)g
(e;)f(f)i(})58 b(=)569 2609 y(bind)18 b(e)h(\(fn)g(x)g(=>)g(f\))0
2700 y(Return)e(\(Mon\(unit,)o(bin)o(d\)\))f(e)215 b(=)78
b(unit)18 b(e)1005 42 y Fo(In)g(addition)f(the)h(syn)o(tactic)h(sugar)f
(of)f(the)h Fj(Do)g Fo(allo)o(ws)e(a)1005 87 y(sequence)21
b(of)e Fj(x)1257 93 y Fc(i)1292 87 y Fj(<-)i(e)1379 93
y Fc(i)1412 87 y Fo(forms,)e(and)f(de\014nes)j(this)e(as)g(a)1005
133 y(nested)c(sequence)h(of)e Fj(Do)p Fo('s.)j(F)m(or)d(example:)1005
258 y Fh(Do)19 b(m)g({)g(x1)g(<-)g(e1;)f(x2)h(<-)g(e2)g(;)g(x3)g(<-)g
(e3)g(;)g(e4)g(})58 b(=)1064 304 y(Do)19 b(m)g({)g(x1)g(<-)g(e1;)1201
350 y(Do)g(m)g({)g(x2)g(<-)g(e2)g(;)1338 395 y(Do)g(m)h({)f(x3)g(<-)f
(e3)h(;)g(e4)g(}}})1005 521 y Fo(Users)31 b(ma)o(y)d(freely)j
(construct)g(their)f(o)o(wn)g(monads,)1005 567 y(though)19
b(they)h(should)f(b)q(e)h(v)o(ery)g(careful)f(that)h(their)g(in-)1005
612 y(stan)o(tiation)d(meets)h(the)g(monad)e(axioms.)28
b(The)19 b(monad)1005 658 y(axioms,)9 b(expressed)14
b(in)c Fk(Met)m(aML)p Fo('s)i Fj(Do)f Fo(and)g Fj(Return)e
Fo(no-)1005 704 y(tation)k(are:)1005 829 y Fh(Do)19 b({)g(x)g(<-)g
(Return)e(e)j(;)f(z)g(})196 b(=)19 b(z[e/x])1005 875
y(Do)g({)g(x)g(<-)g(m)g(;)h(Return)d(x)i(})196 b(=)19
b(m)1005 921 y(Do)g({)g(x)g(<-)g(Do)g({)g(y)g(<-)g(a)h(;)f(b)g(})g(;)g
(c)h(})f(=)1064 966 y(Do)g({)g(y')g(<-)g(a)g(;)g(Do)g({)g(x)g(<-)g
(b[y'/y])e(;)i(c)h(})f(})g(=)1064 1012 y(Do)g({)g(y')g(<-)g(a)g(;)g(x)g
(<-)g(b[y'/y])e(;)i(c)g(})1005 1218 y Fl(5)56 b(Illustrating)24
b(our)i(compiler)c(dev)n(elop-)1089 1276 y(men)n(t)17
b(metho)r(d)1005 1424 y Fo(In)11 b(this)h(section,)g(w)o(e)f
(illustrate)g(our)h(metho)q(d)e(b)o(y)h(building)1005
1474 y(the)18 b(fron)o(t)e(end)i(of)f(a)f(compiler)g(for)h(a)g(small)d
(imp)q(erativ)o(e)1005 1524 y Fm(while-language)p Fo(.)30
b(W)m(e)17 b(pro)q(ceed)j(in)d(three)i(steps.)31 b(First,)1005
1574 y(w)o(e)16 b(in)o(tro)q(duce)g(the)h(language)d(and)i(its)g
(denotational)e(se-)1005 1623 y(man)o(tics)k(b)o(y)g(giving)g(a)g
(monadic)f(in)o(terpreter)k(as)e(a)g(one)1005 1673 y(stage)14
b Fk(Met)m(aML)g Fo(program.)i(Second,)e(w)o(e)g(stage)g(this)g(in-)
1005 1723 y(terpreter)20 b(b)o(y)d(using)g(a)g(t)o(w)o(o)g(stage)g
Fk(Met)m(aML)i Fo(program)1005 1773 y(in)12 b(order)i(to)f(pro)q(duce)h
(a)e(compiler.)17 b(Third,)12 b(w)o(e)h(illustrate)1005
1823 y(the)j(usefulness)h(of)e(the)h(staging)e(approac)o(h,)h(b)o(y)h
(sho)o(wing)1005 1872 y(ho)o(w)f(using)g(MetaML's)g(in)o(tensional)f
(analysis)h(to)q(ols)g(can)1005 1922 y(b)q(e)g(used)g(to)f(optimize)e
(or)i(further)h(translate)g(the)g(output)1005 1972 y(of)e(a)h(staged)g
(program.)1005 2120 y Fn(5.1)52 b(The)18 b(while-language)1005
2268 y Fo(In)10 b(this)h(section,)g(w)o(e)f(in)o(tro)q(duce)h(a)f
(simple)f Fm(while-language)1005 2318 y Fo(comp)q(osed)14
b(from)g(the)h(syn)o(tactic)h(elemen)o(ts:)j(expressions)1005
2368 y(\()p Fj(Exp)p Fo(\))11 b(and)g(commands)e(\()p
Fj(Com)p Fo(\).)17 b(In)11 b(this)g(simple)f(language)1005
2417 y(expressions)k(are)f(comp)q(osed)f(of)g(in)o(teger)h(constan)o
(ts,)g(v)n(ari-)1005 2467 y(ables,)d(and)f(op)q(erators.)18
b(A)9 b(simple)f(algebraic)h(datat)o(yp)q(e)h(to)1005
2517 y(describ)q(e)16 b(the)f(abstract)g(syn)o(tax)g(of)e(expressions)j
(is)e(giv)o(en)1005 2567 y(in)f Fk(Met)m(aML)i Fo(b)q(elo)o(w:)1005
2700 y Fh(datatype)i(Exp)h(=)p eop
%%Page: 5 5
5 4 bop 39 42 a Fh(Constant)17 b(of)i(int)293 b(\(*)58
b(5)97 b(*\))0 87 y(|)19 b(Variable)e(of)i(string)233
b(\(*)58 b(x)97 b(*\))0 133 y(|)19 b(Minus)f(of)h(\(Exp)f(*)h(Exp\))195
b(\(*)38 b(x)19 b(-)h(5)38 b(*\))0 178 y(|)19 b(Greater)e(of)i(\(Exp)f
(*)h(Exp\))156 b(\(*)38 b(x)19 b(>)h(1)38 b(*\))0 224
y(|)19 b(Times)f(of)h(\(Exp)f(*)h(Exp\))f(;)157 b(\(*)38
b(x)19 b(*)h(4)38 b(*\))0 401 y Fo(Commands)11 b(include)j(assignmen)o
(t,)f(sequencing)i(of)e(com-)0 450 y(mands,)i(a)h(conditional)f(\()p
Fm(if)g Fo(command\),)f(while)h(lo)q(ops,)h(a)0 500 y(prin)o(t)c
(command,)e(and)i(a)g(declaration)g(whic)o(h)g(in)o(tro)q(duces)0
550 y(new)f(statically)f(scop)q(ed)h(v)n(ariables.)17
b(A)10 b(declaration)h(in)o(tro-)0 600 y(duces)h(a)f(v)n(ariable,)f
(pro)o(vides)h(an)g(expression)h(that)g(de\014nes)0 650
y(its)g(initial)d(v)n(alue,)j(and)f(limits)e(its)j(scop)q(e)h(to)f(the)
g(enclosing)0 699 y(command.)17 b(A)d(simple)f(algebraic)h(datat)o(yp)q
(e)g(to)g(describ)q(e)0 749 y(the)g(abstract)h(syn)o(tax)f(of)f
(commands)f(is:)0 921 y Fh(datatype)17 b(Com)h(=)39 967
y(Assign)37 b(of)19 b(\(string)e(*)i(Exp\))0 1013 y(|)g(Seq)97
b(of)19 b(\(Com)f(*)h(Com\))0 1058 y(|)g(Cond)77 b(of)19
b(\(Exp)f(*)h(Com)g(*)g(Com\))0 1104 y(|)g(While)57 b(of)19
b(\(Exp)f(*)h(Com\))0 1150 y(|)g(Declare)e(of)i(\(string)e(*)i(Exp)g(*)
g(Com\))0 1195 y(|)g(Print)57 b(of)19 b(Exp;)0 1287 y(\(*)g(******)e
(Example)g(Concrete)g(Syntax)g(*******)g(*\))0 1332 y(\(*)i(Assign)76
b(x)19 b(:=)g(1)451 b(*\))0 1378 y(\(*)19 b(Seq)136 b({)19
b(x)g(:=1;)g(y:=)f(2)h(})255 b(*\))0 1424 y(\(*)19 b(Cond)116
b(if)19 b(x)g(then)f(x)h(:=)g(1)g(else)f(y)i(:=)f(1)g(*\))0
1469 y(\(*)g(While)96 b(while)18 b(x>0)g(do)h(x)g(:=)g(x)g(-)g(1)118
b(*\))0 1515 y(\(*)19 b(Declare)56 b(declare)17 b(x)i(=)g(1)h(in)e(x)i
(:=)e(x)i(-)f(1)39 b(*\))0 1561 y(\(*)19 b(Print)96 b(print)18
b(x)431 b(*\))0 1733 y Fo(A)13 b(simple)e(while-program)g(in)i
(concrete)i(syn)o(tax,)d(suc)o(h)i(as)0 1885 y Fh(declare)j(x)i(=)g
(150)g(in)59 1931 y(declare)e(y)i(=)g(200)g(in)118 1976
y({)g(while)f(x)h(>)g(0)g(do)g({)g(x)h(:=)e(x)i(-)f(1;)g(y)g(:=)g(y)g
(-)g(1)g(};)157 2022 y(print)f(y)h(})0 2174 y Fo(is)14
b(enco)q(ded)h(abstractly)f(in)g(these)h(datat)o(yp)q(es)f(as)g(follo)o
(ws:)0 2326 y Fh(val)k(S1)h(=)0 2372 y(Declare\("x)o(",)o(Con)o(st)o
(ant)d(150,)39 2418 y(Declare\("y)o(",C)o(on)o(sta)o(nt)g(200,)78
2463 y(Seq\(While\(G)o(re)o(ate)o(r\(V)o(ar)o(iab)o(le)g("x",Consta)o
(nt)g(0\),)275 2509 y(Seq\(Assig)o(n\()o("x")o(,M)o(inu)o(s\()o(Var)o
(iab)o(le)g("x",)686 2555 y(Constant)h(1\)\),)353 2600
y(Assign\("y")o(,M)o(inu)o(s\()o(Var)o(iab)o(le)f("y",)686
2646 y(Constant)h(1\)\)\)\),)157 2692 y(Print\(Var)o(iab)o(le)f
("y"\)\)\)\);)1005 42 y Fn(5.2)52 b(The)18 b(structure)f(of)g(the)h
(solution)1005 184 y Fo(Staging)11 b(is)g(an)g(imp)q(ortan)o(t)f(tec)o
(hnique)j(for)e(dev)o(eloping)g(ef-)1005 234 y(\014cien)o(t)16
b(programs,)f(but)i(it)e(requires)i(some)e(forethough)o(t.)1005
284 y(T)m(o)c(get)g(the)h(b)q(est)h(results)g(one)e(should)h(design)f
(algorithms)1005 334 y(with)j(their)g(staged)g(solutions)g(in)f(mind.)
1005 433 y(The)18 b(meaning)e(of)h(a)g(while-program)f(dep)q(ends)j
(only)e(on)1005 483 y(the)c(meaning)e(of)h(its)g(comp)q(onen)o(t)g
(expressions)i(and)e(com-)1005 533 y(mands.)23 b(In)16
b(the)g(case)h(of)f(expressions,)h(this)f(meaning)e(is)1005
583 y(a)i(function)f(from)f(en)o(vironmen)o(ts)i(to)f(in)o(tegers.)25
b(The)17 b(en-)1005 633 y(vironmen)o(t)c(is)i(a)g(mapping)d(b)q(et)o(w)
o(een)17 b(names)d(\(whic)o(h)h(are)1005 682 y(in)o(tro)q(duced)g(b)o
(y)e Fj(Declare)p Fo(\))g(and)h(their)g(v)n(alues.)1005
782 y(There)h(are)g(sev)o(eral)f(w)o(a)o(ys)g(that)g(this)g(mapping)d
(migh)o(t)h(b)q(e)1005 832 y(implemen)o(ted.)30 b(Since)20
b(w)o(e)f(in)o(tend)g(to)f(stage)h(the)h(in)o(ter-)1005
882 y(preter,)13 b(w)o(e)e(break)g(this)g(mapping)e(in)o(to)h(t)o(w)o
(o)h(comp)q(onen)o(ts.)1005 932 y(The)17 b(\014rst)g(comp)q(onen)o(t,)f
(a)g(list)f(of)h(names,)g(will)e(b)q(e)j(com-)1005 981
y(pletely)i(kno)o(wn)g(at)g(compile-time.)31 b(The)20
b(second)g(com-)1005 1031 y(p)q(onen)o(t,)d(a)g(list)f(of)g(in)o(teger)
h(v)n(alues)g(that)g(b)q(eha)o(v)o(es)g(lik)o(e)f(a)1005
1081 y(stac)o(k,)22 b(will)c(only)h(b)q(e)i(kno)o(wn)f(at)f(the)i
(run-time)e(of)g(the)1005 1131 y(compiled)12 b(program.)1005
1230 y(The)26 b(functions)f(that)g(access)j(this)d(en)o(vironmen)o(t)f
(dis-)1005 1280 y(tribute)d(their)f(computation)f(in)o(to)g(t)o(w)o(o)h
(stages.)37 b(First,)1005 1330 y(determining)10 b(at)i(what)f(lo)q
(cation)g(a)g(name)g(app)q(ears)h(in)f(the)1005 1380
y(name)k(list,)g(and)h(second,)h(b)o(y)f(accessing)h(the)g(correct)h
(in-)1005 1430 y(teger)j(from)d(the)j(stac)o(k)f(at)g(this)h(lo)q
(cation.)35 b(In)20 b(a)g(more)1005 1479 y(complicated)d(compiler)g
(the)i(mapping)d(from)h(names)g(to)1005 1529 y(lo)q(cations)d(w)o(ould)
g(dep)q(end)h(on)g(more)e(than)h(just)h(the)g(dec-)1005
1579 y(laration)9 b(nesting)h(depth,)h(but)f(the)g(principle)g(remains)
e(the)1005 1629 y(same.)27 b(Since)18 b(ev)o(ery)g(v)n(ariable's)e(lo)q
(cation)g(can)i(b)q(e)f(com-)1005 1679 y(pletely)i(computed)f(at)g
(compile-tim)o(e,)f(it)h(is)h(imp)q(ortan)o(t)1005 1729
y(that)f(w)o(e)f(do)g(so,)h(and)g(that)f(these)i(lo)q(cations)e(app)q
(ear)h(as)1005 1778 y(constan)o(ts)d(in)e(the)i(next)f(stage.)1005
1878 y(Splitting)27 b(the)i(en)o(vironmen)o(t)e(in)o(to)h(t)o(w)o(o)f
(comp)q(onen)o(ts)1005 1928 y(is)f(a)f(standard)i(tec)o(hnique)g
(\(often)f(called)f(a)h(binding)1005 1978 y(time)17 b(impro)o(v)o(emen)
o(t\))f(used)j(b)o(y)f(the)h(partial)e(ev)n(aluation)1005
2027 y(comm)o(unit)o(y[)o(8)m(].)g(W)m(e)c(capture)h(this)f(precisely)h
(b)o(y)f(the)g(fol-)1005 2077 y(lo)o(wing)f(purely)i(functional)f
(implemen)o(tation.)1005 2198 y Fh(type)18 b(location)f(=)i(int;)1005
2243 y(type)f(index)g(=)h(string)e(list;)1005 2289 y(type)h(stack)g(=)h
(int)f(list;)1005 2380 y(\(*)h(position)d(:)k(string)d(->)i(index)e(->)
i(location)e(*\))1005 2426 y(fun)h(position)f(name)h(index)g(=)1083
2472 y(let)h(fun)f(pos)h(n)g(\(nm::nms\))d(=)1240 2517
y(if)j(name)f(=)i(nm)1299 2563 y(then)e(n)1299 2609 y(else)g(pos)h
(\(n+1\))e(nms)1083 2654 y(in)i(pos)g(1)g(index)f(end;)p
eop
%%Page: 6 6
6 5 bop 0 42 a Fh(\(*)19 b(fetch)f(:)h(location)d(->)j(stack)f(->)h
(int)f(*\))0 87 y(fun)g(fetch)g(n)h(\(v::vs\))e(=)196
133 y(if)i(n)g(=)g(1)255 178 y(then)f(v)255 224 y(else)g(fetch)g
(\(n-1\))f(vs;)0 315 y(\(*)i(put:)f(location)e(->)j(int)g(->)g(stack)e
(->)i(stack)f(*\))0 361 y(fun)g(put)h(n)g(x)g(\(v::vs\))e(=)157
407 y(if)i(n)g(=)g(1)216 452 y(then)f(x::vs)216 498 y(else)g(v::\(put)f
(\(n-1\))g(x)j(vs\);)0 626 y Fo(The)c(meaning)f(of)g
Fj(Com)h Fo(is)f(a)h(stac)o(k)h(transformer)e(and)h(an)0
676 y(output)f(accum)o(ulator.)21 b(It)15 b(transforms)f(one)i(stac)o
(k)f(\(with)0 726 y(v)n(alues)10 b(of)g(v)n(ariables)f(in)h(scop)q(e\))
h(in)o(to)f(another)g(stac)o(k)h(\(with)0 776 y(presumably)j
(di\013eren)o(t)i(v)n(alues)e(for)h(the)h(same)e(v)n(ariables\))0
825 y(while)h(accum)o(ulating)f(the)i(output)g(prin)o(ted)g(b)o(y)f
(the)h(pro-)0 875 y(gram.)0 975 y(T)m(o)h(pro)q(duce)h(a)g(monadic)d
(in)o(terpreter)20 b(w)o(e)e(could)f(de\014ne)0 1025
y(a)h(monad)e(whic)o(h)i(encapsulates)h(the)g(index,)f(the)h(stac)o(k,)
0 1075 y(and)f(the)h(output)g(accum)o(ulation.)30 b(Because)20
b(w)o(e)f(in)o(tend)0 1124 y(to)d(stage)h(the)g(in)o(terpreter)i(w)o(e)
d(do)g(not)h(encapsulate)g(the)0 1174 y(index)i(in)g(the)h(monad.)32
b(W)m(e)19 b(w)o(an)o(t)g(the)h(monad)e(to)h(en-)0 1224
y(capsulate)12 b(only)f(the)h(dynamic)e(part)i(of)f(the)h(en)o
(vironmen)o(t)0 1274 y(\(the)i(stac)o(k)g(of)e(v)n(alues)h(where)i(eac)
o(h)f(v)n(alue)e(is)i(accessed)h(b)o(y)0 1324 y(its)f(p)q(osition)g(in)
g(the)h(stac)o(k,)g(and)f(the)h(output)g(accum)o(ula-)0
1373 y(tion\).)0 1473 y(The)k(monad)f(w)o(e)h(use)h(is)f(a)g(com)o
(bination)d(of)j Fm(monad)h(of)0 1523 y(state)d Fo(and)d(the)g
Fm(monad)i(of)f(output)p Fo(.)0 1647 y Fh(datatype)i('a)h(M)i(=)78
1692 y(StOut)e(of)h(\(stack)e(->)i(\('a)g(*)g(stack)e(*)j(string\)\);)0
1738 y(fun)e(unStOut)f(\(StOut)h(f\))h(=)g(f;)0 1784
y(fun)f(unit)h(x)g(=)g(StOut\(fn)e(n)i(=>)g(\(x,n,""\))o(\);)0
1829 y(fun)f(bind)h(e)g(f)g(=)78 1875 y(StOut\(fn)e(n)i(=>)255
1921 y(let)f(val)h(\(a,n1,s1\))d(=)j(\(unStOut)e(e\))i(n)333
1966 y(val)g(\(b,n2,s2\))d(=)39 b(unStOut\(f)16 b(a\))j(n1)255
2012 y(in)g(\(b,n2,s1)d(^)k(s2\))e(end\);)0 2103 y(\(*)h(mswo)f(is)h
(the)f(Monad)g(of)h(state)e(with)h(output)g(*\))0 2149
y(val)g(mswo)h(:)g(M)g(Monad)f(=)h(Mon\(unit,)o(bin)o(d\))o(;)0
2277 y Fo(The)10 b(non-standard)f(morphisms)e(m)o(ust)h(describ)q(e)j
(ho)o(w)e(the)0 2327 y(stac)o(k)19 b(is)f(extended)j(\(or)d(shrunk\))i
(when)f(new)g(v)n(ariables)0 2377 y(come)12 b(in)o(to)g(\(or)h(out)f
(of)s(\))h(scop)q(e;)h(ho)o(w)e(the)h(v)n(alue)g(of)f(a)g(par-)0
2427 y(ticular)20 b(v)n(ariable)g(is)h(read)g(or)g(up)q(dated;)j(and)d
(ho)o(w)f(the)0 2476 y(prin)o(ted)d(text)g(is)f(accum)o(ulated.)25
b(Eac)o(h)17 b(can)f(b)q(e)h(though)o(t)0 2526 y(of)12
b(as)g(an)h(action)f(on)g(the)h(stac)o(k)g(of)f(m)o(utable)e(v)n
(ariables,)i(or)0 2576 y(an)i(action)f(on)h(the)g(prin)o(t)g(stream.)0
2700 y Fh(\(*)19 b(read)f(:)h(location)e(->)i(int)f(M)h(*\))1005
42 y(fun)f(read)h(i)g(=)g(StOut\(fn)e(ns)h(=>)h(\(fetch)e(i)j
(ns,ns,""\))o(\);)1005 133 y(\(*)f(write)f(:)h(location)d(->)j(int)g
(->)f(unit)38 b(M)19 b(*\))1005 178 y(fun)f(write)g(i)h(v)h(=)1201
224 y(StOut\(fn)d(ns)i(=>\()f(\(\),)g(put)h(i)g(v)g(ns,)g("")g(\)\);)
1005 315 y(\(*)g(push:)f(int)g(->)h(unit)38 b(M)19 b(*\))1005
361 y(fun)f(push)h(x)g(=)g(StOut\(fn)e(ns)h(=>)h(\()g(\(\),)g(x)g(::)g
(ns,)f(""\)\);)1005 452 y(\(*)h(pop)f(:)i(unit)e(M)h(*\))1005
498 y(val)f(pop)h(=)g(StOut\(fn)e(\(n::ns\))g(=>)h(\(\(\),)g(ns,)h
(""\)\);)1005 589 y(\(*)g(output:)e(int)h(->)h(unit)f(M)h(*\))1005
635 y(fun)f(output)g(n)h(=)1083 681 y(StOut\(fn)e(ns)i(=>)g(\()g(\(\),)
f(ns,)h(\(toString)d(n\)^")i("\)\);)1005 832 y Fn(5.3)52
b(Step)18 b(1:)23 b(monadic)18 b(in)o(terpreter)1005
983 y Fo(Because)30 b(expressions)f(do)e(not)h(alter)g(the)g(stac)o(k,)
j(or)1005 1033 y(pro)q(duce)21 b(an)o(y)f(output,)h(w)o(e)g(could)f
(giv)o(e)f(an)h(ev)n(aluation)1005 1083 y(function)f(for)g(expressions)
i(whic)o(h)e(is)g(not)g(monadic,)f(or)1005 1132 y(whic)o(h)i(uses)h(a)e
(simpler)g(monad)f(than)h(the)i(monad)d(de-)1005 1182
y(\014ned)f(ab)q(o)o(v)o(e.)25 b(W)m(e)16 b(c)o(ho)q(ose)h(to)f(use)h
(the)g(monad)d(of)i(state)1005 1232 y(with)11 b(output)g(throughout)h
(our)f(implemen)o(tatio)o(n)e(for)h(t)o(w)o(o)1005 1282
y(reasons.)38 b(One,)22 b(for)e(simplicit)o(y)d(of)j(presen)o(tation,)i
(and)1005 1332 y(t)o(w)o(o)14 b(b)q(ecause)h(if)e(the)i(while)f
(language)f(seman)o(tics)g(should)1005 1382 y(ev)o(olv)o(e,)h(using)g
(the)i(same)d(monad)g(ev)o(erywhere)k(mak)o(es)c(it)1005
1431 y(easy)h(to)g(reuse)i(the)f(monadic)d(ev)n(aluation)h(function)g
(with)1005 1481 y(few)h(c)o(hanges.)1005 1581 y(The)23
b(only)f(non-standard)i(morphism)c(eviden)o(t)j(in)f(the)1005
1631 y Fj(eval1)e Fo(function)g(is)h Fj(read)p Fo(,)g(whic)o(h)g
(describ)q(es)i(ho)o(w)d(the)1005 1680 y(v)n(alue)14
b(of)g(a)g(v)n(ariable)g(is)g(obtained.)20 b(The)15 b(monadic)e(in)o
(ter-)1005 1730 y(preter)e(for)e(expressions)i(tak)o(es)e(an)g(index)h
(mapping)d(names)1005 1780 y(to)18 b(lo)q(cations)f(and)g(returns)i(a)f
(computation)e(pro)q(ducing)1005 1830 y(an)e(in)o(teger.)1005
1969 y Fh(\(*)38 b(eval1:)18 b(Exp)g(->)h(index)f(->)h(int)f(M)h(*\))
1005 2015 y(fun)f(eval1)g(exp)h(index)e(=)1005 2061 y(case)h(exp)h(of)
1044 2106 y(Constant)e(n)i(=>)g(Return)e(mswo)h(n)1005
2152 y(|)h(Variable)e(x)i(=>)g(let)f(val)h(loc)f(=)h(position)e(x)i
(index)1319 2198 y(in)g(read)f(loc)g(end)1005 2243 y(|)h(Minus\(x,y\))d
(=>)1064 2289 y(Do)j(mswo)f({)h(a)g(<-)g(eval1)f(x)h(index)f(;)1260
2335 y(b)h(<-)g(eval1)f(y)h(index;)1260 2380 y(Return)e(mswo)h(\(a)h(-)
g(b\))g(})1005 2426 y(|)g(Greater\(x,)o(y\))d(=>)1064
2472 y(Do)j(mswo)f({)h(a)g(<-)g(eval1)f(x)h(index)f(;)1260
2517 y(b)h(<-)g(eval1)f(y)h(index;)1260 2563 y(Return)e(mswo)h(\(if)h
(a)g('>')f(b)1574 2609 y(then)g(1)h(else)f(0\))h(})1005
2654 y(|)g(Times\(x,y\))d(=>)1064 2700 y(Do)j(mswo)f({)h(a)g(<-)g
(eval1)f(x)h(index)f(;)p eop
%%Page: 7 7
7 6 bop 255 42 a Fh(b)19 b(<-)g(eval1)f(y)h(index;)255
87 y(Return)e(mswo)h(\(a)h(*)g(b\))g(};)0 223 y Fo(The)14
b(in)o(terpreter)h(for)e Fj(Com)g Fo(uses)h(the)g(non-standard)g(mor-)0
273 y(phisms)c Fj(write)p Fo(,)g Fj(push)p Fo(,)g(and)h
Fj(pop)g Fo(to)g(transform)f(the)i(stac)o(k)0 323 y(and)22
b(the)g(morphism)d Fj(output)h Fo(to)i(add)g(to)f(the)i(output)0
373 y(stream.)0 505 y Fh(\(*)c(interpret)o(1)e(:)i(Com)f(->)h(index)f
(->)h(unit)f(M)h(*\))0 551 y(fun)f(interpret1)e(stmt)i(index)g(=)0
596 y(case)g(stmt)g(of)39 642 y(Assign\(nam)o(e,e)o(\))e(=>)59
688 y(let)i(val)h(loc)f(=)h(position)e(name)h(index)59
733 y(in)h(Do)g(mswo)f({)h(v)g(<-)g(eval1)f(e)h(index)e(;)314
779 y(write)h(loc)g(v)h(})g(end)0 824 y(|)g(Seq\(s1,s2\))d(=>)59
870 y(Do)j(mswo)f({)h(x)g(<-)g(interpret1)d(s1)j(index;)255
916 y(y)g(<-)g(interpret1)d(s2)j(index;)255 961 y(Return)e(mswo)h(\(\))
h(})0 1007 y(|)g(Cond\(e,s1,)o(s2\))d(=>)59 1053 y(Do)j(mswo)f({)h(x)g
(<-)g(eval1)f(e)h(index;)255 1098 y(if)g(x=1)314 1144
y(then)f(interpret)o(1)f(s1)h(index)314 1190 y(else)g(interpret)o(1)f
(s2)h(index)g(})0 1235 y(|)h(While\(e,b\))d(=>)59 1281
y(let)i(fun)h(loop)f(\(\))h(=)98 1327 y(Do)g(mswo)157
1372 y({)g(v)g(<-)g(eval1)f(e)h(index)f(;)196 1418 y(if)h(v=0)255
1464 y(then)f(Return)f(mswo)h(\(\))255 1509 y(else)g(Do)h(mswo)f({)h
(interpret1)d(b)j(index)f(;)549 1555 y(loop)g(\(\))h(})g(})59
1601 y(in)g(loop)f(\(\))h(end)0 1646 y(|)g(Declare\(nm)o(,e,)o(st)o
(mt\))d(=>)59 1692 y(Do)j(mswo)f({)h(v)g(<-)g(eval1)f(e)h(index)f(;)255
1738 y(push)g(v)h(;)255 1783 y(interpret1)d(stmt)i(\(nm::inde)o(x\);)
255 1829 y(pop)g(})0 1875 y(|)h(Print)f(e)h(=>)59 1920
y(Do)g(mswo)f({)h(v)g(<-)g(eval1)f(e)h(index;)255 1966
y(output)e(v)j(};)0 2102 y Fo(Although)j Fj(interpret1)e
Fo(is)h(fairly)g(standard,)k(w)o(e)d(feel)0 2152 y(that)16
b(t)o(w)o(o)g(things)g(are)h(w)o(orth)f(p)q(oin)o(ting)f(out.)26
b(First,)16 b(the)0 2202 y(clause)11 b(for)f(the)h Fj(Declare)e
Fo(constructor,)j(whic)o(h)f(calls)f Fj(push)0 2252 y
Fo(and)h Fj(pop)p Fo(,)g(implicitly)d(c)o(hanges)k(the)g(size)g(of)e
(the)i(stac)o(k)g(and)0 2301 y(explicitly)h(c)o(hanges)h(the)g(size)g
(of)f(the)h(index)g(\()p Fj(nm:index)p Fo(\),)0 2351
y(k)o(eeping)19 b(the)g(t)o(w)o(o)f(in)h(sync)o(h.)33
b(It)19 b(ev)n(aluates)g(the)g(initial)0 2401 y(v)n(alue)12
b(for)f(a)h(new)h(v)n(ariable,)e(extends)j(the)e(index)g(with)g(the)0
2451 y(v)n(ariables)18 b(name,)g(and)g(the)h(stac)o(k)g(with)f(its)h(v)
n(alue,)f(and)0 2501 y(then)13 b(executes)i(the)f(b)q(o)q(dy)e(of)h
(the)g Fj(Declare)p Fo(.)j(Afterw)o(ards)0 2551 y(it)f(remo)o(v)o(es)h
(the)g(binding)f(from)f(the)i(stac)o(k)g(\(using)g Fj(pop)p
Fo(\),)0 2600 y(all)g(the)i(while)f(implicitly)d(threading)k(the)g
(accum)o(ulated)0 2650 y(output.)h(The)14 b(mapping)e(is)i(in)g(scop)q
(e)h(only)e(for)h(the)h(b)q(o)q(dy)0 2700 y(of)e(the)i(declaration.)
1005 42 y(Second,)g(the)h(clause)f(for)f(the)i Fj(While)d
Fo(constructor)k(in)o(tro-)1005 91 y(duces)11 b(a)f(lo)q(cal)f(tail)g
(recursiv)o(e)j(function)d Fj(loop)p Fo(.)16 b(This)10
b(func-)1005 141 y(tion)k(em)o(ulates)f(the)i(b)q(o)q(dy)f(of)f(the)i
(while.)j(It)c(is)g(tempting)1005 191 y(to)e(con)o(trol)g(the)h
(recursion)g(in)o(tro)q(duced)g(b)o(y)f(the)h Fj(While)e
Fo(b)o(y)1005 241 y(using)f(the)g(recursion)h(of)e(the)i
Fj(interpret1)d Fo(function)h(itself)1005 291 y(b)o(y)14
b(using)f(a)h(clause)g(something)f(lik)o(e:)1005 424
y Fh(|)19 b(While\(e,b\))d(=>)1064 469 y(Do)j(mswo)1064
515 y({)g(v)g(<-)g(eval1)f(e)h(index)f(;)1103 561 y(if)h(v=0)1162
606 y(then)f(Return)f(mswo)h(\(\))1162 652 y(else)g(Do)h(mswo)1260
698 y({)g(interpret1)d(b)j(index)f(;)1299 743 y(interpret1)e
(\(While\(e,)o(b\)\))g(index)i(})1064 789 y(})1005 926
y Fo(Here,)13 b(if)e(the)i(test)g(of)f(the)g(lo)q(op)g(is)g(true,)g(w)o
(e)h(run)f(the)h(b)q(o)q(dy)1005 976 y(once)18 b(\(to)g(transform)f
(the)h(stac)o(k)h(and)e(accum)o(ulate)g(out-)1005 1026
y(put\))i(and)f(then)h(rep)q(eat)h(the)f(whole)g(lo)q(op)e(again.)31
b(This)1005 1076 y(strategy)m(,)17 b(while)f(correct,)i(will)d(ha)o(v)o
(e)h(disastrous)h(results)1005 1125 y(when)g(w)o(e)g(stage)g(the)g(in)o
(terpreter,)i(as)d(it)h(will)e(cause)i(the)1005 1175
y(\014rst)e(stage)f(to)g(lo)q(op)f(in\014nitely)m(.)1005
1275 y(There)18 b(are)g(t)o(w)o(o)f(recursions)i(going)d(on)h(here.)30
b(First)17 b(the)1005 1325 y(unfolding)11 b(of)h(the)h(\014nite)g(data)
f(structure)j(whic)o(h)d(enco)q(des)1005 1375 y(the)h(program)e(b)q
(eing)h(compiled,)e(and)j(second,)g(the)g(recur-)1005
1424 y(sion)e(in)h(the)g(program)e(b)q(eing)i(compiled.)j(In)d(an)f
(unstaged)1005 1474 y(in)o(terpreter)17 b(a)d(single)h(lo)q(op)f
(su\016ces.)23 b(In)15 b(a)f(staged)i(in)o(ter-)1005
1524 y(preter,)i(b)q(oth)e(lo)q(ops)g(are)g(necessary)m(.)27
b(In)16 b(the)h(\014rst)g(stage)1005 1574 y(w)o(e)11
b(only)f(unfold)h(the)g(program)f(b)q(eing)h(compiled)e(and)i(this)1005
1624 y(m)o(ust)e(alw)o(a)o(ys)g(terminate.)16 b(Th)o(us)10
b(w)o(e)g(m)o(ust)f(plan)g(ahead)h(as)1005 1673 y(w)o(e)16
b(follo)o(w)d(our)i(three)i(step)g(pro)q(cess.)24 b(Nev)o(ertheless,)18
b(de-)1005 1723 y(spite)d(the)f(concessions)i(w)o(e)e(ha)o(v)o(e)g
(made)f(to)h(staging,)f(this)1005 1773 y(in)o(terpreter)f(is)e(still)f
(clear,)i(concise)g(and)f(describ)q(es)j(the)d(se-)1005
1823 y(man)o(tics)j(of)g(the)i(while-language)d(in)i(a)g(straigh)o
(t-forw)o(ard)1005 1873 y(manner.)1005 2021 y Fn(5.4)52
b(Step)18 b(2:)23 b(staged)18 b(in)o(terpreter)1005 2168
y Fo(T)m(o)10 b(sp)q(ecialize)h(the)g(monadic)e(in)o(terpreter)j(to)f
(a)f(giv)o(en)g(pro-)1005 2218 y(gram)h(w)o(e)h(add)g(t)o(w)o(o)g(lev)o
(els)g(of)g(staging)g(annotations.)17 b(The)1005 2268
y(result)11 b(of)e(the)i(\014rst)g(stage)f(is)g(the)h(in)o(termediate)e
(co)q(de,)i(that)1005 2318 y(if)16 b(executed)i(returns)g(the)f(v)n
(alue)f(of)f(the)j(program.)24 b(The)1005 2368 y(use)13
b(of)f(the)h(brac)o(k)o(et)f(annotation)g(enables)h(us)f(to)g(describ)q
(e)1005 2417 y(precisely)20 b(the)g(co)q(de)g(that)f(m)o(ust)f(b)q(e)h
(generated)i(to)e(run)1005 2467 y(in)d(the)i(next)f(stage.)28
b(Escap)q(e)18 b(annotations)f(allo)o(w)e(us)i(to)1005
2517 y(escap)q(e)d(the)g(recursiv)o(e)g(calls)f(of)f(the)h(in)o
(terpreter)i(that)e(are)1005 2567 y(made)g(when)h(compiling)d(a)j
(while-program.)1005 2700 y Fh(\(*)19 b(eval2:)e(Exp)i(->)f(index)g(->)
h(<int)f(M>)h(*\))p eop
%%Page: 8 8
8 7 bop 0 42 a Fh(fun)18 b(eval2)g(exp)h(index)e(=)0
87 y(case)h(exp)h(of)39 133 y(Constant)e(n)i(=>)g(<Return)e(mswo)h
(~\(lift)f(n\)>)0 178 y(|)i(Variable)e(x)i(=>)59 224
y(let)f(val)h(loc)f(=)h(position)e(x)i(index)59 270 y(in)g(<read)e
(~\(lift)h(loc\)>)f(end)0 315 y(|)i(Minus\(x,y\))d(=>)59
361 y(<Do)i(mswo)g({)i(a)f(<-)g(~\(eval2)e(x)i(index\))e(;)275
407 y(b)i(<-)g(~\(eval2)e(y)i(index\);)275 452 y(Return)e(mswo)h(\(a)h
(-)g(b\))g(}>)0 498 y(|)g(Greater\(x,)o(y\))d(=>)59 544
y(<Do)i(mswo)g({)i(a)f(<-)g(~\(eval2)e(x)i(index\))e(;)275
589 y(b)i(<-)g(~\(eval2)e(y)i(index\);)275 635 y(Return)e(mswo)h(\(if)g
(a)i('>')e(b)588 681 y(then)g(1)588 726 y(else)g(0\))h(}>)0
772 y(|)g(Times\(x,y\))d(=>)59 818 y(<Do)i(mswo)g({)i(a)f(<-)g
(~\(eval2)e(x)i(index\))e(;)275 863 y(b)i(<-)g(~\(eval2)e(y)i(index\);)
275 909 y(Return)e(mswo)h(\(a)h(*)g(b\))g(}>;)0 1037
y Fo(The)f Fj(lift)e Fo(op)q(erator)i(inserts)g(the)g(v)n(alue)f(of)f
Fj(loc)h Fo(as)g(the)0 1087 y(argumen)o(t)j(to)i(the)g
Fj(read)e Fo(action.)40 b(The)22 b(v)n(alue)f(of)g Fj(loc)0
1137 y Fo(is)j(kno)o(wn)g(in)g(the)h(\014rst-stage)g(\(compile-time\),)
f(so)g(it)0 1186 y(is)17 b(transformed)g(in)o(to)f(a)h(constan)o(t)h
(in)f(the)h(second-stage)0 1236 y(\(run-time\))13 b(b)o(y)h
Fj(lift)p Fo(.)0 1336 y(T)m(o)k(understand)i(wh)o(y)f(the)g(escap)q(e)i
(op)q(erators)f(are)f(nec-)0 1386 y(essary)m(,)25 b(let)d(us)h
(consider)h(a)e(simple)f(example:)34 b Fj(eval2)0 1435
y(\(Minus\(Constant)19 b(3,Constant)g(1\)\))j([])p Fo(.)51
b(W)m(e)24 b(will)0 1485 y(unfold)13 b(this)h(example)f(b)o(y)g(hand)h
(b)q(elo)o(w:)0 1609 y Fh(eval2)k(\(Minus\(Co)o(ns)o(tan)o(t)f
(3,Consta)o(nt)f(1\)\))j([])g(=)0 1700 y(<)g(Do)g(mswo)98
1746 y({)g(a)h(<-)e(~\(eval2)f(\(Constant)f(3\))j([]\);)137
1792 y(b)h(<-)e(~\(eval2)f(\(Constant)f(1\))j([]\);)137
1837 y(Return)f(mswo)g(\(a-b\)})f(>)372 b(=)0 1929 y(<)19
b(Do)g(mswo)98 1974 y({)g(a)h(<-)e(~<Return)f(mswo)h(3>;)137
2020 y(b)i(<-)e(~<Return)f(mswo)h(1>;)137 2066 y(Return)g(mswo)g(\(a)h
(-)g(b\)})f(>)333 b(=)0 2157 y(<)19 b(Do)g(mswo)98 2203
y({)g(a)h(<-)e(Return)g(mswo)g(3;)137 2248 y(b)i(<-)e(Return)g(mswo)g
(1;)137 2294 y(Return)g(mswo)g(\(a)h(-)g(b\)})f(>)333
b(=)0 2385 y(<)19 b(Do)g(\045mswo)98 2431 y({)g(a)h(<-)e(Return)g
(\045mswo)f(3;)137 2477 y(b)j(<-)e(Return)g(\045mswo)f(1;)137
2522 y(Return)h(\045mswo)f(\(a)i(\045-)g(b\)})f(>)0 2650
y Fo(Eac)o(h)i(recursiv)o(e)i(call)d(pro)q(duces)j(a)d(brac)o(k)o(eted)
j(piece)f(of)0 2700 y(co)q(de)12 b(whic)o(h)e(is)h(spliced)g(in)o(to)f
(the)i(larger)e(piece)i(b)q(eing)f(con-)1005 42 y(structed.)32
b(Recall)17 b(that)g(escap)q(es)j(ma)o(y)c(only)h(app)q(ear)h(at)1005
91 y(lev)o(el-1)f(and)g(higher.)28 b(Splicing)17 b(is)g(axiomatized)e
(b)o(y)i(the)1005 141 y(reduction)h(rule:)26 b(~)p Fj(<x>)17
b Fg(\000)-7 b(!)17 b Fj(x)p Fo(,)g(whic)o(h)h(applies)f(only)f(at)1005
191 y(lev)o(el-1.)28 b(The)17 b(\014nal)g(step,)i(where)f
Fj(mswo)f Fo(and)g Fj(-)g Fo(b)q(ecome)1005 241 y Fj(\045mswo)9
b Fo(and)h Fj(\045-)p Fo(,)g(o)q(ccurs)h(b)q(ecause)h(b)q(oth)e(are)h
(free)g(v)n(ariables)1005 291 y(and)j(are)g(lexically)e(captured.)1005
603 y Fb(In)o(terpreter)g(for)k(Commands.)1005 753 y
Fo(Staging)c(the)i(in)o(terpreter)g(for)f(commands)e(pro)q(ceeds)k(in)d
(a)1005 803 y(similar)f(manner:)1005 1048 y Fh(\(*)38
b(interpret2)16 b(:)j(Com)g(->)g(index)e(->)39 b(<unit)18
b(M>)g(*\))1005 1094 y(fun)g(interpret2)e(stmt)i(index)g(=)1005
1139 y(case)g(stmt)g(of)1044 1185 y(Assign\(nam)o(e,e)o(\))e(=>)1064
1231 y(let)i(val)h(loc)f(=)h(position)e(name)h(index)1064
1276 y(in)h(<Do)f(mswo)g({)h(n)h(<-)f(~\(eval2)d(e)k(index\))d(;)1338
1322 y(write)h(~\(lift)f(loc\))h(n)i(}>)1064 1367 y(end)1005
1413 y(|)f(Seq\(s1,s2\))d(=>)1064 1459 y(<Do)i(mswo)g({)i(x)f(<-)g
(~\(interpr)o(et)o(2)e(s1)h(index\);)1280 1504 y(y)h(<-)g(~\(interpr)o
(et)o(2)e(s2)h(index\);)1280 1550 y(Return)f(mswo)h(\(\))h(}>)1005
1596 y(|)g(Cond\(e,s1,)o(s2\))d(=>)1064 1641 y(<Do)i(mswo)1142
1687 y({)i(x)f(<-)g(~\(eval2)e(e)i(index\);)1182 1733
y(if)f(x=1)1240 1778 y(then)g(~\(interpret)o(2)e(s1)j(index\))1240
1824 y(else)f(~\(interpret)o(2)e(s2)j(index\)}>)1005
1870 y(|)g(While\(e,b\))d(=>)1064 1915 y(<let)i(fun)g(loop)g(\(\))h(=)
1162 1961 y(Do)g(mswo)1162 2007 y({)g(v)g(<-)g(~\(eval2)e(e)i(index\);)
1201 2052 y(if)g(v=0)1260 2098 y(then)f(Return)f(mswo)h(\(\))1260
2144 y(else)g(Do)h(mswo)1358 2189 y({)g(q)h(<-)e(~\(interpre)o(t2)e(b)k
(index\);)1397 2235 y(loop)e(\(\)})1162 2281 y(})1083
2326 y(in)h(loop)f(\(\))h(end>)1005 2372 y(|)g(Declare\(nm)o(,e,)o(st)o
(mt\))d(=>)1064 2418 y(<Do)i(mswo)g({)i(x)f(<-)g(~\(eval2)e(e)i
(index\))e(;)1280 2463 y(push)h(x)h(;)1280 2509 y(~\(interpr)o(et)o(2)e
(stmt)h(\(nm::inde)o(x\))o(\))f(;)1280 2555 y(pop)h(}>)1005
2600 y(|)h(Print)f(e)h(=>)1064 2646 y(<Do)f(mswo)g({)i(x)f(<-)g
(~\(eval2)e(e)i(index\))e(;)1280 2692 y(output)g(x)i(}>;)p
eop
%%Page: 9 9
9 8 bop 0 42 a Fb(5.4.1)48 b(An)15 b(example.)0 168 y
Fo(The)f(function)g Fj(interpret2)e Fo(generates)j(a)f(piece)h(of)e(co)
q(de)0 218 y(from)k(a)h Fj(Com)h Fo(datat)o(yp)q(e.)32
b(T)m(o)18 b(illustrate)h(this)g(w)o(e)g(apply)0 268
y(it)13 b(to)g(the)h(simple)e(program:)k Fj(declare)21
b(x)g(=)h(10)f(in)h Fg(f)f Fj(x)0 317 y(:=)g(x)h(-)g(1;)f(print)g(x)g
Fg(g)36 b Fo(and)13 b(obtain:)0 445 y Fh(<Do)18 b(\045mswo)78
491 y({)i(a)f(<-)g(Return)e(\045mswo)h(10)78 537 y(;)i(\045push)d(a)78
582 y(;)j(Do)f(\045mswo)118 628 y({)g(e)g(<-)g(Do)g(\045mswo)255
674 y({)g(d)g(<-)g(Do)g(\045mswo)392 719 y({)h(b)f(<-)g(\045read)e(1)
392 765 y(;)j(c)f(<-)g(Return)e(\045mswo)h(1)392 811
y(;)i(Return)d(\045mswo)g(b)j(\045-)f(c)392 856 y(})255
902 y(;)g(\045write)f(1)h(d)255 948 y(})118 993 y(;)g(g)g(<-)g(Do)g
(\045mswo)255 1039 y({)g(f)g(<-)g(\045read)f(1)255 1085
y(;)h(\045output)e(f)255 1130 y(})118 1176 y(;)i(Return)e(\045mswo)h
(\(\))118 1222 y(})78 1267 y(;)i(\045pop)78 1313 y(}>)0
1445 y Fo(Note)c(that)f(the)g(staged)h(program)e(is)h(essen)o(tially)g
(a)f(com-)0 1495 y(piler,)28 b(translating)d(the)h(syn)o(tactic)g
(represen)o(tation)i(of)0 1545 y(the)18 b(while-program)c(in)o(to)j
(the)g(ab)q(o)o(v)o(e)g(monadic)e(ob)r(ject-)0 1595 y(program)e(that)j
(will)d(compute)i(its)g(meaning.)k(Note)d(that)0 1644
y(in)j(the)h(ob)r(ject-program)e(all)g(of)g(the)i(compile-time)c(op-)0
1694 y(erations)h(ha)o(v)o(e)f(disapp)q(eared.)26 b(This)16
b(ob)r(ject-program)f(is)0 1744 y(fully)i(executable.)35
b(Simply)16 b(b)o(y)j(using)f(the)i Fj(run)e Fo(op)q(era-)0
1794 y(tor)12 b(of)g Fk(Met)m(aML)p Fo(,)h(it)f(can)g(b)q(e)h(executed)
i(for)d(protot)o(yping)0 1844 y(purp)q(oses.)0 2048 y
Fl(6)56 b(Step)25 b(3:)37 b(Bac)n(k-end)24 b(translation)g(and)84
2106 y(in)n(termediate)16 b(co)r(de)i(optimization)0
2252 y Fk(Met)m(aML)i Fo(is)e(a)h(meta-programm)o(i)o(ng)d(system.)33
b(It)19 b(has)0 2301 y(an)i(ob)r(ject)h(language)e(and)h(a)g
(meta-language.)38 b(Meta-)0 2351 y(programs)11 b(are)h(programs)f
(that)h(manipulate)e(ob)r(ject)j(pro-)0 2401 y(grams.)20
b(In)15 b Fk(Met)m(aML)h Fo(b)q(oth)f(the)g(ob)r(ject)h(language)e(and)
0 2451 y(the)g(meta-language)c(are)k(ML.)e(In)h Fk(Met)m(aML)h
Fo(an)e(ob)r(ject-)0 2501 y(program)j(is)i(b)q(oth)f(a)h(data)f
(structure)j(that)e(can)g(b)q(e)g(ma-)0 2551 y(nipulated,)c(and)h(a)f
(program)g(that)h(can)g(b)q(e)g(run.)0 2650 y(This)g(dualit)o(y)f(pla)o
(ys)g(an)h(imp)q(ortan)o(t)e(role)i(in)g(target)g(co)q(de)0
2700 y(generation.)k(The)13 b(result)h(of)e(applying)g(the)h(staged)h
(in)o(ter-)1005 42 y(preter)f(from)c(the)i(previous)h(step)f(\(a)g
(meta-program\))d(to)j(a)1005 91 y(DSL)g(program)e(to)i(b)q(e)g
(compiled)f(is)h(a)f(highly)g(constrained)1005 141 y(residual)19
b(program)f(\(an)h(ob)r(ject)h(program\).)32 b(This)19
b(pro-)1005 191 y(gram)13 b(is)h(b)q(oth)h(a)f(data-structure)i(and)e
(a)g(program,)f(so)h(it)1005 241 y(can)d(b)q(e)g(b)q(oth)g(directly)g
(executed)i(\(rapid)e(protot)o(yp)q(e\))g(and)1005 291
y(analyzed.)1005 390 y(W)m(e)28 b(use)h(the)g(ob)r(ject-co)q(de)h
(analysis)e(capabilities)g(of)1005 440 y(MetaML)16 b(to)f(transform)g
(the)h(ob)r(ject)g(program)e(in)o(to)h(the)1005 490 y(\014nal)9
b(target)h(language.)15 b(This)10 b(analysis)f(can)g(include)h(b)q(oth)
1005 540 y(source)i(to)f(source)h(transformations,)e(or)g(translation)h
(in)o(to)1005 589 y(another)j(form)e(\(i.e.)17 b(in)o(termediate)c(co)q
(de,)h(assem)o(bly)f(lan-)1005 639 y(guage,)g(or)h(target)g
(language\).)1005 739 y(Con)o(trol)20 b(o)o(v)o(er)g(the)h(form)e(of)h
(the)h(residual)f(program)f(is)1005 789 y(crucial)12
b(here.)19 b(The)12 b(residual)g(program)f(is)h(alw)o(a)o(ys)f(an)h(ML)
1005 839 y(program)g(\(ML)i(is)f(the)h(ob)r(ject)g(language\).)k(But)c
(the)g(user)1005 888 y(can)k(con)o(trol)f(the)g(form)f(of)h(this)g(ML)g
(program.)27 b(A)17 b(goal)1005 938 y(of)j(the)g(translation)g(is)g(to)
g(mak)o(e)f(the)i(ob)r(ject)g(program)1005 988 y(use)f(only)e(those)h
(ML)g(features)h(directly)f(supp)q(orted)h(b)o(y)1005
1038 y(the)f(target)g(language.)31 b(F)m(or)19 b(example,)e(w)o(e)i(ma)
o(y)e(struc-)1005 1088 y(ture)j(the)g(staged)g(in)o(terpreter)h(suc)o
(h)g(that)e(the)h(residual)1005 1137 y(program)14 b(is)i(\014rst)h
(order,)f(or)g(just)g(a)g(sequence)i(of)d(primi-)1005
1187 y(tiv)o(e)e(actions)h(enco)q(ded)h(as)f(non-standard)f(morphisms)e
(in)1005 1237 y(the)16 b(monad.)21 b(This)16 b(is)f(where)i(w)o(e)f
(connect)h(the)f(abstract)1005 1287 y(monadic)c(actions)i(to)g(their)g
(e\016cien)o(t)g(implemen)o(tations.)1005 1386 y(The)g(ob)r(ject)g
(program)d(pro)q(duced)k(ab)q(o)o(v)o(e)e(is)g(an)g(ML)g(co)q(de)1005
1436 y(fragmen)o(t.)38 b(It)21 b(can)g(b)q(e)h(executed)h(or)e
(analyzed.)40 b(The)1005 1486 y(co)q(de)18 b(pro)q(duced)h(b)o(y)f
Fj(interpret2)d Fo(is)j(a)f(restricted)j(sub-)1005 1536
y(set)d(of)e(ML.)g(Disregarding)h(the)g(higher-order)h(functions)1005
1586 y(implicit)10 b(in)j(the)g(monad,)e(it)h(is)h(\014rst)h(order,)f
(and)g(con)o(tains)1005 1636 y(only)f Fj(Do)h Fo(expressions,)h
Fj(Return)e Fo(expressions,)i Fj(if)f Fo(expres-)1005
1685 y(sions,)21 b(calls)f(to)g(the)g(non-standard)h(morphisms)c
Fj(read)p Fo(,)1005 1735 y Fj(write)p Fo(,)9 b Fj(push)h
Fo(,)g Fj(pop)p Fo(,)g(and)g Fj(output)p Fo(,)f(primitiv)o(e)f
(arithmetic)1005 1785 y(op)q(erators)22 b Fj(-)e Fo(and)g
Fj('>')p Fo(,)i(and)e(lo)q(cal)g(lo)q(oping)f(functions)1005
1835 y(\(lik)o(e)11 b Fj(loop)g Fo(ab)q(o)o(v)o(e\).)17
b(The)12 b(co)q(de)g(is)g(so)f(regular)h(that)g(it)f(can)1005
1885 y(b)q(e)18 b(captured)g(b)o(y)f(a)g(simple)e(grammar.)25
b(The)17 b(next)h(step)1005 1934 y(is)13 b(to)g(analyze)g(this)g(co)q
(de)h(to)f(mak)o(e)e(the)j(\014nal)f(translation)1005
1984 y(to)f(the)i(target)f(language,)e(or)i(to)f(apply)g(some)g
(ML-source)1005 2034 y(to)f(ML-source)i(lev)o(el)e(optimizations.)k
(The)d(reader)h(migh)o(t)1005 2084 y(notice)g(that)g(the)h(ob)r
(ject-program)e(ab)q(o)o(v)o(e)h(could)f(b)q(e)i(con-)1005
2134 y(siderably)m(,)e(further)j(simpli\014ed)c(b)o(y)j(applying)e(the)
i(monad)1005 2183 y(la)o(ws.)31 b(There)19 b(are)g(man)o(y)d(opp)q
(ortunities)j(for)f(doing)f(so.)1005 2233 y(After)k(these)g(la)o(ws)f
(are)h(applied)e(w)o(e)i(obtain)e(the)i(m)o(uc)o(h)1005
2283 y(more)13 b(satisfying:)1005 2426 y Fh(<Do)18 b(\045mswo)1083
2472 y({)i(\045push)d(10)1083 2517 y(;)j(a)f(<-)g(\045read)e(1)1083
2563 y(;)j(b)f(<-)g(Return)e(\045mswo)h(a)h(\045-)g(1)1083
2609 y(;)h(c)f(<-)g(\045write)e(1)i(b)1083 2654 y(;)h(d)f(<-)g
(\045read)e(1)1083 2700 y(;)j(e)f(<-)g(\045output)e(d)p
eop
%%Page: 10 10
10 9 bop 78 42 a Fh(;)20 b(Return)d(\045mswo)h(\(\))78
87 y(;)i(\045pop)78 133 y(}>)0 264 y Fo(In)f(addition)f(to)h(the)g
(monad)f(la)o(ws)g(whic)o(h)h(hold)f(for)h(all)0 314
y(monads,)11 b(w)o(e)i(can)f(also)g(use)i(la)o(ws)e(whic)o(h)g(hold)g
(for)g(partic-)0 364 y(ular)j(non-standard)g(morphisms.)k(F)m(or)c
(instance,)h(in)e(the)0 414 y(example)i(ab)q(o)o(v)o(e,)h(w)o(e)g
(could)g(a)o(v)o(oid)e(the)j(second)g(read)g(of)0 464
y(lo)q(cation)13 b(1)h(using)f(the)i(follo)o(wing)c(rule:)0
591 y Fh(Do)19 b({)g(e1)59 636 y(;)g(c)g(<-)g(\045write)e(1)j(b)59
682 y(;)f(d)g(<-)g(\045read)f(1;)h(e2)59 728 y(})0 773
y(=)0 819 y(Do)g({)g(e)59 865 y(;)g(c)g(<-)g(\045write)e(1)j(b)59
910 y(;)f(e2[b/d])59 956 y(})0 1088 y Fo(Ev)o(ery)i(target)g(language)e
(will)g(ha)o(v)o(e)h(man)o(y)f(suc)o(h)i(la)o(ws,)0 1137
y(and)11 b(b)q(ecause)i(our)f(target)g(language)e(is)h(b)q(oth)h
(executable-)0 1187 y(co)q(de,)k(and)f(data-structure)j(w)o(e)d(can)h
(p)q(erform)e(these)j(op-)0 1237 y(timizations.)26 b(The)17
b(\014nal)g(step)h(is)f(to)g(translate)g(the)h(ML)0 1287
y(co)q(de)f(fragmen)o(t)e(in)o(to)h(the)h(target)g(language.)25
b(This)16 b(step)0 1337 y(uses)g(the)f(same)e(in)o(tensional)h
(analysis)f(of)h(co)q(de)h(capabili-)0 1386 y(ties)g(of)f(the)h
(optimization)d(steps,)j(and)f(is)h(the)g(sub)r(ject)h(of)0
1436 y(the)e(next)h(section.)0 1582 y Fn(6.1)52 b(In)o(tensional)34
b(analysis)f(of)f(co)q(de)i(frag-)119 1632 y(men)o(ts)0
1777 y Fo(In)20 b(this)f(section,)j(w)o(e)d(outline)g(ho)o(w)h(w)o(e)g
(do)f(in)o(tensional)0 1827 y(analysis)e(of)g(residual)g(co)q(de.)30
b(W)m(e)17 b(pro)o(vide)h(a)f(high-lev)o(el)0 1877 y(pattern)k(matc)o
(hing)d(based)j(in)o(terface.)37 b(Co)q(de)21 b(patterns)0
1927 y(can)11 b(b)q(e)g(constructed)h(b)o(y)e(placing)g(brac)o(k)o(ets)
h(around)g(co)q(de.)0 1976 y(F)m(or)f(example)g(a)g(pattern)h(that)g
(matc)o(hes)f(the)i(literal)d Fj(5)i Fo(can)0 2026 y(b)q(e)k
(constructed)h(b)o(y:)0 2153 y Fh(-|)j(fun)f(is5)h(<5>)f(=)h(true)98
2199 y(|)g(is5)g(_)g(=)g(false;)0 2245 y(val)f(is5)h(=)g(fn)39
b(:)19 b(<int>)f(->)g(bool)0 2336 y(-|)h(is5)f(\(lift)g(\(1+4\)\);)0
2382 y(val)g(it)h(=)h(true)37 b(:)19 b(bool)0 2473 y(-|)g(is5)f(<0>;)0
2519 y(val)g(it)h(=)h(false)37 b(:)19 b(bool)0 2650 y
Fo(The)14 b(function)g Fj(is5)f Fo(matc)o(hes)h(its)g(argumen)o(t)f(to)
g(the)i(con-)0 2700 y(stan)o(t)f(pattern)h Fj(<5>)e Fo(if)h(it)f
(succeeds)k(it)d(returns)h Fj(true)e Fo(else)1005 42
y Fj(false)p Fo(.)19 b(P)o(attern)d(v)n(ariables)e(in)g(co)q(de)h
(patterns)h(are)f(indi-)1005 91 y(cated)g(b)o(y)e(escaping)i(v)n
(ariables)e(in)g(the)i(co)q(de)f(pattern.)1005 232 y
Fh(-|)19 b(fun)f(parts)g(<)h(~x)g(+)g(~y)g(>)g(=)h(SOME\(x,y)o(\))1103
277 y(|)f(parts)f(_)h(=)g(NONE;)1005 323 y(val)f(parts)g(=)h(fn)39
b(:)19 b(<int>)f(->)h(\(<int>)e(*)i(<int>\))e(option)1005
414 y(-|)i(parts)f(<6)g(+)i(7>;)1005 460 y(val)e(it)h(=)h(SOME)e
(\(<6>,<7>\))e(:)j(\(<int>)e(*)i(<int>\))f(option)1005
551 y(-|)h(parts)f(<2>;)1005 597 y(val)g(it)h(=)h(NONE)37
b(:)19 b(\(<int>)f(*)h(<int>\))e(option)1005 741 y Fo(The)i(function)e
Fj(parts)h Fo(matc)o(hes)f(its)i(argumen)o(t)e(against)1005
791 y(the)c(pattern)g Fj(<)22 b Fo(~)q Fj(x)f(+)h Fo(~)q
Fj(y)f(>)p Fo(.)d(If)12 b(its)g(argumen)o(t)g(is)g(a)g(piece)1005
841 y(of)h(co)q(de)i(whic)o(h)f(is)f(the)i(sum)d(of)i(t)o(w)o(o)f(sub)h
(terms,)f(it)h(binds)1005 891 y(the)j(pattern)h(v)n(ariable)d
Fj(x)h Fo(to)h(the)g(left)f(subterm)h(and)f(the)1005
941 y(pattern)f(v)n(ariable)d Fj(y)i Fo(to)g(the)g(righ)o(t)g(subterm.)
1005 1040 y(W)m(e)22 b(use)h(higher-order)g(pattern)g(v)n(ariables[22)n
(,)f(21])f(for)1005 1090 y(co)q(de)27 b(patterns)h(that)f(con)o(tain)f
(binding)f(o)q(ccurrences,)1005 1140 y(suc)o(h)16 b(as)f(lam)o(b)q(da)e
(expressions,)k(let)e(expressions,)i(do)e(ex-)1005 1190
y(pressions,)g(or)e(functions.)1005 1289 y(F)m(or)f(example,)f(a)h
(high-order)h(pattern)g(that)f(matc)o(hes)g(the)1005
1339 y(co)q(de)k(of)f(a)g(function)g Fj(<fn)21 b(x)g(=>)h(...>)p
Fo(,)14 b(of)g(t)o(yp)q(e)i Fj(<'a)21 b(->)1005 1389
y('b>)14 b Fo(is)g(written)h(in)g(eta-expanded)g(form)e
Fj(<fn)21 b(x)h(=>)g(~)-5 b(\(g)1005 1439 y(<x>\)>)p
Fo(.)32 b(When)18 b(the)i(pattern)f(matc)o(hes,)g(the)h(matc)o(hing)
1005 1489 y(binds)13 b(the)i(higher-order)f(pattern)g(v)n(ariable)e
Fj(g)h Fo(to)h(a)f(func-)1005 1538 y(tion)g(with)h(t)o(yp)q(e)g
Fj(<'a>)21 b(->)h(<'b>)1005 1638 y Fo(Ev)o(ery)12 b(higher)g(order)h
(pattern)f(v)n(ariable)f(m)o(ust)g(b)q(e)h(in)f(fully)1005
1688 y(saturated)24 b(form,)e(b)o(y)h(applying)e(it)h(to)h(all)f(the)h
(b)q(ound)1005 1738 y(v)n(ariables)17 b(of)g(the)h(co)q(de)g(pattern.)
30 b(F)m(or)18 b(example)e(if)h Fj(g)g Fo(is)1005 1788
y(a)f(higher-order)h(pattern)h(v)n(ariable)d(with)h(t)o(yp)q(e)h
Fj(<'a>)k(->)1005 1837 y(<'b>)g(->)g(<'c>)c Fo(then)i(w)o(e)f(m)o(ust)f
(write)i Fj(~)l(\(g)i(<x>)g(<y>\))p Fo(.)1005 1887 y(The)14
b(argumen)o(ts)e(to)h(the)g(higher-order)h(pattern)g(v)n(ariable)1005
1937 y(m)o(ust)j(b)q(e)j(explicit)e(brac)o(k)o(eted)h(v)n(ariables,)g
(one)f(for)g(eac)o(h)1005 1987 y(v)n(ariable)e(b)q(ound)h(in)g(the)h
(co)q(de)g(pattern)g(at)f(the)h(con)o(text)1005 2037
y(where)f(the)f(higher-order)g(pattern)h(app)q(ears.)23
b(A)16 b(higher-)1005 2086 y(order)e(pattern)g(v)n(ariable)e(is)h(used)
h(lik)o(e)e(a)h(function)f(on)h(the)1005 2136 y(righ)o(t-hand)g(side)h
(of)g(a)f(matc)o(hing)f(construct.)1005 2236 y(F)m(or)18
b(example)f(functions)i(whic)o(h)f(implemen)o(t)e(the)j(three)1005
2286 y(monad)12 b(axioms)g(are)i(written)h(as)e(follo)o(ws:)1005
2426 y Fh(fun)18 b(monad1)1083 2472 y(<do)h(mswo)1162
2517 y({)g(x)g(<-)g(return)f(mswo)g(~e)1162 2563 y(;)h(~\(z)g(<x>\))f
(}>)1005 2609 y(=)h(z)g(e)1005 2700 y(fun)f(monad2)g(<do)g(mswo)g({)i
(x)f(<-)g(~m;)f(return)f(x)j(}>)e(=)i(m)p eop
%%Page: 11 11
11 10 bop 0 87 a Fh(fun)18 b(monad3)78 133 y(<do)h(mswo)157
178 y({)g(x)g(<-)g(do)g(mswo)f({y)h(<-)g(~a)157 224 y(;)g(~\(b)g
(<y>\)})157 270 y(;)g(~\(c)g(<x>)f(}>)0 315 y(=)h(<do)g(mswo)f({)h(y')g
(<-)g(~a)216 361 y(;)g(do)g(mswo)f({)h(z)g(<-)g(~\(b)g(<y'>\))216
407 y(;)g(~\(c)f(<z>\))h(}}>)0 551 y Fo(When)33 b(the)h(function)f
Fj(monad1)f Fo(is)h(applied)f(to)h(the)0 601 y(co)q(de)44
b Fj(<do)21 b(mswo)g Fg(f)p Fj(a)g(<-)h(returm)e(mswo)h(\(g)g(3\);)h
(h\(a)0 651 y(+)g(2\))p Fg(g)p Fj(>)p Fo(,)j(the)g(pattern)g(v)n
(ariable)e Fj(e)i Fo(is)f(b)q(ound)g(to)g(the)0 700 y(function)13
b Fj(fn)22 b(x)f(=>)h(<h\()q(~)-5 b(x)21 b(+)h(2\)>)13
b Fo(whic)o(h)g(has)h(the)g(t)o(yp)q(e)0 750 y Fj(<int>)21
b(->)g(<int)g(M>)p Fo(.)d(The)c(righ)o(t-hand)g(side)g(of)f
Fj(monad1)0 800 y Fo(rebuilds)18 b(a)f(new)h(co)q(de)g(fragmen)o(t,)f
(substituting)g(formal)0 850 y(parameter)g Fj(x)g Fo(of)g
Fj(e)g Fo(b)o(y)h Fj(<g)j(3>)p Fo(,)d(constructing)g(the)g(co)q(de)0
900 y Fj(<h\(\(g)j(3\)+)g(2\)>)p Fo(.)0 999 y(This)15
b(tec)o(hnique)h(can)f(b)q(e)h(used)g(to)f(build)f(optimizations,)0
1049 y(or)f(to)f(translate)h(a)g(residual)f(program)f(in)o(to)h(a)h
(target)g(lan-)0 1099 y(guage.)0 1308 y Fl(7)56 b(Conclusion)0
1460 y Fo(The)22 b(imp)q(ortan)o(t)e(issues)i(of)f(e\016cien)o(t)h
(language)f(imple-)0 1510 y(men)o(tation)16 b(b)o(y)i(re\014nemen)o(t)h
(from)d(high-lev)o(el)h(sp)q(eci\014ca-)0 1560 y(tions)j(are:)30
b(the)21 b(e\016cien)o(t)f(use)h(of)e(the)h(underlying)g(tar-)0
1609 y(get)f(en)o(vironmen)o(t,)f(and)g(remo)o(ving)e(the)j(la)o(y)o
(er)f(of)g(in)o(ter-)0 1659 y(pretativ)o(e)12 b(computation)e(in)o(tro)
q(duced)i(b)o(y)g(suc)o(h)g(sp)q(eci\014ca-)0 1709 y(tions.)18
b(W)m(e)13 b(ha)o(v)o(e)g(sho)o(wn)h(that)f(monads)f(and)i(staging)f
(are)0 1759 y(the)g(righ)o(t)f(abstraction)g(mec)o(hanisms)e(to)j
(accomplish)d(the)0 1809 y(task.)18 b(T)m(o)13 b(e\013ectiv)o(ely)i
(use)g(these)g(to)q(ols)f(w)o(e)g(prop)q(ose)h(that)0
1858 y(DSL)9 b(implemen)o(ters)f(follo)o(w)g(a)i(w)o(ell)f(de\014ned)i
(metho)q(d.)k(W)m(e)0 1908 y(reiterate)g(our)f(metho)q(d)f(here:)42
2052 y Fg(\017)20 b Fb(Domain)10 b(analysis.)16 b Fo(The)10
b(problem)f(domain)f(is)i(an-)83 2102 y(alyzed)i(to)f(\014nd)h(the)h
(common)c(abstractions)j(around)83 2152 y(whic)o(h)19
b(the)h(language)e(is)h(designed.)34 b(This)19 b(step)h(is)83
2202 y(p)q(erhaps)k(the)g(most)d(imp)q(ortan)o(t)g(step)j(in)f(a)f(go)q
(o)q(d)83 2252 y(language)e(design.)39 b(It)21 b(has)h(b)q(een)g
(studied)f(exten-)83 2301 y(siv)o(ely)15 b(b)o(y)g(others)h([32)o(,)f
(2)o(,)g(3].)21 b(Our)16 b(researc)o(h)h(group)83 2351
y(has)h(b)q(een)g(in)o(v)o(estigating)e(the)i(in)o(tegration)f(of)f
(DSL)83 2401 y(design)j(and)g(domain)e(analysis)h(for)h(sev)o(eral)h(y)
o(ears.)83 2451 y(Recen)o(tly)15 b(Widen)g(and)f(Ho)q(ok)h(ha)o(v)o(e)f
(summarized)f(a)83 2501 y(\\top)20 b(lev)o(el")f(view)h(of)f(this)h(in)
o(tegration,)g(whic)o(h)g(is)83 2551 y(called)14 b(the)i(Soft)o(w)o
(are)e(Design)g(Automation)f(\(SD)o(A\))83 2600 y(metho)q(d)19
b([33)o(].)33 b(This)20 b(metho)q(d)e(pro)o(vides)i(a)f(design)83
2650 y(pro)q(cess)i(and)e(man)o(y)e(syn)o(thesis)j(tec)o(hniques)h(to)e
(fa-)83 2700 y(cilitate)i(the)i(in)o(tegration)e(of)g(traditional)f
(domain)1088 42 y(analysis)10 b(activities)g(with)g(language)f(design)i
(and)f(im-)1088 91 y(plemen)o(tation.)20 b(The)c(metho)q(d)e(w)o(e)i
(prop)q(ose)g(can)f(b)q(e)1088 141 y(used)i(in)e(the)h(con)o(text)h(of)
e(SD)o(A.)g(It)g(sp)q(eci\014cally)h(ad-)1088 191 y(dresses)k(the)e
(language)e(implemen)o(tation)e(phase)19 b(of)1088 241
y(the)c(pro)q(cess.)1047 317 y Fg(\017)20 b Fb(De\014nition)o(al)10
b(in)o(terpret)o(er.)15 b Fo(Once)e(the)f(language)1088
367 y(has)i(b)q(een)i(iden)o(ti\014ed,)e(the)h(next)g(step)g(is)f(to)g
(pro)o(vide)1088 416 y(it)i(with)g(a)g(seman)o(tics)f(giv)o(en)h(as)g
(a)g(pure)h(functional)1088 466 y(in)o(terpreter.)35
b(This)19 b(program)f(can)h(b)q(e)h(though)o(t)f(of)1088
516 y(as)f(its)g(high-lev)o(el)f(de\014nition)g([14)o(,)h(25)o(].)30
b(high-lev)o(el)1088 566 y(in)o(terpreters)20 b(are)d(usually)g(easy)h
(to)f(construct)i(and)1088 616 y(pro)o(vide)d(a)g(reference)j(whic)o(h)
d(can)h(b)q(e)g(consulted)g(to)1088 665 y(resolv)o(e)h(an)o(y)e(am)o
(biguit)o(y)e(in)i(the)i(language)e(sp)q(eci\014-)1088
715 y(cation)e(disco)o(v)o(ered)h(in)e(further)i(steps.)20
b(By)14 b(building)1088 765 y(it)c(in)g(an)g(executable)i(framew)o(ork)
d(\(a)h(functional)g(lan-)1088 815 y(guage,)15 b(suc)o(h)g(as)g(Hask)o
(ell)g(or)g(ML\))g(it)f(also)h(pro)o(vides)1088 865 y(a)k(rapid)f
(protot)o(yp)q(e)i(against)e(whic)o(h)h(exp)q(ectations)1088
915 y(can)14 b(b)q(e)h(measured.)1047 991 y Fg(\017)20
b Fb(Binding)8 b(time)i(impro)o(v)o(emen)n(ts.)k Fo(The)d(next)f(step)
1088 1040 y(requires)21 b(a)f(binding)f(separation)i([8)o(].)36
b(By)21 b(iden)o(ti-)1088 1090 y(fying)13 b(compile-time)e(v)o(ersus)16
b(run-time)d(data)h(struc-)1088 1140 y(tures)e(in)e(the)i
(de\014nitional)d(in)o(terpreter,)k(w)o(e)e(can)g(sep-)1088
1190 y(arate)22 b(those)g(with)f Fm(b)n(oth)h Fo(comp)q(onen)o(ts)f(in)
o(to)g(sepa-)1088 1240 y(rate)12 b(data-structures.)19
b(Examples)11 b(of)g(binding)f(time)1088 1289 y(impro)o(v)o(emen)o(ts)
18 b(include)i(the)h(separation)f(of)f(en)o(vi-)1088
1339 y(ronmen)o(ts,)e(whic)o(h)g(map)f(names)g(to)h(v)n(alues,)h(in)o
(to)e(a)1088 1389 y(compile-tim)o(e)f(index)h(and)h(a)f(run-time)g
(stac)o(k,)h(and)1088 1439 y(the)12 b(in)o(tro)q(duction)g(of)f(a)g(lo)
q(cal)g(recursiv)o(e)j(function)d(to)1088 1489 y(separate)h(the)f
(recursion)h(whic)o(h)e(driv)o(es)h(the)h(analysis)1088
1539 y(of)h(the)h(syn)o(tax)g(of)f(the)i(program)d(b)q(eing)h(in)o
(terpreted)1088 1588 y(from)g(the)i(recursion)h(that)e(enco)q(des)i
(the)f(lo)q(oping)f(of)1088 1638 y(the)h Fj(while)d Fo(command.)1047
1714 y Fg(\017)20 b Fb(T)l(arget)28 b(domain)f(analysis)p
Fo(.)49 b(The)26 b(next)f(step)1088 1764 y(is)c(to)g(analyze)g(the)h
(target)g(language)e(to)h(iden)o(tify)1088 1814 y(the)13
b(primitiv)o(e)d(implem)o(en)o(tation)f(features)k(that)f(will)1088
1864 y(supp)q(ort)20 b(the)g(translation.)33 b(This)19
b(step)i(is)e(usually)1088 1913 y(straigh)o(t-forw)o(ard)12
b(as)g(the)h(target)f(language)g(is)g(often)1088 1963
y(\014xed,)i(and)g(w)o(ell)f(understo)q(o)q(d.)1047 2039
y Fg(\017)20 b Fb(Design)15 b(a)i(monad.)i Fo(The)c(next)g(step)h(is)e
(to)h(design)1088 2089 y(a)e(monad)f(to)h(capture)i(the)f(e\013ects)h
(and)f(actions)f(im-)1088 2139 y(plicit)c(in)h(the)g(target)h
(language.)16 b(This)9 b(is)h(a)g(hard)g(step)1088 2189
y(in)19 b(the)h(pro)q(cess)h(since)f(it)e(requires)j(b)q(oth)e
(abstract)1088 2239 y(kno)o(wledge)e(ab)q(out)g(the)g(structure)j(and)d
(prop)q(erties)1088 2288 y(of)22 b(monads,)i(and)e(detailed)h(concrete)
i(kno)o(wledge)1088 2338 y(ab)q(out)14 b(the)g(target)h(domain.)h(The)e
(c)o(hoices)h(made)d(in)1088 2388 y(this)i(step)i(in\015uence)f(the)g
(structure)i(of)c(the)i(monad,)1088 2438 y(the)k(structure)h(of)e(the)h
(monadic)d(in)o(terpreter,)21 b(and)1088 2488 y(the)e(run-time)e
(system)h(whic)o(h)g(in)o(teracts)h(with)f(the)1088 2537
y(lo)o(w-lev)o(el)13 b(e\013ects)i(of)f(the)g(target)h(language.)1088
2600 y(Once)20 b(the)f(monad)e(is)h(designed,)i(an)e(implemen)o(ta-)
1088 2650 y(tion)f(for)g(the)g(monad)f(as)h(a)g(pure)h(functional)e(em)
o(u-)1088 2700 y(lation)d(m)o(ust)h(b)q(e)h(pro)q(duced.)21
b(The)15 b(implemen)o(tation)p eop
%%Page: 12 12
12 11 bop 83 42 a Fo(m)o(ust)11 b(em)o(ulate)f(the)i(actions)g(in)f(a)g
(purely)h(functional)83 91 y(setting)18 b(b)o(y)f(explicitly)g
(threading)g(abstract)i(repre-)83 141 y(sen)o(tations)12
b(of)g(the)h(actions)f(suc)o(h)g(as)g(\\stores",)h(\\I/O)83
191 y(streams",)j(or)g(\\exception)h(con)o(tin)o(uations")e(in)h(and)83
241 y(out)e(of)f(all)g(computations.)42 393 y Fg(\017)20
b Fb(Monadic)h(In)o(terpreter)o(.)32 b Fo(The)19 b(next)h(step)g(is)f
(to)83 443 y(re\014ne)h(the)f(purely)g(functional)f(de\014nitional)g
(in)o(ter-)83 493 y(preter)e(in)o(to)f(one)g(written)g(in)g(a)f
(monadic)f(st)o(yle)i([28)o(,)83 543 y(24,)22 b(13)o(].)43
b(This)23 b(implemen)o(tatio)o(n)d(is)i(still)g(purely)83
592 y(functional)e(b)q(ecause)k(the)e(actions)f(of)g(the)h(monad)83
642 y(are)12 b(em)o(ulated)f(in)g(a)g(functional)g(st)o(yle.)17
b(But)12 b(b)q(ecause)83 692 y(the)21 b(actions)g(are)f(no)o(w)g
(explicit,)i(w)o(e)e(ha)o(v)o(e)h(mo)o(v)o(ed)83 742
y(the)c(form)d(of)h(de\014nition)h(closer)g(to)g(the)g(target)h(lan-)83
792 y(guage.)g(This)c(step)h(often)f(requires)h(a)e(big)g(c)o(hange)h
(to)83 841 y(the)19 b(structure)i(of)c(the)j(source)f(co)q(de,)h(b)q
(ecause)g(the)83 891 y(monad)11 b(mak)o(es)h(implicit)e(m)o(uc)o(h)h
(of)i(the)g(\\plum)o(bing")83 941 y(explicit)h(in)h(the)g(in)o
(terpreter.)23 b(The)16 b(cost)f(of)g(this)f(re-)83 991
y(structuring)e(is)e(not)h(without)f(b)q(ene\014t.)18
b(The)11 b(remo)o(v)n(al)83 1041 y(of)21 b(the)i(explicit)f(plum)o
(bing)d(results)24 b(in)d(programs)83 1091 y(whic)o(h)14
b(are)g(simpler,)e(and)h(more)g(imm)o(une)e(to)i(future)83
1140 y(c)o(hanges.)42 1293 y Fg(\017)20 b Fb(Staging.)15
b Fo(The)c(next)f(step)i(completes)d(the)i(binding-)83
1343 y(time)25 b(separation)i(b)q(egun)h(in)e(the)h(binding)f(time)83
1392 y(impro)o(v)o(emen)o(t)19 b(step.)44 b(That)22 b(step)h(separated)
g(the)83 1442 y(compile-tim)o(e)k Fm(data)j Fo(from)d(the)j(run-time)e
(data.)83 1492 y(Staging)21 b(separates)j(the)f(compile-tim)o(e)d
Fm(c)n(omputa-)83 1542 y(tions)h Fo(from)e(the)j(run-time)d
(computations.)38 b(This)83 1592 y(is)14 b(done)h(b)o(y)f(placing)g
(explicit)g(staging)g(annotations)83 1641 y(in)k(the)g(program)f
(written)h(in)g Fk(Met)m(aML)p Fo(.)g(Staging)83 1691
y(is)c(the)g(crucial)g(step)h(that)f(di\013eren)o(tiates)h(an)e
(\(ine\016-)83 1741 y(cien)o(t\))h(in)o(terpreter)i(from)c(an)i
(\(e\016cien)o(t\))h(compiler.)42 1893 y Fg(\017)20 b
Fb(T)l(ransformation)13 b(of)i(residual)e(co)q(de.)83
1995 y Fo(The)25 b(residual)g(ob)r(ject-program)f(pro)q(duced)j(b)o(y)d
(a)83 2044 y(staged)13 b(in)o(terpreter)h(is)e(b)q(oth)g(a)g(data)g
(structure)i(that)83 2094 y(can)k(b)q(e)h(manipulated,)d(and)i(a)f
(program)g(that)h(can)83 2144 y(b)q(e)f(run.)27 b(Con)o(trol)16
b(o)o(v)o(er)h(the)g(form)e(of)i(the)g(residual)83 2194
y(program)c(is)i(crucial)f(here.)22 b(The)15 b(residual)g(program)83
2244 y(is)20 b(alw)o(a)o(ys)f(an)i(ML)f(program)f(\(ML)h(is)g(the)h(ob)
r(ject)83 2293 y(language\).)27 b(But)17 b(the)h(user)g(can)f(con)o
(trol)g(the)h(form)83 2343 y(of)c(this)h(ML)g(program.)20
b(A)15 b(goal)f(of)g(the)i(translation)83 2393 y(is)h(to)g(mak)o(e)e
(the)j(ob)r(ject)g(program)d(use)j(only)e(those)83 2443
y(ML)j(features)h(directly)f(supp)q(orted)h(b)o(y)e(the)h(target)83
2493 y(language.)28 b(The)18 b(restricted)i(form)c(of)h(the)h(residual)
83 2542 y(ob)r(ject)e(program)d(mak)o(e)g(it)h(p)q(ossible)h(to)g(use)g
(the)h(in-)83 2592 y(tensional)11 b(analysis)g(of)g(ob)r(ject-co)q(de)j
(to)q(ols)d(pro)o(vided)83 2642 y(b)o(y)h(MetaML)g(to)g(easily)f(build)
h(the)g(\014nal)g(translation)83 2692 y(step)j(to)f(the)g(target)g
(language.)1005 42 y Fn(7.1)52 b(Bene\014ts)18 b(of)f(the)h(approac)o
(h)1005 193 y Fo(This)i(pap)q(er)h(illustrated)f(a)g(step)i(b)o(y)e
(step)h(metho)q(d)e(for)1005 243 y(constructing)h(correct)h(and)e
(e\016cien)o(t)g(implemen)o(tations)1005 293 y(of)13
b(DSLs.)18 b(The)d(metho)q(d)e(has)h(the)g(follo)o(wing)d(adv)n(an)o
(tages)1005 343 y(o)o(v)o(er)18 b(building)e(a)i(DSL)f(implemen)o
(tatio)o(n)e(in)i(an)h(ad-ho)q(c)1005 393 y(fashion.)1047
538 y Fg(\017)i Fb(Simplici)o(t)n(y)l(.)c Fo(W)m(e)e(divide)f(the)h
(task)g(of)g(DSL)f(imple-)1088 588 y(men)o(tation)d(of)h(DSL)g(in)o(to)
g(small)e(manageable)h(tasks.)1088 637 y(The)j(compiler)e(is)h
(constructed)j(b)o(y)d(a)g(metho)q(d)g(of)f(re-)1088
687 y(\014nemen)o(t,)h(and)h(w)o(e)f(use)i(sp)q(ecial)f(abstraction)g
(mec)o(h-)1088 737 y(anisms)d(so)h(that)g(eac)o(h)h(step)g(addresses)h
(only)d(a)h(single)1088 787 y(asp)q(ect)k(of)f(the)g(compiler.)1047
875 y Fg(\017)20 b Fb(Reuse.)26 b Fo(Our)17 b(metho)q(d)e(pro)o(vides)i
(man)o(y)e(opp)q(ortu-)1088 925 y(nities)c(for)g(reuse.)18
b(By)11 b(using)g(the)h(abstraction)f(meth-)1088 974
y(o)q(ds)f(of)f(monads)f(and)i(staging,)f(m)o(uc)o(h)g(of)g(the)h(co)q
(de)g(re-)1088 1024 y(mains)i(unc)o(hanged)h(b)q(et)o(w)o(een)i
(re\014nemen)o(t)f(steps.)19 b(In)1088 1074 y(addition,)14
b(monad)f(implemen)o(tations)f(are)k(reusable)1088 1124
y(across)e(DSLs,)f(and)f(m)o(ultiple)f(DLS)i(using)f(the)i(same)1088
1174 y(target)g(language)f(can)h(reuse)h(the)f(in)o(tensional)f(anal-)
1088 1224 y(ysis.)1047 1312 y Fg(\017)20 b Fb(Con)o(trol.)i
Fo(Instead)17 b(of)e(using)g(a)g(\014xed)i(set)f(of)f(tec)o(h-)1088
1361 y(niques)k(or)g(to)q(ol)f(to)h(generate)h(compilers,)e(w)o(e)h
(out-)1088 1411 y(line)11 b(a)g(metho)q(d)f(whic)o(h)h(pro)o(vides)g
(users)i(con)o(trol)e(o)o(v)o(er)1088 1461 y(eac)o(h)17
b(step.)29 b(A)17 b(go)q(o)q(d)f(imp)q(edance)h(matc)o(h)f(b)q(et)o(w)o
(een)1088 1511 y(lo)o(w-lev)o(el)j(features)j(of)e(the)h(target)g
(language)f(and)1088 1561 y(the)12 b(high-lev)o(el)e(DSL)h(is)g
(necessary)i(for)e(go)q(o)q(d)g(p)q(erfor-)1088 1611
y(mance.)20 b(Since)15 b(ev)o(ery)h(compiler)d(is)i(di\013eren)o(t,)g
(users)1088 1660 y(need)g(suc)o(h)g(\014ne)f(grained)g(con)o(trol.)1047
1748 y Fg(\017)20 b Fb(Correctness.)c Fo(The)11 b Fk(Met)m(aML)g
Fo(t)o(yp)q(e)g(system)f(pro-)1088 1798 y(vides)19 b(ma)r(jor)d(supp)q
(ort)k(for)e(ensuring)g(the)h(correct-)1088 1848 y(ness)h(of)e(the)i
(compilers)d(generated.)34 b(It)19 b(is)g(simply)1088
1898 y(not)e(p)q(ossible)h(to)f(write)g(a)g(t)o(yp)q(e-incorrect)i
(transla-)1088 1948 y(tion.)25 b(But)17 b(t)o(yp)q(e-correctness)i(is)e
(not)f(enough.)25 b(W)m(e)1088 1998 y(wish)20 b(to)f(pro)o(v)o(e)h
(other)h(correctness)i(prop)q(erties)e(as)1088 2047 y(w)o(ell,)14
b(suc)o(h)h(as)g(the)g(equiv)n(alence)g(b)q(et)o(w)o(een)h(the)f(arti-)
1088 2097 y(facts)d(pro)q(duced)h(b)o(y)f(eac)o(h)g(step)h(of)e(the)i
(metho)q(d.)j(W)m(e)1088 2147 y(b)q(eliev)o(e)d(that)g(it)f(is)h(p)q
(ossible)g(for)g(eac)o(h)g(step)h(to)e(mak)o(e)1088 2197
y(explicit)h(its)h(pro)q(of)f(obligations,)f(and)h(b)q(ecause)i(eac)o
(h)1088 2247 y(step)f(pro)q(duces)g(a)e(functional)g(program,)e(it)i
(is)h(p)q(ossi-)1088 2296 y(ble)j(to)g(use)h(equational)e(reasoning)h
(to)g(pro)o(v)o(e)h(these)1088 2346 y(obligations)1005
2498 y Fn(7.2)52 b(The)18 b(Implemen)o(tation)1005 2650
y Fo(Ev)o(erything)d(y)o(ou)f(ha)o(v)o(e)g(seen)i(in)f(this)f(pap)q
(er,)h(except)h(the)1005 2700 y(higher)g(order)g(pattern)g(matc)o(hing)
e(o)o(v)o(er)h(co)q(de,)h(has)g(b)q(een)p eop
%%Page: 13 13
13 12 bop 0 42 a Fo(implemen)o(ted)8 b(in)i(the)i Fk(Met)m(aML)f
Fo(implemen)o(tation.)j(The)0 91 y(examples)f(are)h(actual)g(runs)g(of)
g(the)g(system.)0 191 y(The)g(higher)h(order)f(pattern)h(matc)o(hing)d
(is)i(curren)o(tly)h(un-)0 241 y(der)10 b(dev)o(elopmen)o(t.)16
b(W)m(e)9 b(found)g(the)i(normalizing)6 b(e\013ect)12
b(of)0 291 y(the)h(monad)d(la)o(ws)i(so)g(comp)q(elling)e(that)j(w)o(e)
f(implemen)o(ted)0 340 y(them)g(in)g(an)g(ad-ho)q(c)g(fashion)g(inside)
g(the)h Fk(Met)m(aML)h Fo(sys-)0 390 y(tem.)0 592 y Fl(8)56
b(Ac)n(kno)n(wledgmen)n(ts)0 736 y Fo(The)25 b(authors)g(w)o(ould)e
(lik)o(e)h(to)g(ac)o(kno)o(w)o(edge)h(generous)0 786
y(supp)q(ort)d(from)e(the)h(USAF)h(Air)f(Materiel)h(Comma)o(nd,)0
836 y(con)o(tract)f(#F19628-96-C-016)o(1;)e(the)i(National)d(Scince)0
885 y(F)m(oundation,)37 b(gran)o(ts)d(#IRI-9625462)d(and)j(#CCR-)0
935 y(9803880;)12 b(and)h(the)i(Departmen)o(t)e(of)g(Defense.)0
1137 y Fl(References)21 1245 y Fo([1])19 b(Anders)c(Bondorf)e(and)g
(Jens)i(P)o(alsb)q(erg.)i(Compiling)85 1295 y(actions)12
b(b)o(y)f(partial)g(ev)n(aluation.)i(In)f Fm(Confer)n(enc)n(e)g(on)85
1344 y(F)m(unctional)k(Pr)n(o)n(gr)n(amming)e(L)n(anguages)i(and)g
(Com-)85 1394 y(puter)i(A)o(r)n(chite)n(ctur)n(e)p Fo(,)e(pages)h
(308{320,)e(New)j(Y)m(ork,)85 1444 y(June)d(1993.)d(A)o(CM)i(Press.)20
b(Cop)q(enhagen.)21 1521 y([2])f(Grady)29 b(Campb)q(ell.)62
b(Abstraction-based)30 b(reuse)85 1571 y(rep)q(ositories.)96
b(T)m(ec)o(hnical)39 b(Rep)q(ort)h(REUSE-)85 1621 y
(REPOSITORIES-89041-N,)26 b(Soft)o(w)o(are)g(Pro)q(duc-)85
1671 y(tivit)o(y)18 b(Consortium)f(Services)i(Corp)q(oration,)g(2214)85
1721 y(Ro)q(c)o(k)11 b(Hill)e(Road,)h(Herndon,)h(Virginia)f(22070,)f
(June)85 1771 y(1989.)21 1848 y([3])19 b(Grady)27 b(Campb)q(ell,)h
(Stuart)f(F)m(aulk,)i(and)e(Da)o(vid)85 1898 y(W)m(eiss.)64
b(In)o(tro)q(duction)30 b(to)f(Syn)o(thesis.)65 b(T)m(ec)o(h-)85
1947 y(nical)11 b(Rep)q(ort)i(INTR)o(O-SYNTHESIS-PR)o(OCESS-)85
1997 y(90019-N,)28 b(Soft)o(w)o(are)g(Pro)q(ductivit)o(y)h(Consortium)
85 2047 y(Services)d(Corp)q(oration,)f(2214)d(Ro)q(c)o(k)i(Hill)e
(Road,)85 2097 y(Herndon,)14 b(Virginia)f(22070,)f(1990.)21
2174 y([4])19 b(Charles)f(Consel)g(and)f(F)m(ran\030)-18
b(cois)17 b(No)o(\177)-20 b(el.)29 b(A)18 b(general)85
2224 y(approac)o(h)10 b(for)g(run-time)f(sp)q(ecialization)h(and)g(its)
g(ap-)85 2274 y(plication)j(to)g(C.)18 b(In)c Fm(Confer)n(enc)n(e)h(R)n
(e)n(c)n(or)n(d)f(of)h(POPL)85 2324 y('96:)20 b(The)15
b Fo(23)300 2309 y Fa(rd)348 2324 y Fm(A)o(CM)g(SIGPLAN-SIGA)o(CT)g
(Sym-)85 2374 y(p)n(osium)27 b(on)h(Principles)e(of)h(Pr)n(o)n(gr)n
(amming)f(L)n(an-)85 2423 y(guages)p Fo(,)20 b(pages)e(145{156,)f(St.)h
(P)o(etersburg)i(Beac)o(h,)85 2473 y(Florida,)13 b(21{24)f(Jan)o(uary)i
(1996.)21 2551 y([5])19 b(O)27 b(Dan)o(vy)m(,)i(J)e(Koslo)o(wski,)i
(and)d(K)h(Malmkjaer.)85 2600 y(Compiling)7 b(monads.)j(T)m(ec)o
(hnical)f(Rep)q(ort)h(CIS-92-3,)85 2650 y(Kansas)18 b(State)h(Univ)o
(ersit)o(y)m(,)e(Manhattan,)h(Kansas,)85 2700 y(Decem)o(b)q(er)d(91.)
1026 42 y([6])k(Rob)q(ert)27 b(Gl)q(\177)-22 b(uc)o(k)26
b(and)h(Jesp)q(er)i(J\034rgensen.)57 b(E\016-)1090 91
y(cien)o(t)15 b(m)o(ulti-lev)o(el)c(generating)j(extensions)h(for)e
(pro-)1090 141 y(gram)20 b(sp)q(ecialization.)39 b(In)21
b(S.)g(D.)f(Swierstra)i(and)1090 191 y(M.)c(Hermenegildo,)h(editors,)g
Fm(Pr)n(o)n(gr)n(amming)g(L)n(an-)1090 241 y(guages:)g
(Implementations,)12 b(L)n(o)n(gics)h(and)g(Pr)n(o)n(gr)n(ams)1090
291 y(\(PLILP'95\))p Fo(,)23 b(v)o(olume)18 b(982)i(of)g
Fm(L)n(e)n(ctur)n(e)h(Notes)g(in)1090 340 y(Computer)j(Scienc)n(e)p
Fo(,)j(pages)d(259{278.)e(Springer-)1090 390 y(V)m(erlag,)13
b(1995.)1026 473 y([7])19 b(Mark)11 b(P)m(.)f(Jones.)j(A)e(system)f(of)
g(constructor)i(classes:)1090 523 y(o)o(v)o(erloading)f(and)g(implicit)
f(higher-order)i(p)q(olymor-)1090 573 y(phism.)18 b(In)d
Fm(In)g(FPCA)g('93:)20 b(Confer)n(enc)n(e)c(on)g(F)m(unc-)1090
623 y(tional)i(Pr)n(o)n(gr)n(amming)e(L)n(anguages)j(and)f(Computer)
1090 673 y(A)o(r)n(chite)n(ctur)n(e)p Fo(,)h(pages)h(52{64.)e(A)o(CM)h
(Press,)j(1993.)1090 723 y(\(App)q(ears,)17 b(in)f(extended)h(form,)d
(in)i(the)g(Journal)g(of)1090 772 y(F)m(unctional)9 b(Programming,)e
(5,)j(1,)g(Cam)o(bridge)e(Uni-)1090 822 y(v)o(ersit)o(y)14
b(Press,)i(Jan)o(uary)d(1995.\).)1026 905 y([8])19 b(Neil)d(D.)e
(Jones,)j(Carsten)f(K.)g(Gomard,)d(and)j(P)o(eter)1090
955 y(Sestoft.)d Fm(Partial)d(Evaluation)i(and)g(A)o(utomatic)f(Pr)n
(o-)1090 1005 y(gr)n(am)i(Gener)n(ation)p Fo(.)i(Series)e(editor)f(C.)f
(A.)g(R.)g(Hoare.)1090 1055 y(Pren)o(tice)22 b(Hall)d(In)o
(ternational,)i(In)o(ternational)f(Se-)1090 1105 y(ries)i(in)e
(Computer)g(Science,)j(June)e(1993.)37 b(ISBN)1090 1154
y(n)o(um)o(b)q(er)13 b(0-13-020249-5)e(\(pbk\).)1026
1238 y([9])19 b(P)o(aul)35 b(Hudak)g(Simon)e(P)o(eyton)j(Jones,)41
b(Philip)1090 1288 y(W)m(adler,)16 b(Brian)g(Boutel,)h(John)f(F)m
(airbairn,)f(Joseph)1090 1337 y(F)m(asel,)46 b(Maria)40
b(M.)g(Guzman,)k(Kevin)d(Ham-)1090 1387 y(mond,)18 b(John)g(Hughes,)i
(Thomas)d(Johnsson,)j(Dic)o(k)1090 1437 y(Kieburtz,)j(Rishiyur)d
(Nikhil,)g(Will)e(P)o(artain,)j(and)1090 1487 y(John)32
b(P)o(eterson.)71 b(Rep)q(ort)31 b(on)g(the)h(program-)1090
1537 y(ming)23 b(language)g(Hask)o(ell.)49 b Fm(SIGPLAN)25
b(Notic)n(es)p Fo(,)1090 1586 y(27\(5\):Section)14 b(R,)f(1992.)1005
1670 y([10])19 b(P)o(eter)29 b(Lee.)61 b Fm(R)n(e)n(alistic)27
b(Compiler)f(Gener)n(ation)p Fo(.)1090 1719 y(F)m(oundations)16
b(of)f(Computing)f(Series.)j(MIT)f(Press,)1090 1769 y(1989.)1005
1853 y([11])j(Mark)d(Leone)g(and)g(P)o(eter)h(Lee.)25
b(A)15 b(declarativ)o(e)h(ap-)1090 1902 y(proac)o(h)f(to)g(run-time)f
(co)q(de)h(generation.)21 b(In)15 b Fm(Work-)1090 1952
y(shop)g(on)f(Compiler)e(Supp)n(ort)j(for)e(System)h(Softwar)n(e)1090
2002 y(\(WCSSS\))p Fo(,)h(F)m(ebruary)f(1996.)1005 2085
y([12])19 b(Sheng)11 b(Liang)e(and)h(P)o(aul)f(Hudak.)j(Mo)q(dular)e
(denota-)1090 2135 y(tional)15 b(seman)o(tics)h(for)f(compiler)g
(construction.)25 b(In)1090 2185 y Fm(ESOP'96:)31 b(6th)21
b(Eur)n(op)n(e)n(an)h(Symp)n(osium)f(on)g(Pr)n(o-)1090
2235 y(gr)n(amming)p Fo(,)16 b(n)o(um)o(b)q(er)f(1058)g(in)g(LNCS,)h
(pages)g(333{)1090 2284 y(343,)d(Link)o(oping,)f(Sw)o(eden,)i(Jan)o
(uary)g(1996.)1005 2368 y([13])19 b(Sheng)j(Liang,)g(P)o(aul)f(Hudak,)i
(and)f(Mark)f(Jones.)1090 2418 y(Monad)13 b(transformers)g(and)g(mo)q
(dular)e(in)o(terpreters.)1090 2467 y(In)i Fm(A)o(CM)g(Symp)n(osium)h
(on)g(Principles)f(of)g(Pr)n(o)n(gr)n(am-)1090 2517 y(ming)f(L)n
(anguages)p Fo(,)g(pages)e(333{343,)f(San)h(F)m(rancisco,)1090
2567 y(California,)i(Jan)o(uary)h(1995.)1005 2650 y([14])19
b(P)m(.)d(Mosses.)26 b(Denotational)15 b(seman)o(tics.)24
b(In)17 b(J.)f(v)n(an)1090 2700 y(Leeu)o(w)o(en,)c(editor,)e
Fm(Handb)n(o)n(ok)i(of)f(The)n(or)n(etic)n(al)f(Com-)p
eop
%%Page: 14 14
14 13 bop 85 42 a Fm(puter)11 b(Scienc)n(e)p Fo(.)f(Elsevier)h(Science)
g(Publishers)g(B.)e(V.)85 91 y(\(North-Holland\),)k(1990.)0
173 y([15])19 b(P)o(eter)i(D.)e(Mosses.)35 b(SIS-seman)o(tics)19
b(implemen)o(ta-)85 223 y(tion)13 b(system,)g(reference)i(man)o(ual)c
(and)i(users)i(guide.)85 272 y(T)m(ec)o(hnical)j(Rep)q(ort)g(D)o(AIMI)f
(rep)q(ort)i(MD-30,)e(Uni-)85 322 y(v)o(ersit)o(y)d(of)g(Aarh)o(us,)g
(Aarh)o(us,)f(Denmark,)g(1979.)0 404 y([16])19 b(P)o(eter)14
b(D.)d(Mosses.)16 b(Action)c(seman)o(tics.)i Fm(Cambridge)85
454 y(T)m(r)n(acts)j(in)g(The)n(or)n(etic)n(al)g(Computer)g(Scienc)n(e)
p Fo(,)h(\(26\),)85 503 y(1992.)0 585 y([17])h(Martin)43
b(Odersky)h(and)f(Konstan)o(tin)f(L\177)-21 b(aufer.)85
635 y(Putting)23 b(t)o(yp)q(e)h(annotations)e(to)h(w)o(ork.)45
b(In)23 b Fm(23r)n(d)85 685 y(A)o(CM)g(Symp)n(osium)i(on)f(Principles)e
(of)i(Pr)n(o)n(gr)n(am-)85 734 y(ming)17 b(L)n(anguages)p
Fo(,)f(St.)f(P)o(etersburg,)i(Florida,)d(Jan-)85 784
y(uary)g(1996.)0 866 y([18])19 b(L.)f(P)o(aulson.)31
b Fm(Metho)n(ds)20 b(and)g(T)m(o)n(ols)e(for)h(Compiler)85
916 y(Construction,)k(B.)e(L)n(orho)g(\(e)n(ditor\))p
Fo(.)38 b(Cam)o(bridge)85 965 y(Univ)o(ersit)o(y)14 b(Press,)h(1984.)0
1047 y([19])k(La)o(wrence)h(P)o(aulson.)30 b(A)18 b(sematics)g
(directed)h(com-)85 1097 y(piler)h(generator.)36 b(In)20
b Fm(Confer)n(enc)n(e)g(R)n(e)n(c)n(or)n(d)g(of)g(the)85
1147 y(Ninth)d(A)o(nnual)h(A)o(CM)f(Symp)n(osium)h(on)g(Principles)85
1196 y(of)28 b(Pr)n(o)n(gr)n(amming)f(L)n(anguages)p
Fo(,)33 b(pages)28 b(224{233.)85 1246 y(A)o(CM,)14 b(Jan)o(uary)g
(1982.)0 1328 y([20])19 b(John)i(P)o(eterson,)h(Kevin)f(Hammo)o(nd,)e
(et)h(al.)36 b(Re-)85 1378 y(p)q(ort)19 b(on)f(the)g(programming)d
(language)i(hask)o(ell,)h(a)85 1427 y(non-strict)f(purely-functional)e
(programming)e(lan-)85 1477 y(guage,)g(v)o(ersion)h(1.3.)i(T)m(ec)o
(hnical)d(rep)q(ort,)i(Y)m(ale)d(Uni-)85 1527 y(v)o(ersit)o(y)m(,)i(Ma)
o(y)f(1996.)0 1609 y([21])19 b(F)m(rank)10 b(Pfenning,)g(Jolle)f(Desp)q
(eyroux,)i(and)f(Carsten)85 1658 y(Sc)o(hrmann.)j(Primitiv)o(e)c
(recursion)j(for)f(higher-order)85 1708 y(abstract)g(syn)o(tax.)g(In)e
Fm(Thir)n(d)h(International)i(Confer-)85 1758 y(enc)n(e)g(on)f(T)m(yp)n
(e)n(d)f(L)n(amb)n(da)i(Calculi)e(and)h(Applic)n(ations)85
1808 y(\(TLCA'97\))p Fo(,)29 b(pages)e(147{163,)h(Nancy)m(,)h(F)m
(rance,)85 1858 y(April)14 b(1997.)0 1939 y([22])19 b(F)m(rank)f
(Pfenning,)g(Gilles)f(Do)o(w)o(ek,)h(Thrse)h(Hardin,)85
1989 y(and)28 b(Claude)g(Kirc)o(hner.)62 b(Uni\014cation)28
b(via)f(ex-)85 2039 y(plicit)19 b(substitutions:)29 b(The)20
b(case)h(of)d(higher-order)85 2089 y(patterns.)47 b(In)23
b Fm(Joint)g(International)g(Confer)n(enc)n(e)85 2138
y(and)d(Symp)n(osium)g(on)g(L)n(o)n(gic)f(Pr)n(o)n(gr)n(amming)g
(\(JIC-)85 2188 y(SLP'96\))p Fo(,)14 b(Bonn,)g(German)o(y)m(,)d(Septem)
o(b)q(er)k(1996.)0 2270 y([23])k(Calton)c(Pu)g(and)g(Jonathan)g(W)m
(alp)q(ole.)20 b(A)15 b(study)h(of)85 2320 y(dynamic)c(optimization)f
(tec)o(hniques:)19 b(Lessons)14 b(and)85 2369 y(directions)19
b(in)f(k)o(ernel)h(design.)31 b(T)m(ec)o(hnical)18 b(Rep)q(ort)85
2419 y(OGI-CSE-93-007,)k(Oregon)h(Graduate)f(Institute)85
2469 y(of)14 b(Science)h(and)f(T)m(ec)o(hnology)m(,)e(1993.)0
2551 y([24])19 b(Guy)e(Steele.)27 b(Building)16 b(in)o(terpreters)j(b)o
(y)d(comp)q(os-)85 2600 y(ing)24 b(monads.)46 b(In)24
b Fm(21st)g(A)o(nnual)h(A)o(CM)e(Symp)n(o-)85 2650 y(sium)14
b(on)h(Principles)f(of)g(Pr)n(o)n(gr)n(amming)g(L)n(anguages)85
2700 y(\(POPL'94\))p Fo(,)g(P)o(ortland,)f(Oregon,)h(Jan)o(uary)g
(1994.)1005 42 y([25])19 b(Joseph)e(E.)e(Sto)o(y)m(.)23
b Fm(Denotational)17 b(Semantics:)23 b(The)1090 91 y(Sc)n(ott-Str)n
(achey)15 b(Appr)n(o)n(ach)g(to)g(Pr)n(o)n(gr)n(amming)f(L)n(an-)1090
141 y(guage)24 b(The)n(ory)p Fo(.)43 b(The)22 b(MIT)h(Press,)i(Cam)o
(bridge,)1090 191 y(Massac)o(h)o(usetts,)16 b(1977.)1005
274 y([26])j(W)m(alid)25 b(T)m(aha,)k(Zine-El-Abidine)d(Benaissa,)k
(and)1090 324 y(Tim)18 b(Sheard.)36 b(Multi-stage)19
b(programming:)26 b(Ax-)1090 374 y(iomatization)18 b(and)j(t)o(yp)q
(e-safet)o(y)m(.)40 b(In)21 b Fm(25th)h(Inter-)1090 423
y(national)16 b(Col)r(lo)n(quium)e(on)i(A)o(utomata,)f(L)n(anguages,)
1090 473 y(and)30 b(Pr)n(o)n(gr)n(amming)p Fo(,)i(Aalb)q(org,)g
(Denmark,)g(13{)1090 523 y(17July)14 b(1998.)1005 606
y([27])19 b(W)m(alid)12 b(T)m(aha)h(and)h(Tim)e(Sheard.)19
b(Multi-stage)13 b(pro-)1090 656 y(gramming)i(with)k(explicit)f
(annotations.)32 b(In)18 b Fm(Pr)n(o-)1090 706 y(c)n(e)n(e)n(dings)c
(of)f(the)g(A)o(CM-SIGPLAN)g(Symp)n(osium)g(on)1090 756
y(Partial)f(Evaluation)h(and)g(semantic)f(b)n(ase)n(d)h(pr)n(o)n(gr)n
(am)1090 805 y(manipulations)27 b(PEPM'97,)j(A)o(mster)n(dam)p
Fo(,)e(pages)1090 855 y(203{217.)12 b(A)o(CM,)h(1997.)1005
938 y([28])19 b(Philip)c(W)m(adler.)23 b(Comprehending)14
b(monads.)22 b Fm(Pr)n(o-)1090 988 y(c)n(e)n(e)n(dings)c(of)g(the)g(A)o
(CM)g(Symp)n(osium)g(on)g(Lisp)g(and)1090 1038 y(F)m(unctional)h(Pr)n
(o)n(gr)n(amming,)g(Nic)n(e,)f(F)m(r)n(anc)n(e)p Fo(,)h(pages)1090
1088 y(61{78,)12 b(June)j(1990.)1005 1171 y([29])k(Philip)c(W)m(adler.)
23 b(Comprehending)14 b(monads.)22 b Fm(Pr)n(o-)1090
1220 y(c)n(e)n(e)n(dings)c(of)g(the)g(A)o(CM)g(Symp)n(osium)g(on)g
(Lisp)g(and)1090 1270 y(F)m(unctional)h(Pr)n(o)n(gr)n(amming,)g(Nic)n
(e,)f(F)m(r)n(anc)n(e)p Fo(,)h(pages)1090 1320 y(61{78,)12
b(June)j(1990.)1005 1403 y([30])k(Philip)c(W)m(adler.)24
b(The)17 b(essence)h(of)e(functional)f(pro-)1090 1453
y(gramming)7 b(\(in)o(vited)j(talk\).)h(In)f Fm(19'th)i(A)o(CM)f(Symp)n
(o-)1090 1503 y(sium)h(on)h(Principles)e(of)h(Pr)n(o)n(gr)n(amming)f(L)
n(anguages)p Fo(,)1090 1553 y(Albuquerque,)k(New)f(Mexico,)f(Jan)o
(uary)h(1992.)1005 1636 y([31])19 b(Philip)10 b(W)m(adler.)i(Monads)f
(for)f(functional)g(program-)1090 1685 y(ming.)k(In)f(J.)f(Jeuring)h
(and)g(E.)f(Meijer,)h(editors,)g Fm(A)n(d-)1090 1735
y(vanc)n(e)n(d)g(F)m(unctional)g(Pr)n(o)n(gr)n(amming)p
Fo(,)d(v)o(olume)f(925)h(of)1090 1785 y Fm(LNCS)p Fo(.)k(Springer)g(V)m
(erlag,)f(1995.)1005 1868 y([32])19 b(T)m(an)o(y)o(a)d(Widen.)27
b(F)m(ormal)14 b(language)i(design)h(in)f(the)1090 1918
y(con)o(text)j(of)e(domain)f(engineering.)30 b(Master's)19
b(the-)1090 1968 y(sis,)d(Departmen)o(t)f(of)f(Computer)h(Science)i
(and)e(En-)1090 2017 y(gineering,)e(Oregon)h(Graduate)f(Institute,)g
(Octob)q(er)1090 2067 y(1997.)1005 2150 y([33])19 b(T)m(an)o(y)o(a)9
b(Widen)g(and)h(James)f(Ho)q(ok.)i(Soft)o(w)o(are)f(design)1090
2200 y(automation:)15 b(Language)d(design)h(in)e(the)i(con)o(text)h(of)
1090 2250 y(domain)8 b(engenieering.)k(In)d Fm(The)i(10th)h
(International)1090 2300 y(Confer)n(enc)n(e)i(on)g(Softwar)n(e)e
(Engine)n(ering)i(&)f(Know)r(l-)1090 2350 y(e)n(dge)22
b(Engine)n(ering)f(\(SEKE'98\))p Fo(,)h(pages)f(308{317,)1090
2399 y(San)14 b(F)m(rancisco)g(Ba)o(y)m(,)f(California,)e(June)k(1998.)
p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
